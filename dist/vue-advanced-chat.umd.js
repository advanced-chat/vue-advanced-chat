(function(ur,ti){typeof exports=="object"&&typeof module!="undefined"?ti(exports):typeof define=="function"&&define.amd?define(["exports"],ti):(ur=typeof globalThis!="undefined"?globalThis:ur||self,ti(ur["vue-advanced-chat"]={}))})(this,function(ur){"use strict";function ti(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}const n1=()=>{},r1=Object.assign,i1=Object.prototype.hasOwnProperty,Ui=(e,t)=>i1.call(e,t),Kn=Array.isArray,Vi=e=>Uo(e)==="[object Map]",a1=e=>typeof e=="function",s1=e=>typeof e=="string",Ga=e=>typeof e=="symbol",qi=e=>e!==null&&typeof e=="object",o1=Object.prototype.toString,Uo=e=>o1.call(e),l1=e=>Uo(e).slice(8,-1),Wa=e=>s1(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Vo=(e,t)=>!Object.is(e,t),c1=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let Sn;class u1{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Sn&&(this.parent=Sn,this.index=(Sn.scopes||(Sn.scopes=[])).push(this)-1)}run(t){if(this.active){const n=Sn;try{return Sn=this,t()}finally{Sn=n}}}on(){Sn=this}off(){Sn=this.parent}stop(t){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function d1(e,t=Sn){t&&t.active&&t.effects.push(e)}const Za=e=>{const t=new Set(e);return t.w=0,t.n=0,t},qo=e=>(e.w&Gn)>0,Xo=e=>(e.n&Gn)>0,m1=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Gn},f1=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const a=t[r];qo(a)&&!Xo(a)?a.delete(e):t[n++]=a,a.w&=~Gn,a.n&=~Gn}t.length=n}},Qa=new WeakMap;let ni=0,Gn=1;const Ja=30;let vn;const dr=Symbol(""),$a=Symbol("");class es{constructor(t,n=null,r){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,d1(this,r)}run(){if(!this.active)return this.fn();let t=vn,n=Wn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=vn,vn=this,Wn=!0,Gn=1<<++ni,ni<=Ja?m1(this):Yo(this),this.fn()}finally{ni<=Ja&&f1(this),Gn=1<<--ni,vn=this.parent,Wn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){vn===this?this.deferStop=!0:this.active&&(Yo(this),this.onStop&&this.onStop(),this.active=!1)}}function Yo(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Wn=!0;const Ko=[];function Fr(){Ko.push(Wn),Wn=!1}function jr(){const e=Ko.pop();Wn=e===void 0?!0:e}function tn(e,t,n){if(Wn&&vn){let r=Qa.get(e);r||Qa.set(e,r=new Map);let a=r.get(n);a||r.set(n,a=Za()),Go(a)}}function Go(e,t){let n=!1;ni<=Ja?Xo(e)||(e.n|=Gn,n=!qo(e)):n=!e.has(vn),n&&(e.add(vn),vn.deps.push(e))}function Hn(e,t,n,r,a,i){const s=Qa.get(e);if(!s)return;let l=[];if(t==="clear")l=[...s.values()];else if(n==="length"&&Kn(e))s.forEach((m,u)=>{(u==="length"||u>=r)&&l.push(m)});else switch(n!==void 0&&l.push(s.get(n)),t){case"add":Kn(e)?Wa(n)&&l.push(s.get("length")):(l.push(s.get(dr)),Vi(e)&&l.push(s.get($a)));break;case"delete":Kn(e)||(l.push(s.get(dr)),Vi(e)&&l.push(s.get($a)));break;case"set":Vi(e)&&l.push(s.get(dr));break}if(l.length===1)l[0]&&ts(l[0]);else{const m=[];for(const u of l)u&&m.push(...u);ts(Za(m))}}function ts(e,t){const n=Kn(e)?e:[...e];for(const r of n)r.computed&&Wo(r);for(const r of n)r.computed||Wo(r)}function Wo(e,t){(e!==vn||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const h1=ti("__proto__,__v_isRef,__isVue"),Zo=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ga)),p1=ns(),v1=ns(!1,!0),_1=ns(!0),Qo=g1();function g1(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=mt(this);for(let i=0,s=this.length;i<s;i++)tn(r,"get",i+"");const a=r[t](...n);return a===-1||a===!1?r[t](...n.map(mt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Fr();const r=mt(this)[t].apply(this,n);return jr(),r}}),e}function ns(e=!1,t=!1){return function(r,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?L1:sl:t?al:il).get(r))return r;const s=Kn(r);if(!e&&s&&Ui(Qo,a))return Reflect.get(Qo,a,i);const l=Reflect.get(r,a,i);return(Ga(a)?Zo.has(a):h1(a))||(e||tn(r,"get",a),t)?l:qt(l)?s&&Wa(a)?l:l.value:qi(l)?e?ol(l):as(l):l}}const b1=Jo(),x1=Jo(!0);function Jo(e=!1){return function(n,r,a,i){let s=n[r];if(ri(s)&&qt(s)&&!qt(a))return!1;if(!e&&!ri(a)&&(os(a)||(a=mt(a),s=mt(s)),!Kn(n)&&qt(s)&&!qt(a)))return s.value=a,!0;const l=Kn(n)&&Wa(r)?Number(r)<n.length:Ui(n,r),m=Reflect.set(n,r,a,i);return n===mt(i)&&(l?Vo(a,s)&&Hn(n,"set",r,a):Hn(n,"add",r,a)),m}}function y1(e,t){const n=Ui(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Hn(e,"delete",t,void 0),r}function w1(e,t){const n=Reflect.has(e,t);return(!Ga(t)||!Zo.has(t))&&tn(e,"has",t),n}function k1(e){return tn(e,"iterate",Kn(e)?"length":dr),Reflect.ownKeys(e)}const $o={get:p1,set:b1,deleteProperty:y1,has:w1,ownKeys:k1},S1={get:_1,set(e,t){return!0},deleteProperty(e,t){return!0}},M1=r1({},$o,{get:v1,set:x1}),rs=e=>e,Xi=e=>Reflect.getPrototypeOf(e);function Yi(e,t,n=!1,r=!1){e=e.__v_raw;const a=mt(e),i=mt(t);n||(t!==i&&tn(a,"get",t),tn(a,"get",i));const{has:s}=Xi(a),l=r?rs:n?cs:ls;if(s.call(a,t))return l(e.get(t));if(s.call(a,i))return l(e.get(i));e!==a&&e.get(t)}function Ki(e,t=!1){const n=this.__v_raw,r=mt(n),a=mt(e);return t||(e!==a&&tn(r,"has",e),tn(r,"has",a)),e===a?n.has(e):n.has(e)||n.has(a)}function Gi(e,t=!1){return e=e.__v_raw,!t&&tn(mt(e),"iterate",dr),Reflect.get(e,"size",e)}function el(e){e=mt(e);const t=mt(this);return Xi(t).has.call(t,e)||(t.add(e),Hn(t,"add",e,e)),this}function tl(e,t){t=mt(t);const n=mt(this),{has:r,get:a}=Xi(n);let i=r.call(n,e);i||(e=mt(e),i=r.call(n,e));const s=a.call(n,e);return n.set(e,t),i?Vo(t,s)&&Hn(n,"set",e,t):Hn(n,"add",e,t),this}function nl(e){const t=mt(this),{has:n,get:r}=Xi(t);let a=n.call(t,e);a||(e=mt(e),a=n.call(t,e)),r&&r.call(t,e);const i=t.delete(e);return a&&Hn(t,"delete",e,void 0),i}function rl(){const e=mt(this),t=e.size!==0,n=e.clear();return t&&Hn(e,"clear",void 0,void 0),n}function Wi(e,t){return function(r,a){const i=this,s=i.__v_raw,l=mt(s),m=t?rs:e?cs:ls;return!e&&tn(l,"iterate",dr),s.forEach((u,h)=>r.call(a,m(u),m(h),i))}}function Zi(e,t,n){return function(...r){const a=this.__v_raw,i=mt(a),s=Vi(i),l=e==="entries"||e===Symbol.iterator&&s,m=e==="keys"&&s,u=a[e](...r),h=n?rs:t?cs:ls;return!t&&tn(i,"iterate",m?$a:dr),{next(){const{value:c,done:_}=u.next();return _?{value:c,done:_}:{value:l?[h(c[0]),h(c[1])]:h(c),done:_}},[Symbol.iterator](){return this}}}}function Zn(e){return function(...t){return e==="delete"?!1:this}}function A1(){const e={get(i){return Yi(this,i)},get size(){return Gi(this)},has:Ki,add:el,set:tl,delete:nl,clear:rl,forEach:Wi(!1,!1)},t={get(i){return Yi(this,i,!1,!0)},get size(){return Gi(this)},has:Ki,add:el,set:tl,delete:nl,clear:rl,forEach:Wi(!1,!0)},n={get(i){return Yi(this,i,!0)},get size(){return Gi(this,!0)},has(i){return Ki.call(this,i,!0)},add:Zn("add"),set:Zn("set"),delete:Zn("delete"),clear:Zn("clear"),forEach:Wi(!0,!1)},r={get(i){return Yi(this,i,!0,!0)},get size(){return Gi(this,!0)},has(i){return Ki.call(this,i,!0)},add:Zn("add"),set:Zn("set"),delete:Zn("delete"),clear:Zn("clear"),forEach:Wi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=Zi(i,!1,!1),n[i]=Zi(i,!0,!1),t[i]=Zi(i,!1,!0),r[i]=Zi(i,!0,!0)}),[e,n,t,r]}const[E1,T1,R1,I1]=A1();function is(e,t){const n=t?e?I1:R1:e?T1:E1;return(r,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?r:Reflect.get(Ui(n,a)&&a in r?n:r,a,i)}const C1={get:is(!1,!1)},B1={get:is(!1,!0)},O1={get:is(!0,!1)},il=new WeakMap,al=new WeakMap,sl=new WeakMap,L1=new WeakMap;function F1(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function j1(e){return e.__v_skip||!Object.isExtensible(e)?0:F1(l1(e))}function as(e){return ri(e)?e:ss(e,!1,$o,C1,il)}function N1(e){return ss(e,!1,M1,B1,al)}function ol(e){return ss(e,!0,S1,O1,sl)}function ss(e,t,n,r,a){if(!qi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=j1(e);if(s===0)return e;const l=new Proxy(e,s===2?r:n);return a.set(e,l),l}function Nr(e){return ri(e)?Nr(e.__v_raw):!!(e&&e.__v_isReactive)}function ri(e){return!!(e&&e.__v_isReadonly)}function os(e){return!!(e&&e.__v_isShallow)}function ll(e){return Nr(e)||ri(e)}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function cl(e){return c1(e,"__v_skip",!0),e}const ls=e=>qi(e)?as(e):e,cs=e=>qi(e)?ol(e):e;function H1(e){Wn&&vn&&(e=mt(e),Go(e.dep||(e.dep=Za())))}function D1(e,t){e=mt(e),e.dep&&ts(e.dep)}function qt(e){return!!(e&&e.__v_isRef===!0)}function P1(e){return qt(e)?e.value:e}const z1={get:(e,t,n)=>P1(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const a=e[t];return qt(a)&&!qt(n)?(a.value=n,!0):Reflect.set(e,t,n,r)}};function ul(e){return Nr(e)?e:new Proxy(e,z1)}class U1{constructor(t,n,r,a){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new es(t,()=>{this._dirty||(this._dirty=!0,D1(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=r}get value(){const t=mt(this);return H1(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function V1(e,t,n=!1){let r,a;const i=a1(e);return i?(r=e,a=n1):(r=e.get,a=e.set),new U1(r,a,i||!a,n)}function q1(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}function St(e){if(ot(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],a=Xt(r)?K1(r):St(r);if(a)for(const i in a)t[i]=a[i]}return t}else{if(Xt(e))return e;if(Yt(e))return e}}const X1=/;(?![^(]*\))/g,Y1=/:(.+)/;function K1(e){const t={};return e.split(X1).forEach(n=>{if(n){const r=n.split(Y1);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function $e(e){let t="";if(Xt(e))t=e;else if(ot(e))for(let n=0;n<e.length;n++){const r=$e(e[n]);r&&(t+=r+" ")}else if(Yt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function vt(e){if(!e)return null;let{class:t,style:n}=e;return t&&!Xt(t)&&(e.class=$e(t)),n&&(e.style=St(n)),e}const Qe=e=>Xt(e)?e:e==null?"":ot(e)||Yt(e)&&(e.toString===vl||!it(e.toString))?JSON.stringify(e,dl,2):String(e),dl=(e,t)=>t&&t.__v_isRef?dl(e,t.value):fl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,a])=>(n[`${r} =>`]=a,n),{})}:hl(t)?{[`Set(${t.size})`]:[...t.values()]}:Yt(t)&&!ot(t)&&!_l(t)?String(t):t,bt={},Hr=[],Mn=()=>{},G1=()=>!1,W1=/^on[^a-z]/,us=e=>W1.test(e),ml=e=>e.startsWith("onUpdate:"),nn=Object.assign,ds=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Z1=Object.prototype.hasOwnProperty,ft=(e,t)=>Z1.call(e,t),ot=Array.isArray,fl=e=>ms(e)==="[object Map]",hl=e=>ms(e)==="[object Set]",it=e=>typeof e=="function",Xt=e=>typeof e=="string",Yt=e=>e!==null&&typeof e=="object",pl=e=>Yt(e)&&it(e.then)&&it(e.catch),vl=Object.prototype.toString,ms=e=>vl.call(e),_l=e=>ms(e)==="[object Object]",Qi=q1(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ji=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Q1=/-(\w)/g,An=Ji(e=>e.replace(Q1,(t,n)=>n?n.toUpperCase():"")),J1=/\B([A-Z])/g,$i=Ji(e=>e.replace(J1,"-$1").toLowerCase()),fs=Ji(e=>e.charAt(0).toUpperCase()+e.slice(1)),hs=Ji(e=>e?`on${fs(e)}`:""),gl=(e,t)=>!Object.is(e,t),ps=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},vs=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},$1=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let bl;const ed=()=>bl||(bl=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function Qn(e,t,n,r){let a;try{a=r?e(...r):e()}catch(i){ea(i,t,n)}return a}function un(e,t,n,r){if(it(e)){const i=Qn(e,t,n,r);return i&&pl(i)&&i.catch(s=>{ea(s,t,n)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(un(e[i],t,n,r));return a}function ea(e,t,n,r=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,l=n;for(;i;){const u=i.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](e,s,l)===!1)return}i=i.parent}const m=t.appContext.config.errorHandler;if(m){Qn(m,null,10,[e,s,l]);return}}td(e,n,a,r)}function td(e,t,n,r=!0){console.error(e)}let ta=!1,_s=!1;const rn=[];let Dn=0;const ii=[];let ai=null,Dr=0;const si=[];let Jn=null,Pr=0;const xl=Promise.resolve();let gs=null,bs=null;function yl(e){const t=gs||xl;return e?t.then(this?e.bind(this):e):t}function nd(e){let t=Dn+1,n=rn.length;for(;t<n;){const r=t+n>>>1;oi(rn[r])<e?t=r+1:n=r}return t}function wl(e){(!rn.length||!rn.includes(e,ta&&e.allowRecurse?Dn+1:Dn))&&e!==bs&&(e.id==null?rn.push(e):rn.splice(nd(e.id),0,e),kl())}function kl(){!ta&&!_s&&(_s=!0,gs=xl.then(Al))}function rd(e){const t=rn.indexOf(e);t>Dn&&rn.splice(t,1)}function Sl(e,t,n,r){ot(e)?n.push(...e):(!t||!t.includes(e,e.allowRecurse?r+1:r))&&n.push(e),kl()}function id(e){Sl(e,ai,ii,Dr)}function ad(e){Sl(e,Jn,si,Pr)}function na(e,t=null){if(ii.length){for(bs=t,ai=[...new Set(ii)],ii.length=0,Dr=0;Dr<ai.length;Dr++)ai[Dr]();ai=null,Dr=0,bs=null,na(e,t)}}function Ml(e){if(na(),si.length){const t=[...new Set(si)];if(si.length=0,Jn){Jn.push(...t);return}for(Jn=t,Jn.sort((n,r)=>oi(n)-oi(r)),Pr=0;Pr<Jn.length;Pr++)Jn[Pr]();Jn=null,Pr=0}}const oi=e=>e.id==null?1/0:e.id;function Al(e){_s=!1,ta=!0,na(e),rn.sort((n,r)=>oi(n)-oi(r));const t=Mn;try{for(Dn=0;Dn<rn.length;Dn++){const n=rn[Dn];n&&n.active!==!1&&Qn(n,null,14)}}finally{Dn=0,rn.length=0,Ml(),ta=!1,gs=null,(rn.length||ii.length||si.length)&&Al(e)}}function sd(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||bt;let a=n;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in r){const h=`${s==="modelValue"?"model":s}Modifiers`,{number:c,trim:_}=r[h]||bt;_&&(a=n.map(p=>p.trim())),c&&(a=n.map($1))}let l,m=r[l=hs(t)]||r[l=hs(An(t))];!m&&i&&(m=r[l=hs($i(t))]),m&&un(m,e,6,a);const u=r[l+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,un(u,e,6,a)}}function El(e,t,n=!1){const r=t.emitsCache,a=r.get(e);if(a!==void 0)return a;const i=e.emits;let s={},l=!1;if(!it(e)){const m=u=>{const h=El(u,t,!0);h&&(l=!0,nn(s,h))};!n&&t.mixins.length&&t.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}return!i&&!l?(r.set(e,null),null):(ot(i)?i.forEach(m=>s[m]=null):nn(s,i),r.set(e,s),s)}function ra(e,t){return!e||!us(t)?!1:(t=t.slice(2).replace(/Once$/,""),ft(e,t[0].toLowerCase()+t.slice(1))||ft(e,$i(t))||ft(e,t))}let Dt=null,Tl=null;function ia(e){const t=Dt;return Dt=e,Tl=e&&e.type.__scopeId||null,t}function Ge(e,t=Dt,n){if(!t||e._n)return e;const r=(...a)=>{r._d&&s0(-1);const i=ia(t),s=e(...a);return ia(i),r._d&&s0(1),s};return r._n=!0,r._c=!0,r._d=!0,r}function Ub(){}function xs(e){const{type:t,vnode:n,proxy:r,withProxy:a,props:i,propsOptions:[s],slots:l,attrs:m,emit:u,render:h,renderCache:c,data:_,setupState:p,ctx:o,inheritAttrs:j}=e;let O,I;const v=ia(e);try{if(n.shapeFlag&4){const L=a||r;O=En(h.call(L,L,c,i,p,_,o)),I=m}else{const L=t;O=En(L.length>1?L(i,{attrs:m,slots:l,emit:u}):L(i,null)),I=t.props?m:od(m)}}catch(L){di.length=0,ea(L,e,1),O=Oe(mn)}let E=O;if(I&&j!==!1){const L=Object.keys(I),{shapeFlag:T}=E;L.length&&T&7&&(s&&L.some(ml)&&(I=ld(I,s)),E=$n(E,I))}return n.dirs&&(E=$n(E),E.dirs=E.dirs?E.dirs.concat(n.dirs):n.dirs),n.transition&&(E.transition=n.transition),O=E,ia(v),O}const od=e=>{let t;for(const n in e)(n==="class"||n==="style"||us(n))&&((t||(t={}))[n]=e[n]);return t},ld=(e,t)=>{const n={};for(const r in e)(!ml(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function cd(e,t,n){const{props:r,children:a,component:i}=e,{props:s,children:l,patchFlag:m}=t,u=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&m>=0){if(m&1024)return!0;if(m&16)return r?Rl(r,s,u):!!s;if(m&8){const h=t.dynamicProps;for(let c=0;c<h.length;c++){const _=h[c];if(s[_]!==r[_]&&!ra(u,_))return!0}}}else return(a||l)&&(!l||!l.$stable)?!0:r===s?!1:r?s?Rl(r,s,u):!0:!!s;return!1}function Rl(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let a=0;a<r.length;a++){const i=r[a];if(t[i]!==e[i]&&!ra(n,i))return!0}return!1}function ud({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const dd=e=>e.__isSuspense;function md(e,t){t&&t.pendingBranch?ot(e)?t.effects.push(...e):t.effects.push(e):ad(e)}function fd(e,t){if(Ft){let n=Ft.provides;const r=Ft.parent&&Ft.parent.provides;r===n&&(n=Ft.provides=Object.create(r)),n[e]=t}}function ys(e,t,n=!1){const r=Ft||Dt;if(r){const a=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return n&&it(t)?t.call(r.proxy):t}}const Il={};function ws(e,t,n){return Cl(e,t,n)}function Cl(e,t,{immediate:n,deep:r,flush:a,onTrack:i,onTrigger:s}=bt){const l=Ft;let m,u=!1,h=!1;if(qt(e)?(m=()=>e.value,u=os(e)):Nr(e)?(m=()=>e,r=!0):ot(e)?(h=!0,u=e.some(I=>Nr(I)||os(I)),m=()=>e.map(I=>{if(qt(I))return I.value;if(Nr(I))return mr(I);if(it(I))return Qn(I,l,2)})):it(e)?t?m=()=>Qn(e,l,2):m=()=>{if(!(l&&l.isUnmounted))return c&&c(),un(e,l,3,[_])}:m=Mn,t&&r){const I=m;m=()=>mr(I())}let c,_=I=>{c=O.onStop=()=>{Qn(I,l,4)}};if(fi)return _=Mn,t?n&&un(t,l,3,[m(),h?[]:void 0,_]):m(),Mn;let p=h?[]:Il;const o=()=>{if(!!O.active)if(t){const I=O.run();(r||u||(h?I.some((v,E)=>gl(v,p[E])):gl(I,p)))&&(c&&c(),un(t,l,3,[I,p===Il?void 0:p,_]),p=I)}else O.run()};o.allowRecurse=!!t;let j;a==="sync"?j=o:a==="post"?j=()=>Wt(o,l&&l.suspense):j=()=>id(o);const O=new es(m,j);return t?n?o():p=O.run():a==="post"?Wt(O.run.bind(O),l&&l.suspense):O.run(),()=>{O.stop(),l&&l.scope&&ds(l.scope.effects,O)}}function hd(e,t,n){const r=this.proxy,a=Xt(e)?e.includes(".")?Bl(r,e):()=>r[e]:e.bind(r,r);let i;it(t)?i=t:(i=t.handler,n=t);const s=Ft;zr(this);const l=Cl(a,i.bind(r),n);return s?zr(s):_r(),l}function Bl(e,t){const n=t.split(".");return()=>{let r=e;for(let a=0;a<n.length&&r;a++)r=r[n[a]];return r}}function mr(e,t){if(!Yt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),qt(e))mr(e.value,t);else if(ot(e))for(let n=0;n<e.length;n++)mr(e[n],t);else if(hl(e)||fl(e))e.forEach(n=>{mr(n,t)});else if(_l(e))for(const n in e)mr(e[n],t);return e}function Ol(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hl(()=>{e.isMounted=!0}),Pl(()=>{e.isUnmounting=!0}),e}const dn=[Function,Array],Ll={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dn,onEnter:dn,onAfterEnter:dn,onEnterCancelled:dn,onBeforeLeave:dn,onLeave:dn,onAfterLeave:dn,onLeaveCancelled:dn,onBeforeAppear:dn,onAppear:dn,onAfterAppear:dn,onAppearCancelled:dn},setup(e,{slots:t}){const n=c0(),r=Ol();let a;return()=>{const i=t.default&&Ss(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const j of i)if(j.type!==mn){s=j;break}}const l=mt(e),{mode:m}=l;if(r.isLeaving)return ks(s);const u=jl(s);if(!u)return ks(s);const h=li(u,l,r,n);ci(u,h);const c=n.subTree,_=c&&jl(c);let p=!1;const{getTransitionKey:o}=u.type;if(o){const j=o();a===void 0?a=j:j!==a&&(a=j,p=!0)}if(_&&_.type!==mn&&(!vr(u,_)||p)){const j=li(_,l,r,n);if(ci(_,j),m==="out-in")return r.isLeaving=!0,j.afterLeave=()=>{r.isLeaving=!1,n.update()},ks(s);m==="in-out"&&u.type!==mn&&(j.delayLeave=(O,I,v)=>{const E=Fl(r,_);E[String(_.key)]=_,O._leaveCb=()=>{I(),O._leaveCb=void 0,delete h.delayedLeave},h.delayedLeave=v})}return s}}};function Fl(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function li(e,t,n,r){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:l,onEnter:m,onAfterEnter:u,onEnterCancelled:h,onBeforeLeave:c,onLeave:_,onAfterLeave:p,onLeaveCancelled:o,onBeforeAppear:j,onAppear:O,onAfterAppear:I,onAppearCancelled:v}=t,E=String(e.key),L=Fl(n,e),T=(A,S)=>{A&&un(A,r,9,S)},R=(A,S)=>{const f=S[1];T(A,S),ot(A)?A.every(x=>x.length<=1)&&f():A.length<=1&&f()},g={mode:i,persisted:s,beforeEnter(A){let S=l;if(!n.isMounted)if(a)S=j||l;else return;A._leaveCb&&A._leaveCb(!0);const f=L[E];f&&vr(e,f)&&f.el._leaveCb&&f.el._leaveCb(),T(S,[A])},enter(A){let S=m,f=u,x=h;if(!n.isMounted)if(a)S=O||m,f=I||u,x=v||h;else return;let b=!1;const y=A._enterCb=k=>{b||(b=!0,k?T(x,[A]):T(f,[A]),g.delayedLeave&&g.delayedLeave(),A._enterCb=void 0)};S?R(S,[A,y]):y()},leave(A,S){const f=String(e.key);if(A._enterCb&&A._enterCb(!0),n.isUnmounting)return S();T(c,[A]);let x=!1;const b=A._leaveCb=y=>{x||(x=!0,S(),y?T(o,[A]):T(p,[A]),A._leaveCb=void 0,L[f]===e&&delete L[f])};L[f]=e,_?R(_,[A,b]):b()},clone(A){return li(A,t,n,r)}};return g}function ks(e){if(aa(e))return e=$n(e),e.children=null,e}function jl(e){return aa(e)?e.children?e.children[0]:void 0:e}function ci(e,t){e.shapeFlag&6&&e.component?ci(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ss(e,t=!1,n){let r=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const l=n==null?s.key:String(n)+String(s.key!=null?s.key:i);s.type===st?(s.patchFlag&128&&a++,r=r.concat(Ss(s.children,t,l))):(t||s.type!==mn)&&r.push(l!=null?$n(s,{key:l}):s)}if(a>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function pd(e){return it(e)?{setup:e,name:e.name}:e}const ui=e=>!!e.type.__asyncLoader,aa=e=>e.type.__isKeepAlive;function vd(e,t){Nl(e,"a",t)}function _d(e,t){Nl(e,"da",t)}function Nl(e,t,n=Ft){const r=e.__wdc||(e.__wdc=()=>{let a=n;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(sa(t,r,n),n){let a=n.parent;for(;a&&a.parent;)aa(a.parent.vnode)&&gd(r,t,n,a),a=a.parent}}function gd(e,t,n,r){const a=sa(t,e,r,!0);zl(()=>{ds(r[t],a)},n)}function sa(e,t,n=Ft,r=!1){if(n){const a=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(n.isUnmounted)return;Fr(),zr(n);const l=un(t,n,e,s);return _r(),jr(),l});return r?a.unshift(i):a.push(i),i}}const Pn=e=>(t,n=Ft)=>(!fi||e==="sp")&&sa(e,t,n),bd=Pn("bm"),Hl=Pn("m"),xd=Pn("bu"),Dl=Pn("u"),Pl=Pn("bum"),zl=Pn("um"),yd=Pn("sp"),wd=Pn("rtg"),kd=Pn("rtc");function Sd(e,t=Ft){sa("ec",e,t)}function zn(e,t){const n=Dt;if(n===null)return e;const r=fa(n)||n.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,l,m,u=bt]=t[i];it(s)&&(s={mounted:s,updated:s}),s.deep&&mr(l),a.push({dir:s,instance:r,value:l,oldValue:void 0,arg:m,modifiers:u})}return e}function fr(e,t,n,r){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const l=a[s];i&&(l.oldValue=i[s].value);let m=l.dir[r];m&&(Fr(),un(m,n,8,[e.el,l,e,t]),jr())}}const Ms="components",Md="directives";function Ye(e,t){return As(Ms,e,!0,t)||e}const Ul=Symbol();function Ad(e){return Xt(e)?As(Ms,e,!1)||e:e||Ul}function oa(e){return As(Md,e)}function As(e,t,n=!0,r=!1){const a=Dt||Ft;if(a){const i=a.type;if(e===Ms){const l=$d(i,!1);if(l&&(l===t||l===An(t)||l===fs(An(t))))return i}const s=Vl(a[e]||i[e],t)||Vl(a.appContext[e],t);return!s&&r?i:s}}function Vl(e,t){return e&&(e[t]||e[An(t)]||e[fs(An(t))])}function tt(e,t,n,r){let a;const i=n&&n[r];if(ot(e)||Xt(e)){a=new Array(e.length);for(let s=0,l=e.length;s<l;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(Yt(e))if(e[Symbol.iterator])a=Array.from(e,(s,l)=>t(s,l,void 0,i&&i[l]));else{const s=Object.keys(e);a=new Array(s.length);for(let l=0,m=s.length;l<m;l++){const u=s[l];a[l]=t(e[u],u,l,i&&i[l])}}else a=[];return n&&(n[r]=a),a}function _t(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(ot(r))for(let a=0;a<r.length;a++)e[r[a].name]=r[a].fn;else r&&(e[r.name]=r.fn)}return e}function Be(e,t,n={},r,a){if(Dt.isCE||Dt.parent&&ui(Dt.parent)&&Dt.parent.isCE)return Oe("slot",t==="default"?null:{name:t},r&&r());let i=e[t];i&&i._c&&(i._d=!1),Q();const s=i&&ql(i(n)),l=ht(st,{key:n.key||`_${t}`},s||(r?r():[]),s&&e._===1?64:-2);return!a&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function ql(e){return e.some(t=>ua(t)?!(t.type===mn||t.type===st&&!ql(t.children)):!0)?e:null}const Es=e=>e?u0(e)?fa(e)||e.proxy:Es(e.parent):null,la=nn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Es(e.parent),$root:e=>Es(e.root),$emit:e=>e.emit,$options:e=>Kl(e),$forceUpdate:e=>e.f||(e.f=()=>wl(e.update)),$nextTick:e=>e.n||(e.n=yl.bind(e.proxy)),$watch:e=>hd.bind(e)}),Ed={get({_:e},t){const{ctx:n,setupState:r,data:a,props:i,accessCache:s,type:l,appContext:m}=e;let u;if(t[0]!=="$"){const p=s[t];if(p!==void 0)switch(p){case 1:return r[t];case 2:return a[t];case 4:return n[t];case 3:return i[t]}else{if(r!==bt&&ft(r,t))return s[t]=1,r[t];if(a!==bt&&ft(a,t))return s[t]=2,a[t];if((u=e.propsOptions[0])&&ft(u,t))return s[t]=3,i[t];if(n!==bt&&ft(n,t))return s[t]=4,n[t];Ts&&(s[t]=0)}}const h=la[t];let c,_;if(h)return t==="$attrs"&&tn(e,"get",t),h(e);if((c=l.__cssModules)&&(c=c[t]))return c;if(n!==bt&&ft(n,t))return s[t]=4,n[t];if(_=m.config.globalProperties,ft(_,t))return _[t]},set({_:e},t,n){const{data:r,setupState:a,ctx:i}=e;return a!==bt&&ft(a,t)?(a[t]=n,!0):r!==bt&&ft(r,t)?(r[t]=n,!0):ft(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:a,propsOptions:i}},s){let l;return!!n[s]||e!==bt&&ft(e,s)||t!==bt&&ft(t,s)||(l=i[0])&&ft(l,s)||ft(r,s)||ft(la,s)||ft(a.config.globalProperties,s)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ft(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Ts=!0;function Td(e){const t=Kl(e),n=e.proxy,r=e.ctx;Ts=!1,t.beforeCreate&&Xl(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:l,provide:m,inject:u,created:h,beforeMount:c,mounted:_,beforeUpdate:p,updated:o,activated:j,deactivated:O,beforeDestroy:I,beforeUnmount:v,destroyed:E,unmounted:L,render:T,renderTracked:R,renderTriggered:g,errorCaptured:A,serverPrefetch:S,expose:f,inheritAttrs:x,components:b,directives:y,filters:k}=t;if(u&&Rd(u,r,null,e.appContext.config.unwrapInjectedRef),s)for(const Y in s){const P=s[Y];it(P)&&(r[Y]=P.bind(n))}if(a){const Y=a.call(n,n);Yt(Y)&&(e.data=as(Y))}if(Ts=!0,i)for(const Y in i){const P=i[Y],V=it(P)?P.bind(n,n):it(P.get)?P.get.bind(n,n):Mn,d=!it(P)&&it(P.set)?P.set.bind(n):Mn,M=tm({get:V,set:d});Object.defineProperty(r,Y,{enumerable:!0,configurable:!0,get:()=>M.value,set:W=>M.value=W})}if(l)for(const Y in l)Yl(l[Y],r,n,Y);if(m){const Y=it(m)?m.call(n):m;Reflect.ownKeys(Y).forEach(P=>{fd(P,Y[P])})}h&&Xl(h,e,"c");function H(Y,P){ot(P)?P.forEach(V=>Y(V.bind(n))):P&&Y(P.bind(n))}if(H(bd,c),H(Hl,_),H(xd,p),H(Dl,o),H(vd,j),H(_d,O),H(Sd,A),H(kd,R),H(wd,g),H(Pl,v),H(zl,L),H(yd,S),ot(f))if(f.length){const Y=e.exposed||(e.exposed={});f.forEach(P=>{Object.defineProperty(Y,P,{get:()=>n[P],set:V=>n[P]=V})})}else e.exposed||(e.exposed={});T&&e.render===Mn&&(e.render=T),x!=null&&(e.inheritAttrs=x),b&&(e.components=b),y&&(e.directives=y)}function Rd(e,t,n=Mn,r=!1){ot(e)&&(e=Rs(e));for(const a in e){const i=e[a];let s;Yt(i)?"default"in i?s=ys(i.from||a,i.default,!0):s=ys(i.from||a):s=ys(i),qt(s)&&r?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:l=>s.value=l}):t[a]=s}}function Xl(e,t,n){un(ot(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function Yl(e,t,n,r){const a=r.includes(".")?Bl(n,r):()=>n[r];if(Xt(e)){const i=t[e];it(i)&&ws(a,i)}else if(it(e))ws(a,e.bind(n));else if(Yt(e))if(ot(e))e.forEach(i=>Yl(i,t,n,r));else{const i=it(e.handler)?e.handler.bind(n):t[e.handler];it(i)&&ws(a,i,e)}}function Kl(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,l=i.get(t);let m;return l?m=l:!a.length&&!n&&!r?m=t:(m={},a.length&&a.forEach(u=>ca(m,u,s,!0)),ca(m,t,s)),i.set(t,m),m}function ca(e,t,n,r=!1){const{mixins:a,extends:i}=t;i&&ca(e,i,n,!0),a&&a.forEach(s=>ca(e,s,n,!0));for(const s in t)if(!(r&&s==="expose")){const l=Id[s]||n&&n[s];e[s]=l?l(e[s],t[s]):t[s]}return e}const Id={data:Gl,props:hr,emits:hr,methods:hr,computed:hr,beforeCreate:Kt,created:Kt,beforeMount:Kt,mounted:Kt,beforeUpdate:Kt,updated:Kt,beforeDestroy:Kt,beforeUnmount:Kt,destroyed:Kt,unmounted:Kt,activated:Kt,deactivated:Kt,errorCaptured:Kt,serverPrefetch:Kt,components:hr,directives:hr,watch:Bd,provide:Gl,inject:Cd};function Gl(e,t){return t?e?function(){return nn(it(e)?e.call(this,this):e,it(t)?t.call(this,this):t)}:t:e}function Cd(e,t){return hr(Rs(e),Rs(t))}function Rs(e){if(ot(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Kt(e,t){return e?[...new Set([].concat(e,t))]:t}function hr(e,t){return e?nn(nn(Object.create(null),e),t):t}function Bd(e,t){if(!e)return t;if(!t)return e;const n=nn(Object.create(null),e);for(const r in t)n[r]=Kt(e[r],t[r]);return n}function Od(e,t,n,r=!1){const a={},i={};vs(i,da,1),e.propsDefaults=Object.create(null),Wl(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);n?e.props=r?a:N1(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function Ld(e,t,n,r){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,l=mt(a),[m]=e.propsOptions;let u=!1;if((r||s>0)&&!(s&16)){if(s&8){const h=e.vnode.dynamicProps;for(let c=0;c<h.length;c++){let _=h[c];if(ra(e.emitsOptions,_))continue;const p=t[_];if(m)if(ft(i,_))p!==i[_]&&(i[_]=p,u=!0);else{const o=An(_);a[o]=Is(m,l,o,p,e,!1)}else p!==i[_]&&(i[_]=p,u=!0)}}}else{Wl(e,t,a,i)&&(u=!0);let h;for(const c in l)(!t||!ft(t,c)&&((h=$i(c))===c||!ft(t,h)))&&(m?n&&(n[c]!==void 0||n[h]!==void 0)&&(a[c]=Is(m,l,c,void 0,e,!0)):delete a[c]);if(i!==l)for(const c in i)(!t||!ft(t,c)&&!0)&&(delete i[c],u=!0)}u&&Hn(e,"set","$attrs")}function Wl(e,t,n,r){const[a,i]=e.propsOptions;let s=!1,l;if(t)for(let m in t){if(Qi(m))continue;const u=t[m];let h;a&&ft(a,h=An(m))?!i||!i.includes(h)?n[h]=u:(l||(l={}))[h]=u:ra(e.emitsOptions,m)||(!(m in r)||u!==r[m])&&(r[m]=u,s=!0)}if(i){const m=mt(n),u=l||bt;for(let h=0;h<i.length;h++){const c=i[h];n[c]=Is(a,m,c,u[c],e,!ft(u,c))}}return s}function Is(e,t,n,r,a,i){const s=e[n];if(s!=null){const l=ft(s,"default");if(l&&r===void 0){const m=s.default;if(s.type!==Function&&it(m)){const{propsDefaults:u}=a;n in u?r=u[n]:(zr(a),r=u[n]=m.call(null,t),_r())}else r=m}s[0]&&(i&&!l?r=!1:s[1]&&(r===""||r===$i(n))&&(r=!0))}return r}function Zl(e,t,n=!1){const r=t.propsCache,a=r.get(e);if(a)return a;const i=e.props,s={},l=[];let m=!1;if(!it(e)){const h=c=>{m=!0;const[_,p]=Zl(c,t,!0);nn(s,_),p&&l.push(...p)};!n&&t.mixins.length&&t.mixins.forEach(h),e.extends&&h(e.extends),e.mixins&&e.mixins.forEach(h)}if(!i&&!m)return r.set(e,Hr),Hr;if(ot(i))for(let h=0;h<i.length;h++){const c=An(i[h]);Ql(c)&&(s[c]=bt)}else if(i)for(const h in i){const c=An(h);if(Ql(c)){const _=i[h],p=s[c]=ot(_)||it(_)?{type:_}:_;if(p){const o=e0(Boolean,p.type),j=e0(String,p.type);p[0]=o>-1,p[1]=j<0||o<j,(o>-1||ft(p,"default"))&&l.push(c)}}}const u=[s,l];return r.set(e,u),u}function Ql(e){return e[0]!=="$"}function Jl(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function $l(e,t){return Jl(e)===Jl(t)}function e0(e,t){return ot(t)?t.findIndex(n=>$l(n,e)):it(t)&&$l(t,e)?0:-1}const t0=e=>e[0]==="_"||e==="$stable",Cs=e=>ot(e)?e.map(En):[En(e)],Fd=(e,t,n)=>{if(t._n)return t;const r=Ge((...a)=>Cs(t(...a)),n);return r._c=!1,r},n0=(e,t,n)=>{const r=e._ctx;for(const a in e){if(t0(a))continue;const i=e[a];if(it(i))t[a]=Fd(a,i,r);else if(i!=null){const s=Cs(i);t[a]=()=>s}}},r0=(e,t)=>{const n=Cs(t);e.slots.default=()=>n},jd=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=mt(t),vs(t,"_",n)):n0(t,e.slots={})}else e.slots={},t&&r0(e,t);vs(e.slots,da,1)},Nd=(e,t,n)=>{const{vnode:r,slots:a}=e;let i=!0,s=bt;if(r.shapeFlag&32){const l=t._;l?n&&l===1?i=!1:(nn(a,t),!n&&l===1&&delete a._):(i=!t.$stable,n0(t,a)),s=t}else t&&(r0(e,t),s={default:1});if(i)for(const l in a)!t0(l)&&!(l in s)&&delete a[l]};function i0(){return{app:null,config:{isNativeTag:G1,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Hd=0;function Dd(e,t){return function(r,a=null){it(r)||(r=Object.assign({},r)),a!=null&&!Yt(a)&&(a=null);const i=i0(),s=new Set;let l=!1;const m=i.app={_uid:Hd++,_component:r,_props:a,_container:null,_context:i,_instance:null,version:rm,get config(){return i.config},set config(u){},use(u,...h){return s.has(u)||(u&&it(u.install)?(s.add(u),u.install(m,...h)):it(u)&&(s.add(u),u(m,...h))),m},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),m},component(u,h){return h?(i.components[u]=h,m):i.components[u]},directive(u,h){return h?(i.directives[u]=h,m):i.directives[u]},mount(u,h,c){if(!l){const _=Oe(r,a);return _.appContext=i,h&&t?t(_,u):e(_,u,c),l=!0,m._container=u,u.__vue_app__=m,fa(_.component)||_.component.proxy}},unmount(){l&&(e(null,m._container),delete m._container.__vue_app__)},provide(u,h){return i.provides[u]=h,m}};return m}}function Bs(e,t,n,r,a=!1){if(ot(e)){e.forEach((_,p)=>Bs(_,t&&(ot(t)?t[p]:t),n,r,a));return}if(ui(r)&&!a)return;const i=r.shapeFlag&4?fa(r.component)||r.component.proxy:r.el,s=a?null:i,{i:l,r:m}=e,u=t&&t.r,h=l.refs===bt?l.refs={}:l.refs,c=l.setupState;if(u!=null&&u!==m&&(Xt(u)?(h[u]=null,ft(c,u)&&(c[u]=null)):qt(u)&&(u.value=null)),it(m))Qn(m,l,12,[s,h]);else{const _=Xt(m),p=qt(m);if(_||p){const o=()=>{if(e.f){const j=_?h[m]:m.value;a?ot(j)&&ds(j,i):ot(j)?j.includes(i)||j.push(i):_?(h[m]=[i],ft(c,m)&&(c[m]=h[m])):(m.value=[i],e.k&&(h[e.k]=m.value))}else _?(h[m]=s,ft(c,m)&&(c[m]=s)):p&&(m.value=s,e.k&&(h[e.k]=s))};s?(o.id=-1,Wt(o,n)):o()}}}const Wt=md;function Pd(e){return zd(e)}function zd(e,t){const n=ed();n.__VUE__=!0;const{insert:r,remove:a,patchProp:i,createElement:s,createText:l,createComment:m,setText:u,setElementText:h,parentNode:c,nextSibling:_,setScopeId:p=Mn,cloneNode:o,insertStaticContent:j}=e,O=(z,X,ne,ce=null,de=null,Me=null,Ee=!1,we=null,Ae=!!X.dynamicChildren)=>{if(z===X)return;z&&!vr(z,X)&&(ce=He(z),C(z,de,Me,!0),z=null),X.patchFlag===-2&&(Ae=!1,X.dynamicChildren=null);const{type:be,ref:Pe,shapeFlag:je}=X;switch(be){case Os:I(z,X,ne,ce);break;case mn:v(z,X,ne,ce);break;case Ls:z==null&&E(X,ne,ce,Ee);break;case st:y(z,X,ne,ce,de,Me,Ee,we,Ae);break;default:je&1?R(z,X,ne,ce,de,Me,Ee,we,Ae):je&6?k(z,X,ne,ce,de,Me,Ee,we,Ae):(je&64||je&128)&&be.process(z,X,ne,ce,de,Me,Ee,we,Ae,pe)}Pe!=null&&de&&Bs(Pe,z&&z.ref,Me,X||z,!X)},I=(z,X,ne,ce)=>{if(z==null)r(X.el=l(X.children),ne,ce);else{const de=X.el=z.el;X.children!==z.children&&u(de,X.children)}},v=(z,X,ne,ce)=>{z==null?r(X.el=m(X.children||""),ne,ce):X.el=z.el},E=(z,X,ne,ce)=>{[z.el,z.anchor]=j(z.children,X,ne,ce,z.el,z.anchor)},L=({el:z,anchor:X},ne,ce)=>{let de;for(;z&&z!==X;)de=_(z),r(z,ne,ce),z=de;r(X,ne,ce)},T=({el:z,anchor:X})=>{let ne;for(;z&&z!==X;)ne=_(z),a(z),z=ne;a(X)},R=(z,X,ne,ce,de,Me,Ee,we,Ae)=>{Ee=Ee||X.type==="svg",z==null?g(X,ne,ce,de,Me,Ee,we,Ae):f(z,X,de,Me,Ee,we,Ae)},g=(z,X,ne,ce,de,Me,Ee,we)=>{let Ae,be;const{type:Pe,props:je,shapeFlag:ze,transition:Ue,patchFlag:Ke,dirs:ue}=z;if(z.el&&o!==void 0&&Ke===-1)Ae=z.el=o(z.el);else{if(Ae=z.el=s(z.type,Me,je&&je.is,je),ze&8?h(Ae,z.children):ze&16&&S(z.children,Ae,null,ce,de,Me&&Pe!=="foreignObject",Ee,we),ue&&fr(z,null,ce,"created"),je){for(const ee in je)ee!=="value"&&!Qi(ee)&&i(Ae,ee,null,je[ee],Me,z.children,ce,de,_e);"value"in je&&i(Ae,"value",null,je.value),(be=je.onVnodeBeforeMount)&&Tn(be,ce,z)}A(Ae,z,z.scopeId,Ee,ce)}ue&&fr(z,null,ce,"beforeMount");const ke=(!de||de&&!de.pendingBranch)&&Ue&&!Ue.persisted;ke&&Ue.beforeEnter(Ae),r(Ae,X,ne),((be=je&&je.onVnodeMounted)||ke||ue)&&Wt(()=>{be&&Tn(be,ce,z),ke&&Ue.enter(Ae),ue&&fr(z,null,ce,"mounted")},de)},A=(z,X,ne,ce,de)=>{if(ne&&p(z,ne),ce)for(let Me=0;Me<ce.length;Me++)p(z,ce[Me]);if(de){let Me=de.subTree;if(X===Me){const Ee=de.vnode;A(z,Ee,Ee.scopeId,Ee.slotScopeIds,de.parent)}}},S=(z,X,ne,ce,de,Me,Ee,we,Ae=0)=>{for(let be=Ae;be<z.length;be++){const Pe=z[be]=we?er(z[be]):En(z[be]);O(null,Pe,X,ne,ce,de,Me,Ee,we)}},f=(z,X,ne,ce,de,Me,Ee)=>{const we=X.el=z.el;let{patchFlag:Ae,dynamicChildren:be,dirs:Pe}=X;Ae|=z.patchFlag&16;const je=z.props||bt,ze=X.props||bt;let Ue;ne&&pr(ne,!1),(Ue=ze.onVnodeBeforeUpdate)&&Tn(Ue,ne,X,z),Pe&&fr(X,z,ne,"beforeUpdate"),ne&&pr(ne,!0);const Ke=de&&X.type!=="foreignObject";if(be?x(z.dynamicChildren,be,we,ne,ce,Ke,Me):Ee||V(z,X,we,null,ne,ce,Ke,Me,!1),Ae>0){if(Ae&16)b(we,X,je,ze,ne,ce,de);else if(Ae&2&&je.class!==ze.class&&i(we,"class",null,ze.class,de),Ae&4&&i(we,"style",je.style,ze.style,de),Ae&8){const ue=X.dynamicProps;for(let ke=0;ke<ue.length;ke++){const ee=ue[ke],Ce=je[ee],B=ze[ee];(B!==Ce||ee==="value")&&i(we,ee,Ce,B,de,z.children,ne,ce,_e)}}Ae&1&&z.children!==X.children&&h(we,X.children)}else!Ee&&be==null&&b(we,X,je,ze,ne,ce,de);((Ue=ze.onVnodeUpdated)||Pe)&&Wt(()=>{Ue&&Tn(Ue,ne,X,z),Pe&&fr(X,z,ne,"updated")},ce)},x=(z,X,ne,ce,de,Me,Ee)=>{for(let we=0;we<X.length;we++){const Ae=z[we],be=X[we],Pe=Ae.el&&(Ae.type===st||!vr(Ae,be)||Ae.shapeFlag&70)?c(Ae.el):ne;O(Ae,be,Pe,null,ce,de,Me,Ee,!0)}},b=(z,X,ne,ce,de,Me,Ee)=>{if(ne!==ce){for(const we in ce){if(Qi(we))continue;const Ae=ce[we],be=ne[we];Ae!==be&&we!=="value"&&i(z,we,be,Ae,Ee,X.children,de,Me,_e)}if(ne!==bt)for(const we in ne)!Qi(we)&&!(we in ce)&&i(z,we,ne[we],null,Ee,X.children,de,Me,_e);"value"in ce&&i(z,"value",ne.value,ce.value)}},y=(z,X,ne,ce,de,Me,Ee,we,Ae)=>{const be=X.el=z?z.el:l(""),Pe=X.anchor=z?z.anchor:l("");let{patchFlag:je,dynamicChildren:ze,slotScopeIds:Ue}=X;Ue&&(we=we?we.concat(Ue):Ue),z==null?(r(be,ne,ce),r(Pe,ne,ce),S(X.children,ne,Pe,de,Me,Ee,we,Ae)):je>0&&je&64&&ze&&z.dynamicChildren?(x(z.dynamicChildren,ze,ne,de,Me,Ee,we),(X.key!=null||de&&X===de.subTree)&&a0(z,X,!0)):V(z,X,ne,Pe,de,Me,Ee,we,Ae)},k=(z,X,ne,ce,de,Me,Ee,we,Ae)=>{X.slotScopeIds=we,z==null?X.shapeFlag&512?de.ctx.activate(X,ne,ce,Ee,Ae):w(X,ne,ce,de,Me,Ee,Ae):H(z,X,Ae)},w=(z,X,ne,ce,de,Me,Ee)=>{const we=z.component=Gd(z,ce,de);if(aa(z)&&(we.ctx.renderer=pe),Wd(we),we.asyncDep){if(de&&de.registerDep(we,Y),!z.el){const Ae=we.subTree=Oe(mn);v(null,Ae,X,ne)}return}Y(we,z,X,ne,de,Me,Ee)},H=(z,X,ne)=>{const ce=X.component=z.component;if(cd(z,X,ne))if(ce.asyncDep&&!ce.asyncResolved){P(ce,X,ne);return}else ce.next=X,rd(ce.update),ce.update();else X.el=z.el,ce.vnode=X},Y=(z,X,ne,ce,de,Me,Ee)=>{const we=()=>{if(z.isMounted){let{next:Pe,bu:je,u:ze,parent:Ue,vnode:Ke}=z,ue=Pe,ke;pr(z,!1),Pe?(Pe.el=Ke.el,P(z,Pe,Ee)):Pe=Ke,je&&ps(je),(ke=Pe.props&&Pe.props.onVnodeBeforeUpdate)&&Tn(ke,Ue,Pe,Ke),pr(z,!0);const ee=xs(z),Ce=z.subTree;z.subTree=ee,O(Ce,ee,c(Ce.el),He(Ce),z,de,Me),Pe.el=ee.el,ue===null&&ud(z,ee.el),ze&&Wt(ze,de),(ke=Pe.props&&Pe.props.onVnodeUpdated)&&Wt(()=>Tn(ke,Ue,Pe,Ke),de)}else{let Pe;const{el:je,props:ze}=X,{bm:Ue,m:Ke,parent:ue}=z,ke=ui(X);if(pr(z,!1),Ue&&ps(Ue),!ke&&(Pe=ze&&ze.onVnodeBeforeMount)&&Tn(Pe,ue,X),pr(z,!0),je&&rt){const ee=()=>{z.subTree=xs(z),rt(je,z.subTree,z,de,null)};ke?X.type.__asyncLoader().then(()=>!z.isUnmounted&&ee()):ee()}else{const ee=z.subTree=xs(z);O(null,ee,ne,ce,z,de,Me),X.el=ee.el}if(Ke&&Wt(Ke,de),!ke&&(Pe=ze&&ze.onVnodeMounted)){const ee=X;Wt(()=>Tn(Pe,ue,ee),de)}(X.shapeFlag&256||ue&&ui(ue.vnode)&&ue.vnode.shapeFlag&256)&&z.a&&Wt(z.a,de),z.isMounted=!0,X=ne=ce=null}},Ae=z.effect=new es(we,()=>wl(be),z.scope),be=z.update=()=>Ae.run();be.id=z.uid,pr(z,!0),be()},P=(z,X,ne)=>{X.component=z;const ce=z.vnode.props;z.vnode=X,z.next=null,Ld(z,X.props,ce,ne),Nd(z,X.children,ne),Fr(),na(void 0,z.update),jr()},V=(z,X,ne,ce,de,Me,Ee,we,Ae=!1)=>{const be=z&&z.children,Pe=z?z.shapeFlag:0,je=X.children,{patchFlag:ze,shapeFlag:Ue}=X;if(ze>0){if(ze&128){M(be,je,ne,ce,de,Me,Ee,we,Ae);return}else if(ze&256){d(be,je,ne,ce,de,Me,Ee,we,Ae);return}}Ue&8?(Pe&16&&_e(be,de,Me),je!==be&&h(ne,je)):Pe&16?Ue&16?M(be,je,ne,ce,de,Me,Ee,we,Ae):_e(be,de,Me,!0):(Pe&8&&h(ne,""),Ue&16&&S(je,ne,ce,de,Me,Ee,we,Ae))},d=(z,X,ne,ce,de,Me,Ee,we,Ae)=>{z=z||Hr,X=X||Hr;const be=z.length,Pe=X.length,je=Math.min(be,Pe);let ze;for(ze=0;ze<je;ze++){const Ue=X[ze]=Ae?er(X[ze]):En(X[ze]);O(z[ze],Ue,ne,null,de,Me,Ee,we,Ae)}be>Pe?_e(z,de,Me,!0,!1,je):S(X,ne,ce,de,Me,Ee,we,Ae,je)},M=(z,X,ne,ce,de,Me,Ee,we,Ae)=>{let be=0;const Pe=X.length;let je=z.length-1,ze=Pe-1;for(;be<=je&&be<=ze;){const Ue=z[be],Ke=X[be]=Ae?er(X[be]):En(X[be]);if(vr(Ue,Ke))O(Ue,Ke,ne,null,de,Me,Ee,we,Ae);else break;be++}for(;be<=je&&be<=ze;){const Ue=z[je],Ke=X[ze]=Ae?er(X[ze]):En(X[ze]);if(vr(Ue,Ke))O(Ue,Ke,ne,null,de,Me,Ee,we,Ae);else break;je--,ze--}if(be>je){if(be<=ze){const Ue=ze+1,Ke=Ue<Pe?X[Ue].el:ce;for(;be<=ze;)O(null,X[be]=Ae?er(X[be]):En(X[be]),ne,Ke,de,Me,Ee,we,Ae),be++}}else if(be>ze)for(;be<=je;)C(z[be],de,Me,!0),be++;else{const Ue=be,Ke=be,ue=new Map;for(be=Ke;be<=ze;be++){const K=X[be]=Ae?er(X[be]):En(X[be]);K.key!=null&&ue.set(K.key,be)}let ke,ee=0;const Ce=ze-Ke+1;let B=!1,N=0;const U=new Array(Ce);for(be=0;be<Ce;be++)U[be]=0;for(be=Ue;be<=je;be++){const K=z[be];if(ee>=Ce){C(K,de,Me,!0);continue}let D;if(K.key!=null)D=ue.get(K.key);else for(ke=Ke;ke<=ze;ke++)if(U[ke-Ke]===0&&vr(K,X[ke])){D=ke;break}D===void 0?C(K,de,Me,!0):(U[D-Ke]=be+1,D>=N?N=D:B=!0,O(K,X[D],ne,null,de,Me,Ee,we,Ae),ee++)}const q=B?Ud(U):Hr;for(ke=q.length-1,be=Ce-1;be>=0;be--){const K=Ke+be,D=X[K],Z=K+1<Pe?X[K+1].el:ce;U[be]===0?O(null,D,ne,Z,de,Me,Ee,we,Ae):B&&(ke<0||be!==q[ke]?W(D,ne,Z,2):ke--)}}},W=(z,X,ne,ce,de=null)=>{const{el:Me,type:Ee,transition:we,children:Ae,shapeFlag:be}=z;if(be&6){W(z.component.subTree,X,ne,ce);return}if(be&128){z.suspense.move(X,ne,ce);return}if(be&64){Ee.move(z,X,ne,pe);return}if(Ee===st){r(Me,X,ne);for(let je=0;je<Ae.length;je++)W(Ae[je],X,ne,ce);r(z.anchor,X,ne);return}if(Ee===Ls){L(z,X,ne);return}if(ce!==2&&be&1&&we)if(ce===0)we.beforeEnter(Me),r(Me,X,ne),Wt(()=>we.enter(Me),de);else{const{leave:je,delayLeave:ze,afterLeave:Ue}=we,Ke=()=>r(Me,X,ne),ue=()=>{je(Me,()=>{Ke(),Ue&&Ue()})};ze?ze(Me,Ke,ue):ue()}else r(Me,X,ne)},C=(z,X,ne,ce=!1,de=!1)=>{const{type:Me,props:Ee,ref:we,children:Ae,dynamicChildren:be,shapeFlag:Pe,patchFlag:je,dirs:ze}=z;if(we!=null&&Bs(we,null,ne,z,!0),Pe&256){X.ctx.deactivate(z);return}const Ue=Pe&1&&ze,Ke=!ui(z);let ue;if(Ke&&(ue=Ee&&Ee.onVnodeBeforeUnmount)&&Tn(ue,X,z),Pe&6)ge(z.component,ne,ce);else{if(Pe&128){z.suspense.unmount(ne,ce);return}Ue&&fr(z,null,X,"beforeUnmount"),Pe&64?z.type.remove(z,X,ne,de,pe,ce):be&&(Me!==st||je>0&&je&64)?_e(be,X,ne,!1,!0):(Me===st&&je&384||!de&&Pe&16)&&_e(Ae,X,ne),ce&&fe(z)}(Ke&&(ue=Ee&&Ee.onVnodeUnmounted)||Ue)&&Wt(()=>{ue&&Tn(ue,X,z),Ue&&fr(z,null,X,"unmounted")},ne)},fe=z=>{const{type:X,el:ne,anchor:ce,transition:de}=z;if(X===st){Se(ne,ce);return}if(X===Ls){T(z);return}const Me=()=>{a(ne),de&&!de.persisted&&de.afterLeave&&de.afterLeave()};if(z.shapeFlag&1&&de&&!de.persisted){const{leave:Ee,delayLeave:we}=de,Ae=()=>Ee(ne,Me);we?we(z.el,Me,Ae):Ae()}else Me()},Se=(z,X)=>{let ne;for(;z!==X;)ne=_(z),a(z),z=ne;a(X)},ge=(z,X,ne)=>{const{bum:ce,scope:de,update:Me,subTree:Ee,um:we}=z;ce&&ps(ce),de.stop(),Me&&(Me.active=!1,C(Ee,z,X,ne)),we&&Wt(we,X),Wt(()=>{z.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&z.asyncDep&&!z.asyncResolved&&z.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},_e=(z,X,ne,ce=!1,de=!1,Me=0)=>{for(let Ee=Me;Ee<z.length;Ee++)C(z[Ee],X,ne,ce,de)},He=z=>z.shapeFlag&6?He(z.component.subTree):z.shapeFlag&128?z.suspense.next():_(z.anchor||z.el),Re=(z,X,ne)=>{z==null?X._vnode&&C(X._vnode,null,null,!0):O(X._vnode||null,z,X,null,null,null,ne),Ml(),X._vnode=z},pe={p:O,um:C,m:W,r:fe,mt:w,mc:S,pc:V,pbc:x,n:He,o:e};let Ve,rt;return t&&([Ve,rt]=t(pe)),{render:Re,hydrate:Ve,createApp:Dd(Re,Ve)}}function pr({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function a0(e,t,n=!1){const r=e.children,a=t.children;if(ot(r)&&ot(a))for(let i=0;i<r.length;i++){const s=r[i];let l=a[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=a[i]=er(a[i]),l.el=s.el),n||a0(s,l))}}function Ud(e){const t=e.slice(),n=[0];let r,a,i,s,l;const m=e.length;for(r=0;r<m;r++){const u=e[r];if(u!==0){if(a=n[n.length-1],e[a]<u){t[r]=a,n.push(r);continue}for(i=0,s=n.length-1;i<s;)l=i+s>>1,e[n[l]]<u?i=l+1:s=l;u<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,s=n[i-1];i-- >0;)n[i]=s,s=t[s];return n}const Vd=e=>e.__isTeleport,st=Symbol(void 0),Os=Symbol(void 0),mn=Symbol(void 0),Ls=Symbol(void 0),di=[];let _n=null;function Q(e=!1){di.push(_n=e?null:[])}function qd(){di.pop(),_n=di[di.length-1]||null}let mi=1;function s0(e){mi+=e}function o0(e){return e.dynamicChildren=mi>0?_n||Hr:null,qd(),mi>0&&_n&&_n.push(e),e}function se(e,t,n,r,a,i){return o0(he(e,t,n,r,a,i,!0))}function ht(e,t,n,r,a){return o0(Oe(e,t,n,r,a,!0))}function ua(e){return e?e.__v_isVNode===!0:!1}function vr(e,t){return e.type===t.type&&e.key===t.key}const da="__vInternal",l0=({key:e})=>e!=null?e:null,ma=({ref:e,ref_key:t,ref_for:n})=>e!=null?Xt(e)||qt(e)||it(e)?{i:Dt,r:e,k:t,f:!!n}:e:null;function he(e,t=null,n=null,r=0,a=null,i=e===st?0:1,s=!1,l=!1){const m={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&l0(t),ref:t&&ma(t),scopeId:Tl,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:a,dynamicChildren:null,appContext:null};return l?(Fs(m,n),i&128&&e.normalize(m)):n&&(m.shapeFlag|=Xt(n)?8:16),mi>0&&!s&&_n&&(m.patchFlag>0||i&6)&&m.patchFlag!==32&&_n.push(m),m}const Oe=Xd;function Xd(e,t=null,n=null,r=0,a=null,i=!1){if((!e||e===Ul)&&(e=mn),ua(e)){const l=$n(e,t,!0);return n&&Fs(l,n),mi>0&&!i&&_n&&(l.shapeFlag&6?_n[_n.indexOf(e)]=l:_n.push(l)),l.patchFlag|=-2,l}if(em(e)&&(e=e.__vccOpts),t){t=pt(t);let{class:l,style:m}=t;l&&!Xt(l)&&(t.class=$e(l)),Yt(m)&&(ll(m)&&!ot(m)&&(m=nn({},m)),t.style=St(m))}const s=Xt(e)?1:dd(e)?128:Vd(e)?64:Yt(e)?4:it(e)?2:0;return he(e,t,n,r,a,s,i,!0)}function pt(e){return e?ll(e)||da in e?nn({},e):e:null}function $n(e,t,n=!1){const{props:r,ref:a,patchFlag:i,children:s}=e,l=t?js(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&l0(l),ref:t&&t.ref?n&&a?ot(a)?a.concat(ma(t)):[a,ma(t)]:ma(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==st?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&$n(e.ssContent),ssFallback:e.ssFallback&&$n(e.ssFallback),el:e.el,anchor:e.anchor}}function Un(e=" ",t=0){return Oe(Os,null,e,t)}function Te(e="",t=!1){return t?(Q(),ht(mn,null,e)):Oe(mn,null,e)}function En(e){return e==null||typeof e=="boolean"?Oe(mn):ot(e)?Oe(st,null,e.slice()):typeof e=="object"?er(e):Oe(Os,null,String(e))}function er(e){return e.el===null||e.memo?e:$n(e)}function Fs(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ot(t))n=16;else if(typeof t=="object")if(r&65){const a=t.default;a&&(a._c&&(a._d=!1),Fs(e,a()),a._c&&(a._d=!0));return}else{n=32;const a=t._;!a&&!(da in t)?t._ctx=Dt:a===3&&Dt&&(Dt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else it(t)?(t={default:t,_ctx:Dt},n=32):(t=String(t),r&64?(n=16,t=[Un(t)]):n=8);e.children=t,e.shapeFlag|=n}function js(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const a in r)if(a==="class")t.class!==r.class&&(t.class=$e([t.class,r.class]));else if(a==="style")t.style=St([t.style,r.style]);else if(us(a)){const i=t[a],s=r[a];s&&i!==s&&!(ot(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=r[a])}return t}function Tn(e,t,n,r=null){un(e,t,7,[n,r])}const Yd=i0();let Kd=0;function Gd(e,t,n){const r=e.type,a=(t?t.appContext:e.appContext)||Yd,i={uid:Kd++,vnode:e,type:r,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new u1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Zl(r,a),emitsOptions:El(r,a),emit:null,emitted:null,propsDefaults:bt,inheritAttrs:r.inheritAttrs,ctx:bt,data:bt,props:bt,attrs:bt,slots:bt,refs:bt,setupState:bt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=sd.bind(null,i),e.ce&&e.ce(i),i}let Ft=null;const c0=()=>Ft||Dt,zr=e=>{Ft=e,e.scope.on()},_r=()=>{Ft&&Ft.scope.off(),Ft=null};function u0(e){return e.vnode.shapeFlag&4}let fi=!1;function Wd(e,t=!1){fi=t;const{props:n,children:r}=e.vnode,a=u0(e);Od(e,n,a,t),jd(e,r);const i=a?Zd(e,t):void 0;return fi=!1,i}function Zd(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=cl(new Proxy(e.ctx,Ed));const{setup:r}=n;if(r){const a=e.setupContext=r.length>1?Jd(e):null;zr(e),Fr();const i=Qn(r,e,0,[e.props,a]);if(jr(),_r(),pl(i)){if(i.then(_r,_r),t)return i.then(s=>{d0(e,s,t)}).catch(s=>{ea(s,e,0)});e.asyncDep=i}else d0(e,i,t)}else f0(e,t)}function d0(e,t,n){it(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)&&(e.setupState=ul(t)),f0(e,n)}let m0;function f0(e,t,n){const r=e.type;if(!e.render){if(!t&&m0&&!r.render){const a=r.template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:l,compilerOptions:m}=r,u=nn(nn({isCustomElement:i,delimiters:l},s),m);r.render=m0(a,u)}}e.render=r.render||Mn}zr(e),Fr(),Td(e),jr(),_r()}function Qd(e){return new Proxy(e.attrs,{get(t,n){return tn(e,"get","$attrs"),t[n]}})}function Jd(e){const t=r=>{e.exposed=r||{}};let n;return{get attrs(){return n||(n=Qd(e))},slots:e.slots,emit:e.emit,expose:t}}function fa(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(ul(cl(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in la)return la[n](e)}}))}function $d(e,t=!0){return it(e)?e.displayName||e.name:e.name||t&&e.__name}function em(e){return it(e)&&"__vccOpts"in e}const tm=(e,t)=>V1(e,t,fi);function nm(e,t,n){const r=arguments.length;return r===2?Yt(t)&&!ot(t)?ua(t)?Oe(e,null,[t]):Oe(e,t):Oe(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&ua(n)&&(n=[n]),Oe(e,t,n))}const rm="3.2.37";function im(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}const am=im("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function h0(e){return!!e||e===""}const sm=/^on[^a-z]/,om=e=>sm.test(e),lm=e=>e.startsWith("onUpdate:"),hi=Object.assign,pi=Array.isArray,cm=e=>typeof e=="function",Ns=e=>typeof e=="string",um=e=>e!==null&&typeof e=="object",Hs=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},dm=/-(\w)/g,p0=Hs(e=>e.replace(dm,(t,n)=>n?n.toUpperCase():"")),mm=/\B([A-Z])/g,Ur=Hs(e=>e.replace(mm,"-$1").toLowerCase()),fm=Hs(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ds=e=>{const t=parseFloat(e);return isNaN(t)?e:t},hm="http://www.w3.org/2000/svg",gr=typeof document!="undefined"?document:null,v0=gr&&gr.createElement("template"),pm={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const a=t?gr.createElementNS(hm,e):gr.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&a.setAttribute("multiple",r.multiple),a},createText:e=>gr.createTextNode(e),createComment:e=>gr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>gr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,r,a,i){const s=n?n.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),n),!(a===i||!(a=a.nextSibling)););else{v0.innerHTML=r?`<svg>${e}</svg>`:e;const l=v0.content;if(r){const m=l.firstChild;for(;m.firstChild;)l.appendChild(m.firstChild);l.removeChild(m)}t.insertBefore(l,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function vm(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function _m(e,t,n){const r=e.style,a=Ns(n);if(n&&!a){for(const i in n)Ps(r,i,n[i]);if(t&&!Ns(t))for(const i in t)n[i]==null&&Ps(r,i,"")}else{const i=r.display;a?t!==n&&(r.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=i)}}const _0=/\s*!important$/;function Ps(e,t,n){if(pi(n))n.forEach(r=>Ps(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=gm(e,t);_0.test(n)?e.setProperty(Ur(r),n.replace(_0,""),"important"):e[r]=n}}const g0=["Webkit","Moz","ms"],zs={};function gm(e,t){const n=zs[t];if(n)return n;let r=An(t);if(r!=="filter"&&r in e)return zs[t]=r;r=fm(r);for(let a=0;a<g0.length;a++){const i=g0[a]+r;if(i in e)return zs[t]=i}return t}const b0="http://www.w3.org/1999/xlink";function bm(e,t,n,r,a){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(b0,t.slice(6,t.length)):e.setAttributeNS(b0,t,n);else{const i=am(t);n==null||i&&!h0(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function xm(e,t,n,r,a,i,s){if(t==="innerHTML"||t==="textContent"){r&&s(r,a,i),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const m=n==null?"":n;(e.value!==m||e.tagName==="OPTION")&&(e.value=m),n==null&&e.removeAttribute(t);return}let l=!1;if(n===""||n==null){const m=typeof e[t];m==="boolean"?n=h0(n):n==null&&m==="string"?(n="",l=!0):m==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(t)}const[x0,ym]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let Us=0;const wm=Promise.resolve(),km=()=>{Us=0},Sm=()=>Us||(wm.then(km),Us=x0());function Mm(e,t,n,r){e.addEventListener(t,n,r)}function Am(e,t,n,r){e.removeEventListener(t,n,r)}function Em(e,t,n,r,a=null){const i=e._vei||(e._vei={}),s=i[t];if(r&&s)s.value=r;else{const[l,m]=Tm(t);if(r){const u=i[t]=Rm(r,a);Mm(e,l,u,m)}else s&&(Am(e,l,s,m),i[t]=void 0)}}const y0=/(?:Once|Passive|Capture)$/;function Tm(e){let t;if(y0.test(e)){t={};let n;for(;n=e.match(y0);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Ur(e.slice(2)),t]}function Rm(e,t){const n=r=>{const a=r.timeStamp||x0();(ym||a>=n.attached-1)&&un(Im(r,n.value),t,5,[r])};return n.value=e,n.attached=Sm(),n}function Im(e,t){if(pi(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>a=>!a._stopped&&r&&r(a))}else return t}const w0=/^on[a-z]/,Cm=(e,t,n,r,a=!1,i,s,l,m)=>{t==="class"?vm(e,r,a):t==="style"?_m(e,n,r):om(t)?lm(t)||Em(e,t,n,r,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Bm(e,t,r,a))?xm(e,t,r,i,s,l,m):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),bm(e,t,r,a))};function Bm(e,t,n,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&w0.test(t)&&cm(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||w0.test(t)&&Ns(n)?!1:t in e}function Om(e,t){const n=pd(e);class r extends Vs{constructor(i){super(n,i,t)}}return r.def=n,r}const Lm=typeof HTMLElement!="undefined"?HTMLElement:class{};class Vs extends Lm{constructor(t,n={},r){super(),this._def=t,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&r?r(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,yl(()=>{this._connected||(F0(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);new MutationObserver(r=>{for(const a of r)this._setAttr(a.attributeName)}).observe(this,{attributes:!0});const t=r=>{const{props:a,styles:i}=r,s=!pi(a),l=a?s?Object.keys(a):a:[];let m;if(s)for(const u in this._props){const h=a[u];(h===Number||h&&h.type===Number)&&(this._props[u]=Ds(this._props[u]),(m||(m=Object.create(null)))[u]=!0)}this._numberProps=m;for(const u of Object.keys(this))u[0]!=="_"&&this._setProp(u,this[u],!0,!1);for(const u of l.map(p0))Object.defineProperty(this,u,{get(){return this._getProp(u)},set(h){this._setProp(u,h)}});this._applyStyles(i),this._update()},n=this._def.__asyncLoader;n?n().then(t):t(this._def)}_setAttr(t){let n=this.getAttribute(t);this._numberProps&&this._numberProps[t]&&(n=Ds(n)),this._setProp(p0(t),n,!1)}_getProp(t){return this._props[t]}_setProp(t,n,r=!0,a=!0){n!==this._props[t]&&(this._props[t]=n,a&&this._instance&&this._update(),r&&(n===!0?this.setAttribute(Ur(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Ur(t),n+""):n||this.removeAttribute(Ur(t))))}_update(){F0(this._createVNode(),this.shadowRoot)}_createVNode(){const t=Oe(this._def,hi({},this._props));return this._instance||(t.ce=n=>{this._instance=n,n.isCE=!0,n.emit=(a,...i)=>{this.dispatchEvent(new CustomEvent(a,{detail:i}))};let r=this;for(;r=r&&(r.parentNode||r.host);)if(r instanceof Vs){n.parent=r._instance;break}}),t}_applyStyles(t){t&&t.forEach(n=>{const r=document.createElement("style");r.textContent=n,this.shadowRoot.appendChild(r)})}}const tr="transition",vi="animation",Ct=(e,{slots:t})=>nm(Ll,M0(e),t);Ct.displayName="Transition";const k0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Fm=Ct.props=hi({},Ll.props,k0),br=(e,t=[])=>{pi(e)?e.forEach(n=>n(...t)):e&&e(...t)},S0=e=>e?pi(e)?e.some(t=>t.length>1):e.length>1:!1;function M0(e){const t={};for(const b in e)b in k0||(t[b]=e[b]);if(e.css===!1)return t;const{name:n="v",type:r,duration:a,enterFromClass:i=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:m=i,appearActiveClass:u=s,appearToClass:h=l,leaveFromClass:c=`${n}-leave-from`,leaveActiveClass:_=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,o=jm(a),j=o&&o[0],O=o&&o[1],{onBeforeEnter:I,onEnter:v,onEnterCancelled:E,onLeave:L,onLeaveCancelled:T,onBeforeAppear:R=I,onAppear:g=v,onAppearCancelled:A=E}=t,S=(b,y,k)=>{nr(b,y?h:l),nr(b,y?u:s),k&&k()},f=(b,y)=>{b._isLeaving=!1,nr(b,c),nr(b,p),nr(b,_),y&&y()},x=b=>(y,k)=>{const w=b?g:v,H=()=>S(y,b,k);br(w,[y,H]),A0(()=>{nr(y,b?m:i),Vn(y,b?h:l),S0(w)||E0(y,r,j,H)})};return hi(t,{onBeforeEnter(b){br(I,[b]),Vn(b,i),Vn(b,s)},onBeforeAppear(b){br(R,[b]),Vn(b,m),Vn(b,u)},onEnter:x(!1),onAppear:x(!0),onLeave(b,y){b._isLeaving=!0;const k=()=>f(b,y);Vn(b,c),C0(),Vn(b,_),A0(()=>{!b._isLeaving||(nr(b,c),Vn(b,p),S0(L)||E0(b,r,O,k))}),br(L,[b,k])},onEnterCancelled(b){S(b,!1),br(E,[b])},onAppearCancelled(b){S(b,!0),br(A,[b])},onLeaveCancelled(b){f(b),br(T,[b])}})}function jm(e){if(e==null)return null;if(um(e))return[qs(e.enter),qs(e.leave)];{const t=qs(e);return[t,t]}}function qs(e){return Ds(e)}function Vn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function nr(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function A0(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Nm=0;function E0(e,t,n,r){const a=e._endId=++Nm,i=()=>{a===e._endId&&r()};if(n)return setTimeout(i,n);const{type:s,timeout:l,propCount:m}=T0(e,t);if(!s)return r();const u=s+"end";let h=0;const c=()=>{e.removeEventListener(u,_),i()},_=p=>{p.target===e&&++h>=m&&c()};setTimeout(()=>{h<m&&c()},l+1),e.addEventListener(u,_)}function T0(e,t){const n=window.getComputedStyle(e),r=o=>(n[o]||"").split(", "),a=r(tr+"Delay"),i=r(tr+"Duration"),s=R0(a,i),l=r(vi+"Delay"),m=r(vi+"Duration"),u=R0(l,m);let h=null,c=0,_=0;t===tr?s>0&&(h=tr,c=s,_=i.length):t===vi?u>0&&(h=vi,c=u,_=m.length):(c=Math.max(s,u),h=c>0?s>u?tr:vi:null,_=h?h===tr?i.length:m.length:0);const p=h===tr&&/\b(transform|all)(,|$)/.test(n[tr+"Property"]);return{type:h,timeout:c,propCount:_,hasTransform:p}}function R0(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>I0(n)+I0(e[r])))}function I0(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function C0(){return document.body.offsetHeight}const B0=new WeakMap,O0=new WeakMap,Xs={name:"TransitionGroup",props:hi({},Fm,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=c0(),r=Ol();let a,i;return Dl(()=>{if(!a.length)return;const s=e.moveClass||`${e.name||"v"}-move`;if(!zm(a[0].el,n.vnode.el,s))return;a.forEach(Hm),a.forEach(Dm);const l=a.filter(Pm);C0(),l.forEach(m=>{const u=m.el,h=u.style;Vn(u,s),h.transform=h.webkitTransform=h.transitionDuration="";const c=u._moveCb=_=>{_&&_.target!==u||(!_||/transform$/.test(_.propertyName))&&(u.removeEventListener("transitionend",c),u._moveCb=null,nr(u,s))};u.addEventListener("transitionend",c)})}),()=>{const s=mt(e),l=M0(s);let m=s.tag||st;a=i,i=t.default?Ss(t.default()):[];for(let u=0;u<i.length;u++){const h=i[u];h.key!=null&&ci(h,li(h,l,r,n))}if(a)for(let u=0;u<a.length;u++){const h=a[u];ci(h,li(h,l,r,n)),B0.set(h,h.el.getBoundingClientRect())}return Oe(m,null,i)}}};function Hm(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Dm(e){O0.set(e,e.el.getBoundingClientRect())}function Pm(e){const t=B0.get(e),n=O0.get(e),r=t.left-n.left,a=t.top-n.top;if(r||a){const i=e.el.style;return i.transform=i.webkitTransform=`translate(${r}px,${a}px)`,i.transitionDuration="0s",e}}function zm(e,t,n){const r=e.cloneNode();e._vtc&&e._vtc.forEach(s=>{s.split(/\s+/).forEach(l=>l&&r.classList.remove(l))}),n.split(/\s+/).forEach(s=>s&&r.classList.add(s)),r.style.display="none";const a=t.nodeType===1?t:t.parentNode;a.appendChild(r);const{hasTransform:i}=T0(r);return a.removeChild(r),i}const Um=["ctrl","shift","alt","meta"],Vm={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Um.some(n=>e[`${n}Key`]&&!t.includes(n))},Rn=(e,t)=>(n,...r)=>{for(let a=0;a<t.length;a++){const i=Vm[t[a]];if(i&&i(n,t))return}return e(n,...r)},qm={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},xr=(e,t)=>n=>{if(!("key"in n))return;const r=Ur(n.key);if(t.some(a=>a===r||qm[a]===r))return e(n)},ha={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):_i(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),_i(e,!0),r.enter(e)):r.leave(e,()=>{_i(e,!1)}):_i(e,t))},beforeUnmount(e,{value:t}){_i(e,t)}};function _i(e,t){e.style.display=t?e._vod:"none"}const Xm=hi({patchProp:Cm},pm);let L0;function Ym(){return L0||(L0=Pd(Xm))}const F0=(...e)=>{Ym().render(...e)};var xt=(e,t)=>{const n=e.__vccOpts||e;for(const[r,a]of t)n[r]=a;return n};const Km={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},Gm=he("div",{id:"vac-circle"},null,-1),Wm=he("div",{id:"vac-circle"},null,-1),Zm=he("div",{id:"vac-circle"},null,-1),Qm=he("div",{id:"vac-circle"},null,-1),Jm=he("div",{id:"vac-circle"},null,-1),$m=he("div",{id:"vac-circle"},null,-1);function ef(e,t,n,r,a,i){return Q(),ht(Ct,{name:"vac-fade-spinner",appear:""},{default:Ge(()=>[n.show?(Q(),se("div",{key:0,class:$e(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},[n.type==="rooms"?Be(e.$slots,"spinner-icon-rooms",{key:0},()=>[Gm]):Te("",!0),n.type==="infinite-rooms"?Be(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[Wm]):Te("",!0),n.type==="message-file"?Be(e.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},()=>[Zm]):Te("",!0),n.type==="room-file"?Be(e.$slots,"spinner-icon-room-file",{key:3},()=>[Qm]):Te("",!0),n.type==="messages"?Be(e.$slots,"spinner-icon-messages",{key:4},()=>[Jm]):Te("",!0),n.type==="infinite-messages"?Be(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[$m]):Te("",!0)],2)):Te("",!0)]),_:3})}var pa=xt(Km,[["render",ef]]);const tf={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return e.size==="large"?512:e.size==="medium"?48:24}}},nf=["viewBox"],rf=["id","d"],af=["id","d"];function sf(e,t,n,r,a,i){return Q(),se("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${i.size} ${i.size}`},[he("path",{id:i.svgId,d:a.svgItem[n.name].path},null,8,rf),a.svgItem[n.name].path2?(Q(),se("path",{key:0,id:i.svgId,d:a.svgItem[n.name].path2},null,8,af)):Te("",!0)],8,nf)}var Ht=xt(tf,[["render",sf]]);const of={name:"RoomsSearch",components:{SvgIcon:Ht},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},lf={key:0,class:"vac-icon-search"},cf=["placeholder"];function uf(e,t,n,r,a,i){const s=Ye("svg-icon");return Q(),se("div",{class:$e({"vac-box-search":i.showSearchBar,"vac-box-empty":!i.showSearchBar})},[n.showSearch?(Q(),se(st,{key:0},[!n.loadingRooms&&n.rooms.length?(Q(),se("div",lf,[Be(e.$slots,"search-icon",{},()=>[Oe(s,{name:"search"})])])):Te("",!0),!n.loadingRooms&&n.rooms.length?(Q(),se("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=l=>e.$emit("search-room",l))},null,40,cf)):Te("",!0)],64)):Te("",!0),n.showAddRoom?(Q(),se("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=l=>e.$emit("add-room"))},[Be(e.$slots,"add-icon",{},()=>[Oe(s,{name:"add"})])])):Te("",!0)],2)}var df=xt(of,[["render",uf]]);const j0=document.createElement("i");function N0(e){const t="&"+e+";";j0.innerHTML=t;const n=j0.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function an(e,t,n,r){const a=e.length;let i=0,s;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,n=n>0?n:0,r.length<1e4)s=Array.from(r),s.unshift(t,n),e.splice(...s);else for(n&&e.splice(t,n);i<r.length;)s=r.slice(i,i+1e4),s.unshift(t,0),e.splice(...s),i+=1e4,t+=1e4}function Pt(e,t){return e.length>0?(an(e,e.length,0,t),e):t}const Ys={}.hasOwnProperty;function H0(e){const t={};let n=-1;for(;++n<e.length;)mf(t,e[n]);return t}function mf(e,t){let n;for(n in t){const a=(Ys.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let s;if(i)for(s in i){Ys.call(a,s)||(a[s]=[]);const l=i[s];ff(a[s],Array.isArray(l)?l:l?[l]:[])}}}function ff(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);an(e,0,0,r)}function D0(e){const t={};let n=-1;for(;++n<e.length;)hf(t,e[n]);return t}function hf(e,t){let n;for(n in t){const a=(Ys.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let s;if(i)for(s in i)a[s]=i[s]}}function pf(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"\uFFFD":String.fromCharCode(n)}const vf={'"':"quot","&":"amp","<":"lt",">":"gt"};function P0(e){return e.replace(/["&<>]/g,t);function t(n){return"&"+vf[n]+";"}}function In(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const _f=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,Gt=rr(/[A-Za-z]/),zt=rr(/[\dA-Za-z]/),gf=rr(/[#-'*+\--9=?A-Z^-~]/);function va(e){return e!==null&&(e<32||e===127)}const Ks=rr(/\d/),bf=rr(/[\dA-Fa-f]/),xf=rr(/[!-/:-@[-`{-~]/);function We(e){return e!==null&&e<-2}function yt(e){return e!==null&&(e<0||e===32)}function at(e){return e===-2||e===-1||e===32}const Gs=rr(_f),Vr=rr(/\s/);function rr(e){return t;function t(n){return n!==null&&e.test(String.fromCharCode(n))}}function yr(e,t){const n=P0(yf(e||""));if(!t)return n;const r=n.indexOf(":"),a=n.indexOf("?"),i=n.indexOf("#"),s=n.indexOf("/");return r<0||s>-1&&r>s||a>-1&&r>a||i>-1&&r>i||t.test(n.slice(0,r))?n:""}function yf(e){const t=[];let n=-1,r=0,a=0;for(;++n<e.length;){const i=e.charCodeAt(n);let s="";if(i===37&&zt(e.charCodeAt(n+1))&&zt(e.charCodeAt(n+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(s=String.fromCharCode(i));else if(i>55295&&i<57344){const l=e.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(s=String.fromCharCode(i,l),a=1):s="\uFFFD"}else s=String.fromCharCode(i);s&&(t.push(e.slice(r,n),encodeURIComponent(s)),r=n+a+1,s=""),a&&(n+=a,a=0)}return t.join("")+e.slice(r)}const z0={}.hasOwnProperty,U0=/^(https?|ircs?|mailto|xmpp)$/i,wf=/^https?$/i;function kf(e){const t=e||{};let n=!0;const r={},a=[[]],i=[],s=[],m=D0([{enter:{blockQuote:k,codeFenced:P,codeFencedFenceInfo:O,codeFencedFenceMeta:O,codeIndented:M,codeText:q,content:Ee,definition:z,definitionDestinationString:ne,definitionLabelString:O,definitionTitleString:O,emphasis:N,htmlFlow:ee,htmlText:B,image:C,label:O,link:fe,listItemMarker:f,listItemValue:S,listOrdered:g,listUnordered:A,paragraph:H,reference:O,resource:He,resourceDestinationString:Re,resourceTitleString:O,setextHeading:Ae,strong:U},exit:{atxHeading:Pe,atxHeadingSequence:we,autolinkEmail:le,autolinkProtocol:te,blockQuote:w,characterEscapeValue:Ue,characterReferenceMarkerHexadecimal:G,characterReferenceMarkerNumeric:G,characterReferenceValue:oe,codeFenced:W,codeFencedFence:d,codeFencedFenceInfo:V,codeFencedFenceMeta:I,codeFlowValue:ue,codeIndented:W,codeText:K,codeTextData:Ue,data:Ue,definition:Me,definitionDestinationString:ce,definitionLabelString:X,definitionTitleString:de,emphasis:D,hardBreakEscape:ke,hardBreakTrailing:ke,htmlFlow:Ce,htmlFlowData:Ue,htmlText:Ce,htmlTextData:Ue,image:rt,label:ge,labelText:Se,lineEnding:Ke,link:rt,listOrdered:x,listUnordered:b,paragraph:Y,reference:I,referenceString:_e,resource:I,resourceDestinationString:pe,resourceTitleString:Ve,setextHeading:ze,setextHeadingLineSequence:je,setextHeadingText:be,strong:Z,thematicBreak:$}}].concat(t.htmlExtensions||[])),u={tightStack:s,definitions:r},h={lineEndingIfNeeded:T,options:t,encode:R,raw:E,tag:v,buffer:O,resume:I,setData:o,getData:j};let c=t.defaultLineEnding;return _;function _(J){let ve=-1,me=0;const De=[];let re=[],Le=[];for(;++ve<J.length;)!c&&(J[ve][1].type==="lineEnding"||J[ve][1].type==="lineEndingBlank")&&(c=J[ve][2].sliceSerialize(J[ve][1])),(J[ve][1].type==="listOrdered"||J[ve][1].type==="listUnordered")&&(J[ve][0]==="enter"?De.push(ve):p(J.slice(De.pop(),ve))),J[ve][1].type==="definition"&&(J[ve][0]==="enter"?(Le=Pt(Le,J.slice(me,ve)),me=ve):(re=Pt(re,J.slice(me,ve+1)),me=ve+1));re=Pt(re,Le),re=Pt(re,J.slice(me)),ve=-1;const Xe=re;for(m.enter.null&&m.enter.null.call(h);++ve<J.length;){const xe=m[Xe[ve][0]],Ne=Xe[ve][1].type,ye=xe[Ne];z0.call(xe,Ne)&&ye&&ye.call(Object.assign({sliceSerialize:Xe[ve][2].sliceSerialize},h),Xe[ve][1])}return m.exit.null&&m.exit.null.call(h),a[0].join("")}function p(J){const ve=J.length;let me=0,De=0,re=!1,Le;for(;++me<ve;){const Xe=J[me];if(Xe[1]._container)Le=void 0,Xe[0]==="enter"?De++:De--;else switch(Xe[1].type){case"listItemPrefix":{Xe[0]==="exit"&&(Le=!0);break}case"linePrefix":break;case"lineEndingBlank":{Xe[0]==="enter"&&!De&&(Le?Le=void 0:re=!0);break}default:Le=void 0}}J[0][1]._loose=re}function o(J,ve){u[J]=ve}function j(J){return u[J]}function O(){a.push([])}function I(){return a.pop().join("")}function v(J){!n||(o("lastWasTag",!0),a[a.length-1].push(J))}function E(J){o("lastWasTag"),a[a.length-1].push(J)}function L(){E(c||`
`)}function T(){const J=a[a.length-1],ve=J[J.length-1],me=ve?ve.charCodeAt(ve.length-1):null;me===10||me===13||me===null||L()}function R(J){return j("ignoreEncode")?J:P0(J)}function g(J){s.push(!J._loose),T(),v("<ol"),o("expectFirstItem",!0)}function A(J){s.push(!J._loose),T(),v("<ul"),o("expectFirstItem",!0)}function S(J){if(j("expectFirstItem")){const ve=Number.parseInt(this.sliceSerialize(J),10);ve!==1&&v(' start="'+R(String(ve))+'"')}}function f(){j("expectFirstItem")?v(">"):y(),T(),v("<li>"),o("expectFirstItem"),o("lastWasTag")}function x(){y(),s.pop(),L(),v("</ol>")}function b(){y(),s.pop(),L(),v("</ul>")}function y(){j("lastWasTag")&&!j("slurpAllLineEndings")&&T(),v("</li>"),o("slurpAllLineEndings")}function k(){s.push(!1),T(),v("<blockquote>")}function w(){s.pop(),T(),v("</blockquote>"),o("slurpAllLineEndings")}function H(){s[s.length-1]||(T(),v("<p>")),o("slurpAllLineEndings")}function Y(){s[s.length-1]?o("slurpAllLineEndings",!0):v("</p>")}function P(){T(),v("<pre><code"),o("fencesCount",0)}function V(){const J=I();v(' class="language-'+J+'"')}function d(){const J=j("fencesCount")||0;J||(v(">"),o("slurpOneLineEnding",!0)),o("fencesCount",J+1)}function M(){T(),v("<pre><code>")}function W(){const J=j("fencesCount");J!==void 0&&J<2&&u.tightStack.length>0&&!j("lastWasTag")&&L(),j("flowCodeSeenData")&&T(),v("</code></pre>"),J!==void 0&&J<2&&T(),o("flowCodeSeenData"),o("fencesCount"),o("slurpOneLineEnding")}function C(){i.push({image:!0}),n=void 0}function fe(){i.push({})}function Se(J){i[i.length-1].labelId=this.sliceSerialize(J)}function ge(){i[i.length-1].label=I()}function _e(J){i[i.length-1].referenceId=this.sliceSerialize(J)}function He(){O(),i[i.length-1].destination=""}function Re(){O(),o("ignoreEncode",!0)}function pe(){i[i.length-1].destination=I(),o("ignoreEncode")}function Ve(){i[i.length-1].title=I()}function rt(){let J=i.length-1;const ve=i[J],me=ve.referenceId||ve.labelId,De=ve.destination===void 0?r[In(me)]:ve;for(n=!0;J--;)if(i[J].image){n=void 0;break}ve.image?(v('<img src="'+yr(De.destination,t.allowDangerousProtocol?void 0:wf)+'" alt="'),E(ve.label),v('"')):v('<a href="'+yr(De.destination,t.allowDangerousProtocol?void 0:U0)+'"'),v(De.title?' title="'+De.title+'"':""),ve.image?v(" />"):(v(">"),E(ve.label),v("</a>")),i.pop()}function z(){O(),i.push({})}function X(J){I(),i[i.length-1].labelId=this.sliceSerialize(J)}function ne(){O(),o("ignoreEncode",!0)}function ce(){i[i.length-1].destination=I(),o("ignoreEncode")}function de(){i[i.length-1].title=I()}function Me(){const J=i[i.length-1],ve=In(J.labelId);I(),z0.call(r,ve)||(r[ve]=i[i.length-1]),i.pop()}function Ee(){o("slurpAllLineEndings",!0)}function we(J){j("headingRank")||(o("headingRank",this.sliceSerialize(J).length),T(),v("<h"+j("headingRank")+">"))}function Ae(){O(),o("slurpAllLineEndings")}function be(){o("slurpAllLineEndings",!0)}function Pe(){v("</h"+j("headingRank")+">"),o("headingRank")}function je(J){o("headingRank",this.sliceSerialize(J).charCodeAt(0)===61?1:2)}function ze(){const J=I();T(),v("<h"+j("headingRank")+">"),E(J),v("</h"+j("headingRank")+">"),o("slurpAllLineEndings"),o("headingRank")}function Ue(J){E(R(this.sliceSerialize(J)))}function Ke(J){if(!j("slurpAllLineEndings")){if(j("slurpOneLineEnding")){o("slurpOneLineEnding");return}if(j("inCodeText")){E(" ");return}E(R(this.sliceSerialize(J)))}}function ue(J){E(R(this.sliceSerialize(J))),o("flowCodeSeenData",!0)}function ke(){v("<br />")}function ee(){T(),B()}function Ce(){o("ignoreEncode")}function B(){t.allowDangerousHtml&&o("ignoreEncode",!0)}function N(){v("<em>")}function U(){v("<strong>")}function q(){o("inCodeText",!0),v("<code>")}function K(){o("inCodeText"),v("</code>")}function D(){v("</em>")}function Z(){v("</strong>")}function $(){T(),v("<hr />")}function G(J){o("characterReferenceType",J.type)}function oe(J){let ve=this.sliceSerialize(J);ve=j("characterReferenceType")?pf(ve,j("characterReferenceType")==="characterReferenceMarkerNumeric"?10:16):N0(ve),E(R(ve)),o("characterReferenceType")}function te(J){const ve=this.sliceSerialize(J);v('<a href="'+yr(ve,t.allowDangerousProtocol?void 0:U0)+'">'),E(R(ve)),v("</a>")}function le(J){const ve=this.sliceSerialize(J);v('<a href="'+yr("mailto:"+ve)+'">'),E(R(ve)),v("</a>")}}function lt(e,t,n,r){const a=r?r-1:Number.POSITIVE_INFINITY;let i=0;return s;function s(m){return at(m)?(e.enter(n),l(m)):t(m)}function l(m){return at(m)&&i++<a?(e.consume(m),l):(e.exit(n),t(m))}}const Sf={tokenize:Mf};function Mf(e){const t=e.attempt(this.parser.constructs.contentInitial,r,a);let n;return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),lt(e,t,"linePrefix")}function a(l){return e.enter("paragraph"),i(l)}function i(l){const m=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=m),n=m,s(l)}function s(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return We(l)?(e.consume(l),e.exit("chunkText"),i):(e.consume(l),s)}}const Af={tokenize:Ef},V0={tokenize:Tf};function Ef(e){const t=this,n=[];let r=0,a,i,s;return l;function l(E){if(r<n.length){const L=n[r];return t.containerState=L[1],e.attempt(L[0].continuation,m,u)(E)}return u(E)}function m(E){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&v();const L=t.events.length;let T=L,R;for(;T--;)if(t.events[T][0]==="exit"&&t.events[T][1].type==="chunkFlow"){R=t.events[T][1].end;break}I(r);let g=L;for(;g<t.events.length;)t.events[g][1].end=Object.assign({},R),g++;return an(t.events,T+1,0,t.events.slice(L)),t.events.length=g,u(E)}return l(E)}function u(E){if(r===n.length){if(!a)return _(E);if(a.currentConstruct&&a.currentConstruct.concrete)return o(E);t.interrupt=Boolean(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(V0,h,c)(E)}function h(E){return a&&v(),I(r),_(E)}function c(E){return t.parser.lazy[t.now().line]=r!==n.length,s=t.now().offset,o(E)}function _(E){return t.containerState={},e.attempt(V0,p,o)(E)}function p(E){return r++,n.push([t.currentConstruct,t.containerState]),_(E)}function o(E){if(E===null){a&&v(),I(0),e.consume(E);return}return a=a||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:a}),j(E)}function j(E){if(E===null){O(e.exit("chunkFlow"),!0),I(0),e.consume(E);return}return We(E)?(e.consume(E),O(e.exit("chunkFlow")),r=0,t.interrupt=void 0,l):(e.consume(E),j)}function O(E,L){const T=t.sliceStream(E);if(L&&T.push(null),E.previous=i,i&&(i.next=E),i=E,a.defineSkip(E.start),a.write(T),t.parser.lazy[E.start.line]){let R=a.events.length;for(;R--;)if(a.events[R][1].start.offset<s&&(!a.events[R][1].end||a.events[R][1].end.offset>s))return;const g=t.events.length;let A=g,S,f;for(;A--;)if(t.events[A][0]==="exit"&&t.events[A][1].type==="chunkFlow"){if(S){f=t.events[A][1].end;break}S=!0}for(I(r),R=g;R<t.events.length;)t.events[R][1].end=Object.assign({},f),R++;an(t.events,A+1,0,t.events.slice(g)),t.events.length=R}}function I(E){let L=n.length;for(;L-- >E;){const T=n[L];t.containerState=T[1],T[0].exit.call(t,e)}n.length=E}function v(){a.write([null]),i=void 0,a=void 0,t.containerState._closeFlow=void 0}}function Tf(e,t,n){return lt(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function _a(e){if(e===null||yt(e)||Vr(e))return 1;if(Gs(e))return 2}function ga(e,t,n){const r=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const Ws={name:"attention",tokenize:If,resolveAll:Rf};function Rf(e,t){let n=-1,r,a,i,s,l,m,u,h;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;m=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const c=Object.assign({},e[r][1].end),_=Object.assign({},e[n][1].start);q0(c,-m),q0(_,m),s={type:m>1?"strongSequence":"emphasisSequence",start:c,end:Object.assign({},e[r][1].end)},l={type:m>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[n][1].start),end:_},i={type:m>1?"strongText":"emphasisText",start:Object.assign({},e[r][1].end),end:Object.assign({},e[n][1].start)},a={type:m>1?"strong":"emphasis",start:Object.assign({},s.start),end:Object.assign({},l.end)},e[r][1].end=Object.assign({},s.start),e[n][1].start=Object.assign({},l.end),u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=Pt(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=Pt(u,[["enter",a,t],["enter",s,t],["exit",s,t],["enter",i,t]]),u=Pt(u,ga(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=Pt(u,[["exit",i,t],["enter",l,t],["exit",l,t],["exit",a,t]]),e[n][1].end.offset-e[n][1].start.offset?(h=2,u=Pt(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):h=0,an(e,r-1,n-r+3,u),n=r+u.length-h-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function If(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,a=_a(r);let i;return s;function s(m){return i=m,e.enter("attentionSequence"),l(m)}function l(m){if(m===i)return e.consume(m),l;const u=e.exit("attentionSequence"),h=_a(m),c=!h||h===2&&a||n.includes(m),_=!a||a===2&&h||n.includes(r);return u._open=Boolean(i===42?c:c&&(a||!_)),u._close=Boolean(i===42?_:_&&(h||!c)),t(m)}}function q0(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Cf={name:"autolink",tokenize:Bf};function Bf(e,t,n){let r=0;return a;function a(p){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(p){return Gt(p)?(e.consume(p),s):u(p)}function s(p){return p===43||p===45||p===46||zt(p)?(r=1,l(p)):u(p)}function l(p){return p===58?(e.consume(p),r=0,m):(p===43||p===45||p===46||zt(p))&&r++<32?(e.consume(p),l):(r=0,u(p))}function m(p){return p===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):p===null||p===32||p===60||va(p)?n(p):(e.consume(p),m)}function u(p){return p===64?(e.consume(p),h):gf(p)?(e.consume(p),u):n(p)}function h(p){return zt(p)?c(p):n(p)}function c(p){return p===46?(e.consume(p),r=0,h):p===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):_(p)}function _(p){if((p===45||zt(p))&&r++<63){const o=p===45?_:c;return e.consume(p),o}return n(p)}}const gi={tokenize:Of,partial:!0};function Of(e,t,n){return r;function r(i){return at(i)?lt(e,a,"linePrefix")(i):a(i)}function a(i){return i===null||We(i)?t(i):n(i)}}const X0={name:"blockQuote",tokenize:Lf,continuation:{tokenize:Ff},exit:jf};function Lf(e,t,n){const r=this;return a;function a(s){if(s===62){const l=r.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(s),e.exit("blockQuoteMarker"),i}return n(s)}function i(s){return at(s)?(e.enter("blockQuotePrefixWhitespace"),e.consume(s),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(s))}}function Ff(e,t,n){const r=this;return a;function a(s){return at(s)?lt(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):i(s)}function i(s){return e.attempt(X0,t,n)(s)}}function jf(e){e.exit("blockQuote")}const Y0={name:"characterEscape",tokenize:Nf};function Nf(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),a}function a(i){return xf(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const K0={name:"characterReference",tokenize:Hf};function Hf(e,t,n){const r=this;let a=0,i,s;return l;function l(c){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),m}function m(c){return c===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(c),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),i=31,s=zt,h(c))}function u(c){return c===88||c===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(c),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,s=bf,h):(e.enter("characterReferenceValue"),i=7,s=Ks,h(c))}function h(c){if(c===59&&a){const _=e.exit("characterReferenceValue");return s===zt&&!N0(r.sliceSerialize(_))?n(c):(e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return s(c)&&a++<i?(e.consume(c),h):n(c)}}const G0={tokenize:Pf,partial:!0},W0={name:"codeFenced",tokenize:Df,concrete:!0};function Df(e,t,n){const r=this,a={tokenize:T,partial:!0};let i=0,s=0,l;return m;function m(R){return u(R)}function u(R){const g=r.events[r.events.length-1];return i=g&&g[1].type==="linePrefix"?g[2].sliceSerialize(g[1],!0).length:0,l=R,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(R)}function h(R){return R===l?(s++,e.consume(R),h):s<3?n(R):(e.exit("codeFencedFenceSequence"),at(R)?lt(e,c,"whitespace")(R):c(R))}function c(R){return R===null||We(R)?(e.exit("codeFencedFence"),r.interrupt?t(R):e.check(G0,j,L)(R)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),_(R))}function _(R){return R===null||We(R)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(R)):at(R)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),lt(e,p,"whitespace")(R)):R===96&&R===l?n(R):(e.consume(R),_)}function p(R){return R===null||We(R)?c(R):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),o(R))}function o(R){return R===null||We(R)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(R)):R===96&&R===l?n(R):(e.consume(R),o)}function j(R){return e.attempt(a,L,O)(R)}function O(R){return e.enter("lineEnding"),e.consume(R),e.exit("lineEnding"),I}function I(R){return i>0&&at(R)?lt(e,v,"linePrefix",i+1)(R):v(R)}function v(R){return R===null||We(R)?e.check(G0,j,L)(R):(e.enter("codeFlowValue"),E(R))}function E(R){return R===null||We(R)?(e.exit("codeFlowValue"),v(R)):(e.consume(R),E)}function L(R){return e.exit("codeFenced"),t(R)}function T(R,g,A){let S=0;return f;function f(w){return R.enter("lineEnding"),R.consume(w),R.exit("lineEnding"),x}function x(w){return R.enter("codeFencedFence"),at(w)?lt(R,b,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(w):b(w)}function b(w){return w===l?(R.enter("codeFencedFenceSequence"),y(w)):A(w)}function y(w){return w===l?(S++,R.consume(w),y):S>=s?(R.exit("codeFencedFenceSequence"),at(w)?lt(R,k,"whitespace")(w):k(w)):A(w)}function k(w){return w===null||We(w)?(R.exit("codeFencedFence"),g(w)):A(w)}}}function Pf(e,t,n){const r=this;return a;function a(s){return s===null?n(s):(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i)}function i(s){return r.parser.lazy[r.now().line]?n(s):t(s)}}const Zs={name:"codeIndented",tokenize:Uf},zf={tokenize:Vf,partial:!0};function Uf(e,t,n){const r=this;return a;function a(u){return e.enter("codeIndented"),lt(e,i,"linePrefix",4+1)(u)}function i(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?s(u):n(u)}function s(u){return u===null?m(u):We(u)?e.attempt(zf,s,m)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||We(u)?(e.exit("codeFlowValue"),s(u)):(e.consume(u),l)}function m(u){return e.exit("codeIndented"),t(u)}}function Vf(e,t,n){const r=this;return a;function a(s){return r.parser.lazy[r.now().line]?n(s):We(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),a):lt(e,i,"linePrefix",4+1)(s)}function i(s){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(s):We(s)?a(s):n(s)}}const qf={name:"codeText",tokenize:Kf,resolve:Xf,previous:Yf};function Xf(e){let t=e.length-4,n=3,r,a;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)a===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(a=r):(r===t||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),t-=r-a-2,r=a+2),a=void 0);return e}function Yf(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Kf(e,t,n){let r=0,a,i;return s;function s(c){return e.enter("codeText"),e.enter("codeTextSequence"),l(c)}function l(c){return c===96?(e.consume(c),r++,l):(e.exit("codeTextSequence"),m(c))}function m(c){return c===null?n(c):c===32?(e.enter("space"),e.consume(c),e.exit("space"),m):c===96?(i=e.enter("codeTextSequence"),a=0,h(c)):We(c)?(e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),m):(e.enter("codeTextData"),u(c))}function u(c){return c===null||c===32||c===96||We(c)?(e.exit("codeTextData"),m(c)):(e.consume(c),u)}function h(c){return c===96?(e.consume(c),a++,h):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(c)):(i.type="codeTextData",u(c))}}function Z0(e){const t={};let n=-1,r,a,i,s,l,m,u;for(;++n<e.length;){for(;n in t;)n=t[n];if(r=e[n],n&&r[1].type==="chunkFlow"&&e[n-1][1].type==="listItemPrefix"&&(m=r[1]._tokenizer.events,i=0,i<m.length&&m[i][1].type==="lineEndingBlank"&&(i+=2),i<m.length&&m[i][1].type==="content"))for(;++i<m.length&&m[i][1].type!=="content";)m[i][1].type==="chunkText"&&(m[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,Gf(e,n)),n=t[n],u=!0);else if(r[1]._container){for(i=n,a=void 0;i--&&(s=e[i],s[1].type==="lineEnding"||s[1].type==="lineEndingBlank");)s[0]==="enter"&&(a&&(e[a][1].type="lineEndingBlank"),s[1].type="lineEnding",a=i);a&&(r[1].end=Object.assign({},e[a][1].start),l=e.slice(a,n),l.unshift(r),an(e,a,n-a+1,l))}}return!u}function Gf(e,t){const n=e[t][1],r=e[t][2];let a=t-1;const i=[],s=n._tokenizer||r.parser[n.contentType](n.start),l=s.events,m=[],u={};let h,c,_=-1,p=n,o=0,j=0;const O=[j];for(;p;){for(;e[++a][1]!==p;);i.push(a),p._tokenizer||(h=r.sliceStream(p),p.next||h.push(null),c&&s.defineSkip(p.start),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(h),p._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),c=p,p=p.next}for(p=n;++_<l.length;)l[_][0]==="exit"&&l[_-1][0]==="enter"&&l[_][1].type===l[_-1][1].type&&l[_][1].start.line!==l[_][1].end.line&&(j=_+1,O.push(j),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(s.events=[],p?(p._tokenizer=void 0,p.previous=void 0):O.pop(),_=O.length;_--;){const I=l.slice(O[_],O[_+1]),v=i.pop();m.unshift([v,v+I.length-1]),an(e,v,2,I)}for(_=-1;++_<m.length;)u[o+m[_][0]]=o+m[_][1],o+=m[_][1]-m[_][0]-1;return u}const Wf={tokenize:Jf,resolve:Qf},Zf={tokenize:$f,partial:!0};function Qf(e){return Z0(e),e}function Jf(e,t){let n;return r;function r(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(l)}function a(l){return l===null?i(l):We(l)?e.check(Zf,s,i)(l):(e.consume(l),a)}function i(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function s(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function $f(e,t,n){const r=this;return a;function a(s){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),lt(e,i,"linePrefix")}function i(s){if(s===null||We(s))return n(s);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(s):e.interrupt(r.parser.constructs.flow,n,t)(s)}}function Q0(e,t,n,r,a,i,s,l,m){const u=m||Number.POSITIVE_INFINITY;let h=0;return c;function c(I){return I===60?(e.enter(r),e.enter(a),e.enter(i),e.consume(I),e.exit(i),_):I===null||I===32||I===41||va(I)?n(I):(e.enter(r),e.enter(s),e.enter(l),e.enter("chunkString",{contentType:"string"}),j(I))}function _(I){return I===62?(e.enter(i),e.consume(I),e.exit(i),e.exit(a),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),p(I))}function p(I){return I===62?(e.exit("chunkString"),e.exit(l),_(I)):I===null||I===60||We(I)?n(I):(e.consume(I),I===92?o:p)}function o(I){return I===60||I===62||I===92?(e.consume(I),p):p(I)}function j(I){return!h&&(I===null||I===41||yt(I))?(e.exit("chunkString"),e.exit(l),e.exit(s),e.exit(r),t(I)):h<u&&I===40?(e.consume(I),h++,j):I===41?(e.consume(I),h--,j):I===null||I===32||I===40||va(I)?n(I):(e.consume(I),I===92?O:j)}function O(I){return I===40||I===41||I===92?(e.consume(I),j):j(I)}}function J0(e,t,n,r,a,i){const s=this;let l=0,m;return u;function u(p){return e.enter(r),e.enter(a),e.consume(p),e.exit(a),e.enter(i),h}function h(p){return l>999||p===null||p===91||p===93&&!m||p===94&&!l&&"_hiddenFootnoteSupport"in s.parser.constructs?n(p):p===93?(e.exit(i),e.enter(a),e.consume(p),e.exit(a),e.exit(r),t):We(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),c(p))}function c(p){return p===null||p===91||p===93||We(p)||l++>999?(e.exit("chunkString"),h(p)):(e.consume(p),m||(m=!at(p)),p===92?_:c)}function _(p){return p===91||p===92||p===93?(e.consume(p),l++,c):c(p)}}function $0(e,t,n,r,a,i){let s;return l;function l(_){return _===34||_===39||_===40?(e.enter(r),e.enter(a),e.consume(_),e.exit(a),s=_===40?41:_,m):n(_)}function m(_){return _===s?(e.enter(a),e.consume(_),e.exit(a),e.exit(r),t):(e.enter(i),u(_))}function u(_){return _===s?(e.exit(i),m(s)):_===null?n(_):We(_)?(e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),lt(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(_))}function h(_){return _===s||_===null||We(_)?(e.exit("chunkString"),u(_)):(e.consume(_),_===92?c:h)}function c(_){return _===s||_===92?(e.consume(_),h):h(_)}}function bi(e,t){let n;return r;function r(a){return We(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,r):at(a)?lt(e,r,n?"linePrefix":"lineSuffix")(a):t(a)}}const eh={name:"definition",tokenize:nh},th={tokenize:rh,partial:!0};function nh(e,t,n){const r=this;let a;return i;function i(p){return e.enter("definition"),s(p)}function s(p){return J0.call(r,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function l(p){return a=In(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),m):n(p)}function m(p){return yt(p)?bi(e,u)(p):u(p)}function u(p){return Q0(e,h,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function h(p){return e.attempt(th,c,c)(p)}function c(p){return at(p)?lt(e,_,"whitespace")(p):_(p)}function _(p){return p===null||We(p)?(e.exit("definition"),r.parser.defined.push(a),t(p)):n(p)}}function rh(e,t,n){return r;function r(l){return yt(l)?bi(e,a)(l):n(l)}function a(l){return $0(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return at(l)?lt(e,s,"whitespace")(l):s(l)}function s(l){return l===null||We(l)?t(l):n(l)}}const ih={name:"hardBreakEscape",tokenize:ah};function ah(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),a}function a(i){return We(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const sh={name:"headingAtx",tokenize:lh,resolve:oh};function oh(e,t){let n=e.length-2,r=3,a,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},an(e,r,n-r+1,[["enter",a,t],["enter",i,t],["exit",i,t],["exit",a,t]])),e}function lh(e,t,n){let r=0;return a;function a(h){return e.enter("atxHeading"),i(h)}function i(h){return e.enter("atxHeadingSequence"),s(h)}function s(h){return h===35&&r++<6?(e.consume(h),s):h===null||yt(h)?(e.exit("atxHeadingSequence"),l(h)):n(h)}function l(h){return h===35?(e.enter("atxHeadingSequence"),m(h)):h===null||We(h)?(e.exit("atxHeading"),t(h)):at(h)?lt(e,l,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function m(h){return h===35?(e.consume(h),m):(e.exit("atxHeadingSequence"),l(h))}function u(h){return h===null||h===35||yt(h)?(e.exit("atxHeadingText"),l(h)):(e.consume(h),u)}}const ch=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ec=["pre","script","style","textarea"],uh={name:"htmlFlow",tokenize:hh,resolveTo:fh,concrete:!0},dh={tokenize:vh,partial:!0},mh={tokenize:ph,partial:!0};function fh(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function hh(e,t,n){const r=this;let a,i,s,l,m;return u;function u(C){return h(C)}function h(C){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(C),c}function c(C){return C===33?(e.consume(C),_):C===47?(e.consume(C),i=!0,j):C===63?(e.consume(C),a=3,r.interrupt?t:d):Gt(C)?(e.consume(C),s=String.fromCharCode(C),O):n(C)}function _(C){return C===45?(e.consume(C),a=2,p):C===91?(e.consume(C),a=5,l=0,o):Gt(C)?(e.consume(C),a=4,r.interrupt?t:d):n(C)}function p(C){return C===45?(e.consume(C),r.interrupt?t:d):n(C)}function o(C){const fe="CDATA[";return C===fe.charCodeAt(l++)?(e.consume(C),l===fe.length?r.interrupt?t:b:o):n(C)}function j(C){return Gt(C)?(e.consume(C),s=String.fromCharCode(C),O):n(C)}function O(C){if(C===null||C===47||C===62||yt(C)){const fe=C===47,Se=s.toLowerCase();return!fe&&!i&&ec.includes(Se)?(a=1,r.interrupt?t(C):b(C)):ch.includes(s.toLowerCase())?(a=6,fe?(e.consume(C),I):r.interrupt?t(C):b(C)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(C):i?v(C):E(C))}return C===45||zt(C)?(e.consume(C),s+=String.fromCharCode(C),O):n(C)}function I(C){return C===62?(e.consume(C),r.interrupt?t:b):n(C)}function v(C){return at(C)?(e.consume(C),v):f(C)}function E(C){return C===47?(e.consume(C),f):C===58||C===95||Gt(C)?(e.consume(C),L):at(C)?(e.consume(C),E):f(C)}function L(C){return C===45||C===46||C===58||C===95||zt(C)?(e.consume(C),L):T(C)}function T(C){return C===61?(e.consume(C),R):at(C)?(e.consume(C),T):E(C)}function R(C){return C===null||C===60||C===61||C===62||C===96?n(C):C===34||C===39?(e.consume(C),m=C,g):at(C)?(e.consume(C),R):A(C)}function g(C){return C===m?(e.consume(C),m=null,S):C===null||We(C)?n(C):(e.consume(C),g)}function A(C){return C===null||C===34||C===39||C===47||C===60||C===61||C===62||C===96||yt(C)?T(C):(e.consume(C),A)}function S(C){return C===47||C===62||at(C)?E(C):n(C)}function f(C){return C===62?(e.consume(C),x):n(C)}function x(C){return C===null||We(C)?b(C):at(C)?(e.consume(C),x):n(C)}function b(C){return C===45&&a===2?(e.consume(C),H):C===60&&a===1?(e.consume(C),Y):C===62&&a===4?(e.consume(C),M):C===63&&a===3?(e.consume(C),d):C===93&&a===5?(e.consume(C),V):We(C)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(dh,W,y)(C)):C===null||We(C)?(e.exit("htmlFlowData"),y(C)):(e.consume(C),b)}function y(C){return e.check(mh,k,W)(C)}function k(C){return e.enter("lineEnding"),e.consume(C),e.exit("lineEnding"),w}function w(C){return C===null||We(C)?y(C):(e.enter("htmlFlowData"),b(C))}function H(C){return C===45?(e.consume(C),d):b(C)}function Y(C){return C===47?(e.consume(C),s="",P):b(C)}function P(C){if(C===62){const fe=s.toLowerCase();return ec.includes(fe)?(e.consume(C),M):b(C)}return Gt(C)&&s.length<8?(e.consume(C),s+=String.fromCharCode(C),P):b(C)}function V(C){return C===93?(e.consume(C),d):b(C)}function d(C){return C===62?(e.consume(C),M):C===45&&a===2?(e.consume(C),d):b(C)}function M(C){return C===null||We(C)?(e.exit("htmlFlowData"),W(C)):(e.consume(C),M)}function W(C){return e.exit("htmlFlow"),t(C)}}function ph(e,t,n){const r=this;return a;function a(s){return We(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i):n(s)}function i(s){return r.parser.lazy[r.now().line]?n(s):t(s)}}function vh(e,t,n){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(gi,t,n)}}const _h={name:"htmlText",tokenize:gh};function gh(e,t,n){const r=this;let a,i,s;return l;function l(d){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(d),m}function m(d){return d===33?(e.consume(d),u):d===47?(e.consume(d),T):d===63?(e.consume(d),E):Gt(d)?(e.consume(d),A):n(d)}function u(d){return d===45?(e.consume(d),h):d===91?(e.consume(d),i=0,o):Gt(d)?(e.consume(d),v):n(d)}function h(d){return d===45?(e.consume(d),p):n(d)}function c(d){return d===null?n(d):d===45?(e.consume(d),_):We(d)?(s=c,Y(d)):(e.consume(d),c)}function _(d){return d===45?(e.consume(d),p):c(d)}function p(d){return d===62?H(d):d===45?_(d):c(d)}function o(d){const M="CDATA[";return d===M.charCodeAt(i++)?(e.consume(d),i===M.length?j:o):n(d)}function j(d){return d===null?n(d):d===93?(e.consume(d),O):We(d)?(s=j,Y(d)):(e.consume(d),j)}function O(d){return d===93?(e.consume(d),I):j(d)}function I(d){return d===62?H(d):d===93?(e.consume(d),I):j(d)}function v(d){return d===null||d===62?H(d):We(d)?(s=v,Y(d)):(e.consume(d),v)}function E(d){return d===null?n(d):d===63?(e.consume(d),L):We(d)?(s=E,Y(d)):(e.consume(d),E)}function L(d){return d===62?H(d):E(d)}function T(d){return Gt(d)?(e.consume(d),R):n(d)}function R(d){return d===45||zt(d)?(e.consume(d),R):g(d)}function g(d){return We(d)?(s=g,Y(d)):at(d)?(e.consume(d),g):H(d)}function A(d){return d===45||zt(d)?(e.consume(d),A):d===47||d===62||yt(d)?S(d):n(d)}function S(d){return d===47?(e.consume(d),H):d===58||d===95||Gt(d)?(e.consume(d),f):We(d)?(s=S,Y(d)):at(d)?(e.consume(d),S):H(d)}function f(d){return d===45||d===46||d===58||d===95||zt(d)?(e.consume(d),f):x(d)}function x(d){return d===61?(e.consume(d),b):We(d)?(s=x,Y(d)):at(d)?(e.consume(d),x):S(d)}function b(d){return d===null||d===60||d===61||d===62||d===96?n(d):d===34||d===39?(e.consume(d),a=d,y):We(d)?(s=b,Y(d)):at(d)?(e.consume(d),b):(e.consume(d),k)}function y(d){return d===a?(e.consume(d),a=void 0,w):d===null?n(d):We(d)?(s=y,Y(d)):(e.consume(d),y)}function k(d){return d===null||d===34||d===39||d===60||d===61||d===96?n(d):d===47||d===62||yt(d)?S(d):(e.consume(d),k)}function w(d){return d===47||d===62||yt(d)?S(d):n(d)}function H(d){return d===62?(e.consume(d),e.exit("htmlTextData"),e.exit("htmlText"),t):n(d)}function Y(d){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),P}function P(d){return at(d)?lt(e,V,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d):V(d)}function V(d){return e.enter("htmlTextData"),s(d)}}const Qs={name:"labelEnd",tokenize:Sh,resolveTo:kh,resolveAll:wh},bh={tokenize:Mh},xh={tokenize:Ah},yh={tokenize:Eh};function wh(e){let t=-1;for(;++t<e.length;){const n=e[t][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(e.splice(t+1,n.type==="labelImage"?4:2),n.type="data",t++)}return e}function kh(e,t){let n=e.length,r=0,a,i,s,l;for(;n--;)if(a=e[n][1],i){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(s){if(e[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(i=n,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(s=n);const m={type:e[i][1].type==="labelLink"?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},u={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[s][1].end)},h={type:"labelText",start:Object.assign({},e[i+r+2][1].end),end:Object.assign({},e[s-2][1].start)};return l=[["enter",m,t],["enter",u,t]],l=Pt(l,e.slice(i+1,i+r+3)),l=Pt(l,[["enter",h,t]]),l=Pt(l,ga(t.parser.constructs.insideSpan.null,e.slice(i+r+4,s-3),t)),l=Pt(l,[["exit",h,t],e[s-2],e[s-1],["exit",u,t]]),l=Pt(l,e.slice(s+1)),l=Pt(l,[["exit",m,t]]),an(e,i,e.length,l),e}function Sh(e,t,n){const r=this;let a=r.events.length,i,s;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){i=r.events[a][1];break}return l;function l(_){return i?i._inactive?c(_):(s=r.parser.defined.includes(In(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(_),e.exit("labelMarker"),e.exit("labelEnd"),m):n(_)}function m(_){return _===40?e.attempt(bh,h,s?h:c)(_):_===91?e.attempt(xh,h,s?u:c)(_):s?h(_):c(_)}function u(_){return e.attempt(yh,h,c)(_)}function h(_){return t(_)}function c(_){return i._balanced=!0,n(_)}}function Mh(e,t,n){return r;function r(c){return e.enter("resource"),e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),a}function a(c){return yt(c)?bi(e,i)(c):i(c)}function i(c){return c===41?h(c):Q0(e,s,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(c)}function s(c){return yt(c)?bi(e,m)(c):h(c)}function l(c){return n(c)}function m(c){return c===34||c===39||c===40?$0(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(c):h(c)}function u(c){return yt(c)?bi(e,h)(c):h(c)}function h(c){return c===41?(e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),e.exit("resource"),t):n(c)}}function Ah(e,t,n){const r=this;return a;function a(l){return J0.call(r,e,i,s,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(In(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function s(l){return n(l)}}function Eh(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),a}function a(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const Th={name:"labelStartImage",tokenize:Rh,resolveAll:Qs.resolveAll};function Rh(e,t,n){const r=this;return a;function a(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),i}function i(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),s):n(l)}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const Ih={name:"labelStartLink",tokenize:Ch,resolveAll:Qs.resolveAll};function Ch(e,t,n){const r=this;return a;function a(s){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelLink"),i}function i(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(s):t(s)}}const Js={name:"lineEnding",tokenize:Bh};function Bh(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),lt(e,t,"linePrefix")}}const ba={name:"thematicBreak",tokenize:Oh};function Oh(e,t,n){let r=0,a;return i;function i(u){return e.enter("thematicBreak"),s(u)}function s(u){return a=u,l(u)}function l(u){return u===a?(e.enter("thematicBreakSequence"),m(u)):r>=3&&(u===null||We(u))?(e.exit("thematicBreak"),t(u)):n(u)}function m(u){return u===a?(e.consume(u),r++,m):(e.exit("thematicBreakSequence"),at(u)?lt(e,l,"whitespace")(u):l(u))}}const Zt={name:"list",tokenize:jh,continuation:{tokenize:Nh},exit:Dh},Lh={tokenize:Ph,partial:!0},Fh={tokenize:Hh,partial:!0};function jh(e,t,n){const r=this,a=r.events[r.events.length-1];let i=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,s=0;return l;function l(p){const o=r.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(o==="listUnordered"?!r.containerState.marker||p===r.containerState.marker:Ks(p)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),o==="listUnordered")return e.enter("listItemPrefix"),p===42||p===45?e.check(ba,n,u)(p):u(p);if(!r.interrupt||p===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(p)}return n(p)}function m(p){return Ks(p)&&++s<10?(e.consume(p),m):(!r.interrupt||s<2)&&(r.containerState.marker?p===r.containerState.marker:p===41||p===46)?(e.exit("listItemValue"),u(p)):n(p)}function u(p){return e.enter("listItemMarker"),e.consume(p),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||p,e.check(gi,r.interrupt?n:h,e.attempt(Lh,_,c))}function h(p){return r.containerState.initialBlankLine=!0,i++,_(p)}function c(p){return at(p)?(e.enter("listItemPrefixWhitespace"),e.consume(p),e.exit("listItemPrefixWhitespace"),_):n(p)}function _(p){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(p)}}function Nh(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(gi,a,i);function a(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,lt(e,t,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!at(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,s(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(Fh,t,s)(l))}function s(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,lt(e,e.attempt(Zt,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function Hh(e,t,n){const r=this;return lt(e,a,"listItemIndent",r.containerState.size+1);function a(i){const s=r.events[r.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?t(i):n(i)}}function Dh(e){e.exit(this.containerState.type)}function Ph(e,t,n){const r=this;return lt(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function a(i){const s=r.events[r.events.length-1];return!at(i)&&s&&s[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const tc={name:"setextUnderline",tokenize:Uh,resolveTo:zh};function zh(e,t){let n=e.length,r,a,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(a=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const s={type:"setextHeading",start:Object.assign({},e[a][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[a][1].type="setextHeadingText",i?(e.splice(a,0,["enter",s,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end=Object.assign({},e[i][1].end)):e[r][1]=s,e.push(["exit",s,t]),e}function Uh(e,t,n){const r=this;let a;return i;function i(u){let h=r.events.length,c;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){c=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||c)?(e.enter("setextHeadingLine"),a=u,s(u)):n(u)}function s(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===a?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),at(u)?lt(e,m,"lineSuffix")(u):m(u))}function m(u){return u===null||We(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const Vh={tokenize:qh};function qh(e){const t=this,n=e.attempt(gi,r,e.attempt(this.parser.constructs.flowInitial,a,lt(e,e.attempt(this.parser.constructs.flow,a,e.attempt(Wf,a)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function a(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const Xh={resolveAll:rc()},Yh=nc("string"),Kh=nc("text");function nc(e){return{tokenize:t,resolveAll:rc(e==="text"?Gh:void 0)};function t(n){const r=this,a=this.parser.constructs[e],i=n.attempt(a,s,l);return s;function s(h){return u(h)?i(h):l(h)}function l(h){if(h===null){n.consume(h);return}return n.enter("data"),n.consume(h),m}function m(h){return u(h)?(n.exit("data"),i(h)):(n.consume(h),m)}function u(h){if(h===null)return!0;const c=a[h];let _=-1;if(c)for(;++_<c.length;){const p=c[_];if(!p.previous||p.previous.call(r,r.previous))return!0}return!1}}}function rc(e){return t;function t(n,r){let a=-1,i;for(;++a<=n.length;)i===void 0?n[a]&&n[a][1].type==="data"&&(i=a,a++):(!n[a]||n[a][1].type!=="data")&&(a!==i+2&&(n[i][1].end=n[a-1][1].end,n.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(n,r):n}}function Gh(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],a=t.sliceStream(r);let i=a.length,s=-1,l=0,m;for(;i--;){const u=a[i];if(typeof u=="string"){for(s=u.length;u.charCodeAt(s-1)===32;)l++,s--;if(s)break;s=-1}else if(u===-2)m=!0,l++;else if(u!==-1){i++;break}}if(l){const u={type:n===e.length||m||l<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-l,offset:r.end.offset-l,_index:r.start._index+i,_bufferIndex:i?s:r.start._bufferIndex+s},end:Object.assign({},r.end)};r.end=Object.assign({},u.start),r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}function Wh(e,t,n){let r=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const a={},i=[];let s=[],l=[];const m={consume:v,enter:E,exit:L,attempt:g(T),check:g(R),interrupt:g(R,{interrupt:!0})},u={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:p,sliceSerialize:_,now:o,defineSkip:j,write:c};let h=t.tokenize.call(u,m);return t.resolveAll&&i.push(t),u;function c(x){return s=Pt(s,x),O(),s[s.length-1]!==null?[]:(A(t,0),u.events=ga(i,u.events,u),u.events)}function _(x,b){return Qh(p(x),b)}function p(x){return Zh(s,x)}function o(){const{line:x,column:b,offset:y,_index:k,_bufferIndex:w}=r;return{line:x,column:b,offset:y,_index:k,_bufferIndex:w}}function j(x){a[x.line]=x.column,f()}function O(){let x;for(;r._index<s.length;){const b=s[r._index];if(typeof b=="string")for(x=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===x&&r._bufferIndex<b.length;)I(b.charCodeAt(r._bufferIndex));else I(b)}}function I(x){h=h(x)}function v(x){We(x)?(r.line++,r.column=1,r.offset+=x===-3?2:1,f()):x!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=x}function E(x,b){const y=b||{};return y.type=x,y.start=o(),u.events.push(["enter",y,u]),l.push(y),y}function L(x){const b=l.pop();return b.end=o(),u.events.push(["exit",b,u]),b}function T(x,b){A(x,b.from)}function R(x,b){b.restore()}function g(x,b){return y;function y(k,w,H){let Y,P,V,d;return Array.isArray(k)?W(k):"tokenize"in k?W([k]):M(k);function M(ge){return _e;function _e(He){const Re=He!==null&&ge[He],pe=He!==null&&ge.null,Ve=[...Array.isArray(Re)?Re:Re?[Re]:[],...Array.isArray(pe)?pe:pe?[pe]:[]];return W(Ve)(He)}}function W(ge){return Y=ge,P=0,ge.length===0?H:C(ge[P])}function C(ge){return _e;function _e(He){return d=S(),V=ge,ge.partial||(u.currentConstruct=ge),ge.name&&u.parser.constructs.disable.null.includes(ge.name)?Se():ge.tokenize.call(b?Object.assign(Object.create(u),b):u,m,fe,Se)(He)}}function fe(ge){return x(V,d),w}function Se(ge){return d.restore(),++P<Y.length?C(Y[P]):H}}}function A(x,b){x.resolveAll&&!i.includes(x)&&i.push(x),x.resolve&&an(u.events,b,u.events.length-b,x.resolve(u.events.slice(b),u)),x.resolveTo&&(u.events=x.resolveTo(u.events,u))}function S(){const x=o(),b=u.previous,y=u.currentConstruct,k=u.events.length,w=Array.from(l);return{restore:H,from:k};function H(){r=x,u.previous=b,u.currentConstruct=y,u.events.length=k,l=w,f()}}function f(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function Zh(e,t){const n=t.start._index,r=t.start._bufferIndex,a=t.end._index,i=t.end._bufferIndex;let s;if(n===a)s=[e[n].slice(r,i)];else{if(s=e.slice(n,a),r>-1){const l=s[0];typeof l=="string"?s[0]=l.slice(r):s.shift()}i>0&&s.push(e[a].slice(0,i))}return s}function Qh(e,t){let n=-1;const r=[];let a;for(;++n<e.length;){const i=e[n];let s;if(typeof i=="string")s=i;else switch(i){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=t?" ":"	";break}case-1:{if(!t&&a)continue;s=" ";break}default:s=String.fromCharCode(i)}a=i===-2,r.push(s)}return r.join("")}var Jh=Object.freeze(Object.defineProperty({__proto__:null,document:{[42]:Zt,[43]:Zt,[45]:Zt,[48]:Zt,[49]:Zt,[50]:Zt,[51]:Zt,[52]:Zt,[53]:Zt,[54]:Zt,[55]:Zt,[56]:Zt,[57]:Zt,[62]:X0},contentInitial:{[91]:eh},flowInitial:{[-2]:Zs,[-1]:Zs,[32]:Zs},flow:{[35]:sh,[42]:ba,[45]:[tc,ba],[60]:uh,[61]:tc,[95]:ba,[96]:W0,[126]:W0},string:{[38]:K0,[92]:Y0},text:{[-5]:Js,[-4]:Js,[-3]:Js,[33]:Th,[38]:K0,[42]:Ws,[60]:[Cf,_h],[91]:Ih,[92]:[ih,Y0],[93]:Qs,[95]:Ws,[96]:qf},insideSpan:{null:[Ws,Xh]},attentionMarkers:{null:[42,95]},disable:{null:[]}},Symbol.toStringTag,{value:"Module"}));function $h(e){const n=H0([Jh,...(e||{}).extensions||[]]),r={defined:[],lazy:{},constructs:n,content:a(Sf),document:a(Af),flow:a(Vh),string:a(Yh),text:a(Kh)};return r;function a(i){return s;function s(l){return Wh(r,i,l)}}}function e2(e){for(;!Z0(e););return e}const ic=/[\0\t\n\r]/g;function t2(){let e=1,t="",n=!0,r;return a;function a(i,s,l){const m=[];let u,h,c,_,p;for(i=t+i.toString(s),c=0,t="",n&&(i.charCodeAt(0)===65279&&c++,n=void 0);c<i.length;){if(ic.lastIndex=c,u=ic.exec(i),_=u&&u.index!==void 0?u.index:i.length,p=i.charCodeAt(_),!u){t=i.slice(c);break}if(p===10&&c===_&&r)m.push(-3),r=void 0;else switch(r&&(m.push(-5),r=void 0),c<_&&(m.push(i.slice(c,_)),e+=_-c),p){case 0:{m.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,m.push(-2);e++<h;)m.push(-1);break}case 10:{m.push(-4),e=1;break}default:r=!0,e=1}c=_+1}return l&&(r&&m.push(-5),t&&m.push(t),m.push(null)),m}}function n2(e,t,n){return typeof t!="string"&&(n=t,t=void 0),kf(n)(e2($h(n).document().write(t2()(e,t,!0))))}const r2={tokenize:c2,partial:!0},ac={tokenize:u2,partial:!0},sc={tokenize:d2,partial:!0},oc={tokenize:m2,partial:!0},i2={tokenize:f2,partial:!0},lc={tokenize:o2,previous:uc},cc={tokenize:l2,previous:dc},qn={tokenize:s2,previous:mc},Cn={},a2={text:Cn};let wr=48;for(;wr<123;)Cn[wr]=qn,wr++,wr===58?wr=65:wr===91&&(wr=97);Cn[43]=qn,Cn[45]=qn,Cn[46]=qn,Cn[95]=qn,Cn[72]=[qn,cc],Cn[104]=[qn,cc],Cn[87]=[qn,lc],Cn[119]=[qn,lc];function s2(e,t,n){const r=this;let a,i;return s;function s(c){return!$s(c)||!mc.call(r,r.previous)||eo(r.events)?n(c):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(c))}function l(c){return $s(c)?(e.consume(c),l):c===64?(e.consume(c),m):n(c)}function m(c){return c===46?e.check(i2,h,u)(c):c===45||c===95||zt(c)?(i=!0,e.consume(c),m):h(c)}function u(c){return e.consume(c),a=!0,m}function h(c){return i&&a&&Gt(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(c)):n(c)}}function o2(e,t,n){const r=this;return a;function a(s){return s!==87&&s!==119||!uc.call(r,r.previous)||eo(r.events)?n(s):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(r2,e.attempt(ac,e.attempt(sc,i),n),n)(s))}function i(s){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(s)}}function l2(e,t,n){const r=this;let a="",i=!1;return s;function s(c){return(c===72||c===104)&&dc.call(r,r.previous)&&!eo(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(c),e.consume(c),l):n(c)}function l(c){if(Gt(c)&&a.length<5)return a+=String.fromCodePoint(c),e.consume(c),l;if(c===58){const _=a.toLowerCase();if(_==="http"||_==="https")return e.consume(c),m}return n(c)}function m(c){return c===47?(e.consume(c),i?u:(i=!0,m)):n(c)}function u(c){return c===null||va(c)||yt(c)||Vr(c)||Gs(c)?n(c):e.attempt(ac,e.attempt(sc,h),n)(c)}function h(c){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(c)}}function c2(e,t,n){let r=0;return a;function a(s){return(s===87||s===119)&&r<3?(r++,e.consume(s),a):s===46&&r===3?(e.consume(s),i):n(s)}function i(s){return s===null?n(s):t(s)}}function u2(e,t,n){let r,a,i;return s;function s(u){return u===46||u===95?e.check(oc,m,l)(u):u===null||yt(u)||Vr(u)||u!==45&&Gs(u)?m(u):(i=!0,e.consume(u),s)}function l(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),s}function m(u){return a||r||!i?n(u):t(u)}}function d2(e,t){let n=0,r=0;return a;function a(s){return s===40?(n++,e.consume(s),a):s===41&&r<n?i(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?e.check(oc,t,i)(s):s===null||yt(s)||Vr(s)?t(s):(e.consume(s),a)}function i(s){return s===41&&r++,e.consume(s),a}}function m2(e,t,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),r):l===38?(e.consume(l),i):l===93?(e.consume(l),a):l===60||l===null||yt(l)||Vr(l)?t(l):n(l)}function a(l){return l===null||l===40||l===91||yt(l)||Vr(l)?t(l):r(l)}function i(l){return Gt(l)?s(l):n(l)}function s(l){return l===59?(e.consume(l),r):Gt(l)?(e.consume(l),s):n(l)}}function f2(e,t,n){return r;function r(i){return e.consume(i),a}function a(i){return zt(i)?n(i):t(i)}}function uc(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||yt(e)}function dc(e){return!Gt(e)}function mc(e){return!(e===47||$s(e))}function $s(e){return e===43||e===45||e===46||e===95||zt(e)}function eo(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const h2={exit:{literalAutolinkEmail:v2,literalAutolinkHttp:_2,literalAutolinkWww:p2}};function p2(e){to.call(this,e,"http://")}function v2(e){to.call(this,e,"mailto:")}function _2(e){to.call(this,e)}function to(e,t){const n=this.sliceSerialize(e);this.tag('<a href="'+yr((t||"")+n)+'">'),this.raw(this.encode(n)),this.tag("</a>")}const g2={tokenize:A2,partial:!0};function b2(){return{document:{[91]:{tokenize:k2,continuation:{tokenize:S2},exit:M2}},text:{[91]:{tokenize:w2},[93]:{add:"after",tokenize:x2,resolveTo:y2}}}}function x2(e,t,n){const r=this;let a=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s;for(;a--;){const m=r.events[a][1];if(m.type==="labelImage"){s=m;break}if(m.type==="gfmFootnoteCall"||m.type==="labelLink"||m.type==="label"||m.type==="image"||m.type==="link")break}return l;function l(m){if(!s||!s._balanced)return n(m);const u=In(r.sliceSerialize({start:s.end,end:r.now()}));return u.codePointAt(0)!==94||!i.includes(u.slice(1))?n(m):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(m),e.exit("gfmFootnoteCallLabelMarker"),t(m))}}function y2(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",a,t],["exit",a,t],["enter",i,t],["enter",s,t],["exit",s,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function w2(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,s;return l;function l(c){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),m}function m(c){return c!==94?n(c):(e.enter("gfmFootnoteCallMarker"),e.consume(c),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(c){if(i>999||c===93&&!s||c===null||c===91||yt(c))return n(c);if(c===93){e.exit("chunkString");const _=e.exit("gfmFootnoteCallString");return a.includes(In(r.sliceSerialize(_)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(c)}return yt(c)||(s=!0),i++,e.consume(c),c===92?h:u}function h(c){return c===91||c===92||c===93?(e.consume(c),i++,u):u(c)}}function k2(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,s=0,l;return m;function m(o){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(o){return o===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",h):n(o)}function h(o){if(s>999||o===93&&!l||o===null||o===91||yt(o))return n(o);if(o===93){e.exit("chunkString");const j=e.exit("gfmFootnoteDefinitionLabelString");return i=In(r.sliceSerialize(j)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),_}return yt(o)||(l=!0),s++,e.consume(o),o===92?c:h}function c(o){return o===91||o===92||o===93?(e.consume(o),s++,h):h(o)}function _(o){return o===58?(e.enter("definitionMarker"),e.consume(o),e.exit("definitionMarker"),a.includes(i)||a.push(i),lt(e,p,"gfmFootnoteDefinitionWhitespace")):n(o)}function p(o){return t(o)}}function S2(e,t,n){return e.check(gi,t,e.attempt(g2,t,n))}function M2(e){e.exit("gfmFootnoteDefinition")}function A2(e,t,n){const r=this;return lt(e,a,"gfmFootnoteDefinitionIndent",4+1);function a(i){const s=r.events[r.events.length-1];return s&&s[1].type==="gfmFootnoteDefinitionIndent"&&s[2].sliceSerialize(s[1],!0).length===4?t(i):n(i)}}const E2={}.hasOwnProperty,T2={};function R2(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function I2(e){const t=e||T2,n=t.label||"Footnotes",r=t.labelTagName||"h2",a=t.labelAttributes===null||t.labelAttributes===void 0?'class="sr-only"':t.labelAttributes,i=t.backLabel||R2,s=t.clobberPrefix===null||t.clobberPrefix===void 0?"user-content-":t.clobberPrefix;return{enter:{gfmFootnoteDefinition(){this.getData("tightStack").push(!1)},gfmFootnoteDefinitionLabelString(){this.buffer()},gfmFootnoteCallString(){this.buffer()}},exit:{gfmFootnoteDefinition(){let l=this.getData("gfmFootnoteDefinitions");const m=this.getData("gfmFootnoteDefinitionStack"),u=this.getData("tightStack"),h=m.pop(),c=this.resume();l||this.setData("gfmFootnoteDefinitions",l={}),E2.call(l,h)||(l[h]=c),u.pop(),this.setData("slurpOneLineEnding",!0),this.setData("lastWasTag")},gfmFootnoteDefinitionLabelString(l){let m=this.getData("gfmFootnoteDefinitionStack");m||this.setData("gfmFootnoteDefinitionStack",m=[]),m.push(In(this.sliceSerialize(l))),this.resume(),this.buffer()},gfmFootnoteCallString(l){let m=this.getData("gfmFootnoteCallOrder"),u=this.getData("gfmFootnoteCallCounts");const h=In(this.sliceSerialize(l));let c;this.resume(),m||this.setData("gfmFootnoteCallOrder",m=[]),u||this.setData("gfmFootnoteCallCounts",u={});const _=m.indexOf(h),p=yr(h.toLowerCase());_===-1?(m.push(h),u[h]=1,c=m.length):(u[h]++,c=_+1);const o=u[h];this.tag('<sup><a href="#'+s+"fn-"+p+'" id="'+s+"fnref-"+p+(o>1?"-"+o:"")+'" data-footnote-ref="" aria-describedby="footnote-label">'+String(c)+"</a></sup>")},null(){const l=this.getData("gfmFootnoteCallOrder")||[],m=this.getData("gfmFootnoteCallCounts")||{},u=this.getData("gfmFootnoteDefinitions")||{};let h=-1;for(l.length>0&&(this.lineEndingIfNeeded(),this.tag('<section data-footnotes="" class="footnotes"><'+r+' id="footnote-label"'+(a?" "+a:"")+">"),this.raw(this.encode(n)),this.tag("</"+r+">"),this.lineEndingIfNeeded(),this.tag("<ol>"));++h<l.length;){const c=l[h],_=yr(c.toLowerCase());let p=0;const o=[];for(;++p<=m[c];)o.push('<a href="#'+s+"fnref-"+_+(p>1?"-"+p:"")+'" data-footnote-backref="" aria-label="'+this.encode(typeof i=="string"?i:i(h,p))+'" class="data-footnote-backref">\u21A9'+(p>1?"<sup>"+p+"</sup>":"")+"</a>");const j=o.join(" ");let O=!1;this.lineEndingIfNeeded(),this.tag('<li id="'+s+"fn-"+_+'">'),this.lineEndingIfNeeded(),this.tag(u[c].replace(/<\/p>(?:\r?\n|\r)?$/,I=>(O=!0," "+j+I))),O||(this.lineEndingIfNeeded(),this.tag(j)),this.lineEndingIfNeeded(),this.tag("</li>")}l.length>0&&(this.lineEndingIfNeeded(),this.tag("</ol>"),this.lineEndingIfNeeded(),this.tag("</section>"))}}}}const C2={enter:{strikethrough(){this.tag("<del>")}},exit:{strikethrough(){this.tag("</del>")}}};function B2(e){let n=(e||{}).singleTilde;const r={tokenize:i,resolveAll:a};return n==null&&(n=!0),{text:{[126]:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(s,l){let m=-1;for(;++m<s.length;)if(s[m][0]==="enter"&&s[m][1].type==="strikethroughSequenceTemporary"&&s[m][1]._close){let u=m;for(;u--;)if(s[u][0]==="exit"&&s[u][1].type==="strikethroughSequenceTemporary"&&s[u][1]._open&&s[m][1].end.offset-s[m][1].start.offset===s[u][1].end.offset-s[u][1].start.offset){s[m][1].type="strikethroughSequence",s[u][1].type="strikethroughSequence";const h={type:"strikethrough",start:Object.assign({},s[u][1].start),end:Object.assign({},s[m][1].end)},c={type:"strikethroughText",start:Object.assign({},s[u][1].end),end:Object.assign({},s[m][1].start)},_=[["enter",h,l],["enter",s[u][1],l],["exit",s[u][1],l],["enter",c,l]],p=l.parser.constructs.insideSpan.null;p&&an(_,_.length,0,ga(p,s.slice(u+1,m),l)),an(_,_.length,0,[["exit",c,l],["enter",s[m][1],l],["exit",s[m][1],l],["exit",h,l]]),an(s,u-1,m-u+3,_),m=u+_.length-2;break}}for(m=-1;++m<s.length;)s[m][1].type==="strikethroughSequenceTemporary"&&(s[m][1].type="data");return s}function i(s,l,m){const u=this.previous,h=this.events;let c=0;return _;function _(o){return u===126&&h[h.length-1][1].type!=="characterEscape"?m(o):(s.enter("strikethroughSequenceTemporary"),p(o))}function p(o){const j=_a(u);if(o===126)return c>1?m(o):(s.consume(o),c++,p);if(c<2&&!n)return m(o);const O=s.exit("strikethroughSequenceTemporary"),I=_a(o);return O._open=!I||I===2&&Boolean(j),O._close=!j||j===2&&Boolean(I),l(o)}}}const no={none:"",left:' align="left"',right:' align="right"',center:' align="center"'},O2={enter:{table(e){const t=e._align;this.lineEndingIfNeeded(),this.tag("<table>"),this.setData("tableAlign",t)},tableBody(){this.tag("<tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=no[e[t]];n===void 0?this.buffer():(this.lineEndingIfNeeded(),this.tag("<td"+n+">"))},tableHead(){this.lineEndingIfNeeded(),this.tag("<thead>")},tableHeader(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=no[e[t]];this.lineEndingIfNeeded(),this.tag("<th"+n+">")},tableRow(){this.setData("tableColumn",0),this.lineEndingIfNeeded(),this.tag("<tr>")}},exit:{codeTextData(e){let t=this.sliceSerialize(e);this.getData("tableAlign")&&(t=t.replace(/\\([\\|])/g,L2)),this.raw(this.encode(t))},table(){this.setData("tableAlign"),this.setData("slurpAllLineEndings"),this.lineEndingIfNeeded(),this.tag("</table>")},tableBody(){this.lineEndingIfNeeded(),this.tag("</tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn");t in e?(this.tag("</td>"),this.setData("tableColumn",t+1)):this.resume()},tableHead(){this.lineEndingIfNeeded(),this.tag("</thead>")},tableHeader(){const e=this.getData("tableColumn");this.tag("</th>"),this.setData("tableColumn",e+1)},tableRow(){const e=this.getData("tableAlign");let t=this.getData("tableColumn");for(;t<e.length;)this.lineEndingIfNeeded(),this.tag("<td"+no[e[t]]+"></td>"),t++;this.setData("tableColumn",t),this.lineEndingIfNeeded(),this.tag("</tr>")}}};function L2(e,t){return t==="|"?t:e}class F2{constructor(){this.map=[]}add(t,n,r){j2(this,t,n,r)}consume(t){if(this.map.sort((i,s)=>i[0]-s[0]),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1])),r.push(this.map[n][2]),t.length=this.map[n][0];r.push([...t]),t.length=0;let a=r.pop();for(;a;)t.push(...a),a=r.pop();this.map.length=0}}function j2(e,t,n,r){let a=0;if(!(n===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===t){e.map[a][1]+=n,e.map[a][2].push(...r);return}a+=1}e.map.push([t,n,r])}}function N2(e,t){let n=!1;const r=[];for(;t<e.length;){const a=e[t];if(n){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}const H2={flow:{null:{tokenize:D2,resolveAll:P2}}};function D2(e,t,n){const r=this;let a=0,i=0,s;return l;function l(f){let x=r.events.length-1;for(;x>-1;){const k=r.events[x][1].type;if(k==="lineEnding"||k==="linePrefix")x--;else break}const b=x>-1?r.events[x][1].type:null,y=b==="tableHead"||b==="tableRow"?R:m;return y===R&&r.parser.lazy[r.now().line]?n(f):y(f)}function m(f){return e.enter("tableHead"),e.enter("tableRow"),u(f)}function u(f){return f===124||(s=!0,i+=1),h(f)}function h(f){return f===null?n(f):We(f)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),p):n(f):at(f)?lt(e,h,"whitespace")(f):(i+=1,s&&(s=!1,a+=1),f===124?(e.enter("tableCellDivider"),e.consume(f),e.exit("tableCellDivider"),s=!0,h):(e.enter("data"),c(f)))}function c(f){return f===null||f===124||yt(f)?(e.exit("data"),h(f)):(e.consume(f),f===92?_:c)}function _(f){return f===92||f===124?(e.consume(f),c):c(f)}function p(f){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(f):(e.enter("tableDelimiterRow"),s=!1,at(f)?lt(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f):o(f))}function o(f){return f===45||f===58?O(f):f===124?(s=!0,e.enter("tableCellDivider"),e.consume(f),e.exit("tableCellDivider"),j):T(f)}function j(f){return at(f)?lt(e,O,"whitespace")(f):O(f)}function O(f){return f===58?(i+=1,s=!0,e.enter("tableDelimiterMarker"),e.consume(f),e.exit("tableDelimiterMarker"),I):f===45?(i+=1,I(f)):f===null||We(f)?L(f):T(f)}function I(f){return f===45?(e.enter("tableDelimiterFiller"),v(f)):T(f)}function v(f){return f===45?(e.consume(f),v):f===58?(s=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(f),e.exit("tableDelimiterMarker"),E):(e.exit("tableDelimiterFiller"),E(f))}function E(f){return at(f)?lt(e,L,"whitespace")(f):L(f)}function L(f){return f===124?o(f):f===null||We(f)?!s||a!==i?T(f):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(f)):T(f)}function T(f){return n(f)}function R(f){return e.enter("tableRow"),g(f)}function g(f){return f===124?(e.enter("tableCellDivider"),e.consume(f),e.exit("tableCellDivider"),g):f===null||We(f)?(e.exit("tableRow"),t(f)):at(f)?lt(e,g,"whitespace")(f):(e.enter("data"),A(f))}function A(f){return f===null||f===124||yt(f)?(e.exit("data"),g(f)):(e.consume(f),f===92?S:A)}function S(f){return f===92||f===124?(e.consume(f),A):A(f)}}function P2(e,t){let n=-1,r=!0,a=0,i=[0,0,0,0],s=[0,0,0,0],l=!1,m=0,u,h,c;const _=new F2;for(;++n<e.length;){const p=e[n],o=p[1];p[0]==="enter"?o.type==="tableHead"?(l=!1,m!==0&&(fc(_,t,m,u,h),h=void 0,m=0),u={type:"table",start:Object.assign({},o.start),end:Object.assign({},o.end)},_.add(n,0,[["enter",u,t]])):o.type==="tableRow"||o.type==="tableDelimiterRow"?(r=!0,c=void 0,i=[0,0,0,0],s=[0,n+1,0,0],l&&(l=!1,h={type:"tableBody",start:Object.assign({},o.start),end:Object.assign({},o.end)},_.add(n,0,[["enter",h,t]])),a=o.type==="tableDelimiterRow"?2:h?3:1):a&&(o.type==="data"||o.type==="tableDelimiterMarker"||o.type==="tableDelimiterFiller")?(r=!1,s[2]===0&&(i[1]!==0&&(s[0]=s[1],c=xa(_,t,i,a,void 0,c),i=[0,0,0,0]),s[2]=n)):o.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(s[0]=s[1],c=xa(_,t,i,a,void 0,c)),i=s,s=[i[1],n,0,0])):o.type==="tableHead"?(l=!0,m=n):o.type==="tableRow"||o.type==="tableDelimiterRow"?(m=n,i[1]!==0?(s[0]=s[1],c=xa(_,t,i,a,n,c)):s[1]!==0&&(c=xa(_,t,s,a,n,c)),a=0):a&&(o.type==="data"||o.type==="tableDelimiterMarker"||o.type==="tableDelimiterFiller")&&(s[3]=n)}for(m!==0&&fc(_,t,m,u,h),_.consume(t.events),n=-1;++n<t.events.length;){const p=t.events[n];p[0]==="enter"&&p[1].type==="table"&&(p[1]._align=N2(t.events,n))}return e}function xa(e,t,n,r,a,i){const s=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(i.end=Object.assign({},qr(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const m=qr(t.events,n[1]);if(i={type:s,start:Object.assign({},m),end:Object.assign({},m)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const u=qr(t.events,n[2]),h=qr(t.events,n[3]),c={type:l,start:Object.assign({},u),end:Object.assign({},h)};if(e.add(n[2],0,[["enter",c,t]]),r!==2){const _=t.events[n[2]],p=t.events[n[3]];if(_[1].end=Object.assign({},p[1].end),_[1].type="chunkText",_[1].contentType="text",n[3]>n[2]+1){const o=n[2]+1,j=n[3]-n[2]-1;e.add(o,j,[])}}e.add(n[3]+1,0,[["exit",c,t]])}return a!==void 0&&(i.end=Object.assign({},qr(t.events,a)),e.add(a,0,[["exit",i,t]]),i=void 0),i}function fc(e,t,n,r,a){const i=[],s=qr(t.events,n);a&&(a.end=Object.assign({},s),i.push(["exit",a,t])),r.end=Object.assign({},s),i.push(["exit",r,t]),e.add(n+1,0,i)}function qr(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const hc=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|title|textarea|xmp)(?=[\t\n\f\r />])/gi,z2=new RegExp("^"+hc.source,"i"),U2={exit:{htmlFlowData(e){pc.call(this,e,hc)},htmlTextData(e){pc.call(this,e,z2)}}};function pc(e,t){let n=this.sliceSerialize(e);this.options.allowDangerousHtml&&(n=n.replace(t,"&lt;$1$2")),this.raw(this.encode(n))}const V2={enter:{taskListCheck(){this.tag('<input type="checkbox" disabled="" ')}},exit:{taskListCheck(){this.tag("/>")},taskListCheckValueChecked(){this.tag('checked="" ')}}},q2={tokenize:Y2},X2={text:{[91]:q2}};function Y2(e,t,n){const r=this;return a;function a(m){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(m):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(m),e.exit("taskListCheckMarker"),i)}function i(m){return yt(m)?(e.enter("taskListCheckValueUnchecked"),e.consume(m),e.exit("taskListCheckValueUnchecked"),s):m===88||m===120?(e.enter("taskListCheckValueChecked"),e.consume(m),e.exit("taskListCheckValueChecked"),s):n(m)}function s(m){return m===93?(e.enter("taskListCheckMarker"),e.consume(m),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(m)}function l(m){return We(m)?t(m):at(m)?e.check({tokenize:K2},t,n)(m):n(m)}}function K2(e,t,n){return lt(e,r,"whitespace");function r(a){return a===null?n(a):t(a)}}function G2(e){return H0([a2,b2(),B2(e),H2,X2])}function W2(e){return D0([h2,I2(e),C2,O2,U2,V2])}const jt={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,soh:1,stx:2,etx:3,eot:4,enq:5,ack:6,bel:7,bs:8,ht:9,lf:10,vt:11,ff:12,cr:13,so:14,si:15,dle:16,dc1:17,dc2:18,dc3:19,dc4:20,nak:21,syn:22,etb:23,can:24,em:25,sub:26,esc:27,fs:28,gs:29,rs:30,us:31,space:32,exclamationMark:33,quotationMark:34,numberSign:35,dollarSign:36,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,comma:44,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseA:65,uppercaseB:66,uppercaseC:67,uppercaseD:68,uppercaseE:69,uppercaseF:70,uppercaseG:71,uppercaseH:72,uppercaseI:73,uppercaseJ:74,uppercaseK:75,uppercaseL:76,uppercaseM:77,uppercaseN:78,uppercaseO:79,uppercaseP:80,uppercaseQ:81,uppercaseR:82,uppercaseS:83,uppercaseT:84,uppercaseU:85,uppercaseV:86,uppercaseW:87,uppercaseX:88,uppercaseY:89,uppercaseZ:90,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseA:97,lowercaseB:98,lowercaseC:99,lowercaseD:100,lowercaseE:101,lowercaseF:102,lowercaseG:103,lowercaseH:104,lowercaseI:105,lowercaseJ:106,lowercaseK:107,lowercaseL:108,lowercaseM:109,lowercaseN:110,lowercaseO:111,lowercaseP:112,lowercaseQ:113,lowercaseR:114,lowercaseS:115,lowercaseT:116,lowercaseU:117,lowercaseV:118,lowercaseW:119,lowercaseX:120,lowercaseY:121,lowercaseZ:122,leftCurlyBrace:123,verticalBar:124,rightCurlyBrace:125,tilde:126,del:127,degree:176,byteOrderMarker:65279,replacementCharacter:65533},Z2={text:{176:{name:"underline",tokenize:(e,t,n)=>{const r=s=>s===jt.carriageReturn||s===jt.lineFeed||s===jt.carriageReturnLineFeed||s===jt.eof?n(s):s===jt.backslash?(e.consume(s),a):s===jt.degree?(e.exit("underlineContent"),e.enter("underlineMarker"),e.consume(s),e.exit("underlineMarker"),e.exit("underline"),t):(e.consume(s),r),a=s=>s===jt.backslash||s===jt.degree?(e.consume(s),r):r(s),i=s=>s===jt.degree?n(s):r(s);return s=>(e.enter("underline"),e.enter("underlineMarker"),e.consume(s),e.exit("underlineMarker"),e.enter("underlineContent",{contentType:"string"}),i)}}}},Q2={enter:{underline(){this.tag("<u>")}},exit:{underline(){this.tag("</u>")}}},J2={text:{60:{name:"usertag",tokenize:(e,t,n)=>{const r=s=>s===jt.carriageReturn||s===jt.lineFeed||s===jt.carriageReturnLineFeed||s===jt.eof?n(s):s===jt.backslash?(e.consume(s),a):s===jt.greaterThan?(e.exit("usertagContent"),e.enter("usertagMarker"),e.consume(s),e.exit("usertagMarker"),e.exit("usertag"),t):(e.consume(s),r),a=s=>s===jt.backslash||s===jt.greaterThan?(e.consume(s),r):r(s),i=s=>s===jt.atSign?(e.consume(s),e.exit("usertagMarker"),e.enter("usertagContent"),r):n(s);return s=>(e.enter("usertag"),e.enter("usertagMarker"),e.consume(s),i)}}}},$2=e=>({exit:{usertagContent(t){const n=this.sliceSerialize(t);this.tag(`<span class="vac-text-tag" data-user-id="${n}">`);const r=e.find(a=>a._id===n);this.raw(`@${this.encode(r?r.username:n)}`),this.tag("</span>")}}}),ep=(e,{linkOptions:t})=>e.replaceAll("href",n=>`target=${t.target} rel=${t.rel} ${n}`),tp=e=>e.replaceAll(/<a.*?>(.*?)<\/a>/g,"$1");var np=(e,{textFormatting:t})=>{if(t){let n=[];t.linkify||(n=["literalAutolink","literalAutolinkEmail"]);const r=n2(e.replaceAll("<usertag>","<@").replaceAll("</usertag>",">"),{extensions:[{...G2(),disable:{null:n}},Z2,J2],htmlExtensions:[W2(),Q2,$2(t.users)]});if(t.singleLine){const a=document.createElement("div");return a.innerHTML=r,[{types:[],value:a.innerText}]}return t.linkOptions.disabled?[{types:["markdown"],value:tp(r)}]:[{types:["markdown"],value:ep(r,t)}]}return[{types:[],value:e}]};const ro=["png","jpg","jpeg","webp","svg","gif"],vc=["mp4","video/ogg","webm","quicktime"],rp=["mp3","audio/ogg","wav","mpeg"],ip={name:"FormatMessage",components:{SvgIcon:Ht},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{parsedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];let e;this.textFormatting.disabled?e={}:e={textFormatting:{linkify:this.linkify,linkOptions:this.linkOptions,singleLine:this.singleLine,reply:this.reply,users:this.users,...this.textFormatting}};const t=np(this.content,e);return t.forEach(n=>{n.markdown=this.checkType(n,"markdown"),n.tag=this.checkType(n,"tag"),n.image=this.checkImageType(n)}),t}},methods:{checkType(e,t){return e.types&&e.types.indexOf(t)!==-1},checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const r=e.value.substring(t+1,e.value.length),a=t>0&&ro.some(i=>r.toLowerCase().includes(i));return a&&this.setImageSize(e),a},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",n);function n(r){const a=r.path[0].width/150;e.height=Math.round(r.path[0].height/a)+"px",t.removeEventListener("load",n)}},openTag(e){const t=e.target.getAttribute("data-user-id");if(!this.singleLine&&t){const n=this.users.find(r=>String(r._id)===t);this.$emit("open-user-tag",n)}}}},ap=["innerHTML"],sp={class:"vac-image-link-container"},op={class:"vac-image-link-message"};function lp(e,t,n,r,a,i){const s=Ye("svg-icon");return Q(),se("div",{class:$e(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[(Q(!0),se(st,null,tt(i.parsedMessage,(l,m)=>(Q(),se(st,{key:m},[l.markdown?(Q(),se("div",{key:0,class:"markdown",onClick:t[0]||(t[0]=(...u)=>i.openTag&&i.openTag(...u)),innerHTML:l.value},null,8,ap)):(Q(),se("div",{key:1,class:$e(["vac-format-container",{"vac-text-ellipsis":n.singleLine}])},[(Q(),ht(Ad(l.url?"a":"span"),{class:$e({"vac-text-ellipsis":n.singleLine,"vac-text-tag":!n.singleLine&&!n.reply&&l.tag}),href:l.href,target:l.href?n.linkOptions.target:null,rel:l.href?n.linkOptions.rel:null},{default:Ge(()=>[n.deleted?(Q(),se(st,{key:0},[Be(e.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},()=>[Oe(s,{name:"deleted",class:$e(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])]),Un(" "+Qe(n.textMessages.MESSAGE_DELETED),1)],64)):l.url&&l.image?(Q(),se(st,{key:1},[he("div",sp,[he("div",{class:"vac-image-link",style:St({"background-image":`url('${l.value}')`,height:l.height})},null,4)]),he("div",op,Qe(l.value),1)],64)):(Q(),se(st,{key:2},[Un(Qe(l.value),1)],64))]),_:2},1032,["class","href","target","rel"]))],2))],64))),128))],2)}var xi=xt(ip,[["render",lp]]);const kr="__v-click-outside",_c=typeof window!="undefined",cp=typeof navigator!="undefined",up=_c&&("ontouchstart"in window||cp&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],dp=e=>{const t=typeof e=="function";if(!t&&typeof e!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(n=>n),events:e.events||up,isActive:e.isActive!==!1,detectIframe:e.detectIframe!==!1,capture:Boolean(e.capture)}},gc=({event:e,handler:t,middleware:n})=>{n(e)&&t(e)},mp=({el:e,event:t,handler:n,middleware:r})=>{setTimeout(()=>{const{activeElement:a}=document;a&&a.tagName==="IFRAME"&&!e.contains(a)&&gc({event:t,handler:n,middleware:r})},0)},fp=({el:e,event:t,handler:n,middleware:r})=>{const a=t.path||t.composedPath&&t.composedPath();(a?a.indexOf(e)<0:!e.contains(t.target))&&gc({event:t,handler:n,middleware:r})},bc=(e,{value:t})=>{const{events:n,handler:r,middleware:a,isActive:i,detectIframe:s,capture:l}=dp(t);if(!!i){if(e[kr]=n.map(m=>({event:m,srcTarget:document.documentElement,handler:u=>fp({el:e,event:u,handler:r,middleware:a}),capture:l})),s){const m={event:"blur",srcTarget:window,handler:u=>mp({el:e,event:u,handler:r,middleware:a}),capture:l};e[kr]=[...e[kr],m]}e[kr].forEach(({event:m,srcTarget:u,handler:h})=>setTimeout(()=>{!e[kr]||u.addEventListener(m,h,l)},0))}},xc=e=>{(e[kr]||[]).forEach(({event:n,srcTarget:r,handler:a,capture:i})=>r.removeEventListener(n,a,i)),delete e[kr]};var ya=_c?{beforeMount:bc,updated:(e,{value:t,oldValue:n})=>{JSON.stringify(t)!==JSON.stringify(n)&&(xc(e),bc(e,{value:t}))},unmounted:xc}:{},yc=(e,t,n)=>{if(e.typingUsers&&e.typingUsers.length){const r=e.users.filter(a=>{if(a._id!==t&&e.typingUsers.indexOf(a._id)!==-1&&!(a.status&&a.status.state==="offline"))return!0});return r.length?e.users.length===2?n.IS_TYPING:r.map(a=>a.username).join(", ")+" "+n.IS_TYPING:void 0}};function yi(e,t){if(!(!t||!t.type))return e.some(n=>t.type.toLowerCase().includes(n))}function Xr(e){return yi(ro,e)}function wi(e){return yi(vc,e)}function wc(e){return yi(ro,e)||yi(vc,e)}function wa(e){return yi(rp,e)}const hp={name:"RoomsContent",components:{SvgIcon:Ht,FormatMessage:xi},directives:{clickOutside:ya},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const n=this.room.users.find(r=>r._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:!n||n._id===this.currentUserId?t:`${n.username} - ${t}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(t=>t._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return yc(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var t,n;const e=(n=(t=this.room.lastMessage)==null?void 0:t.files)==null?void 0:n[0];if(e){if(!e.duration)return`${e.name}.${e.extension}`;let r=Math.floor(e.duration);return(r-(r%=60))/60+(r>9?":":":0")+r}return""},isAudio(){return this.room.lastMessage.files?wa(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},pp={class:"vac-room-container"},vp={class:"vac-name-container vac-text-ellipsis"},_p={class:"vac-title-container"},gp={class:"vac-room-name vac-text-ellipsis"},bp={key:1,class:"vac-text-date"},xp={key:0},yp={key:1,class:"vac-text-ellipsis"},wp={key:3,class:"vac-text-ellipsis"},kp={class:"vac-room-options-container"},Sp={key:0,class:"vac-badge-counter vac-room-badge"},Mp={key:0,class:"vac-menu-options"},Ap={class:"vac-menu-list"},Ep=["onClick"];function Tp(e,t,n,r,a,i){const s=Ye("svg-icon"),l=Ye("format-message"),m=oa("click-outside");return Q(),se("div",pp,[Be(e.$slots,"room-list-item_"+n.room.roomId,{},()=>[Be(e.$slots,"room-list-avatar_"+n.room.roomId,{},()=>[n.room.avatar?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.room.avatar}')`})},null,4)):Te("",!0)]),he("div",vp,[he("div",_p,[i.userStatus?(Q(),se("div",{key:0,class:$e(["vac-state-circle",{"vac-state-online":i.userStatus==="online"}])},null,2)):Te("",!0),he("div",gp,Qe(n.room.roomName),1),n.room.lastMessage?(Q(),se("div",bp,Qe(n.room.lastMessage.timestamp),1)):Te("",!0)]),he("div",{class:$e(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!i.typingUsers}])},[i.isMessageCheckmarkVisible?(Q(),se("span",xp,[Be(e.$slots,"checkmark-icon_"+n.room.roomId,{},()=>[Oe(s,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Te("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&i.isAudio?(Q(),se("div",yp,[Be(e.$slots,"microphone-icon_"+n.room.roomId,{},()=>[Oe(s,{name:"microphone",class:"vac-icon-microphone"})]),Un(" "+Qe(i.formattedDuration),1)])):n.room.lastMessage?(Q(),ht(l,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:i.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!i.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Te("",!0),!n.room.lastMessage&&i.typingUsers?(Q(),se("div",wp,Qe(i.typingUsers),1)):Te("",!0),he("div",kp,[n.room.unreadCount?(Q(),se("div",Sp,Qe(n.room.unreadCount),1)):Te("",!0),Be(e.$slots,"room-list-options_"+n.room.roomId,{},()=>[n.roomActions.length?(Q(),se("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Rn(u=>a.roomMenuOpened=n.room.roomId,["stop"]))},[Be(e.$slots,"room-list-options-icon_"+n.room.roomId,{},()=>[Oe(s,{name:"dropdown",param:"room"})])])):Te("",!0),n.roomActions.length?(Q(),ht(Ct,{key:1,name:"vac-slide-left"},{default:Ge(()=>[a.roomMenuOpened===n.room.roomId?zn((Q(),se("div",Mp,[he("div",Ap,[(Q(!0),se(st,null,tt(n.roomActions,u=>(Q(),se("div",{key:u.name},[he("div",{class:"vac-menu-item",onClick:Rn(h=>i.roomActionHandler(u),["stop"])},Qe(u.title),9,Ep)]))),128))])])),[[m,i.closeRoomMenu]]):Te("",!0)]),_:1})):Te("",!0)])])],2)])])])}var Rp=xt(hp,[["render",Tp]]),io=(e,t,n,r=!1)=>!n||n===""?e:e.filter(a=>r?ka(a[t]).startsWith(ka(n)):ka(a[t]).includes(ka(n)));function ka(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const Ip={name:"RoomsList",components:{Loader:pa,RoomsSearch:df,RoomContent:Rp},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=io(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},Cp={key:0,class:"vac-rooms-empty"},Bp={key:1,id:"rooms-list",class:"vac-room-list"},Op=["id","onClick"],Lp={key:0,id:"infinite-loader-rooms"};function Fp(e,t,n,r,a,i){const s=Ye("rooms-search"),l=Ye("loader"),m=Ye("room-content");return zn((Q(),se("div",{class:$e(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Be(e.$slots,"rooms-header"),Be(e.$slots,"rooms-list-search",{},()=>[Oe(s,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:i.searchRoom,onAddRoom:t[0]||(t[0]=u=>e.$emit("add-room"))},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Oe(l,{show:n.loadingRooms,type:"rooms"},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["show"]),!n.loadingRooms&&!n.rooms.length?(Q(),se("div",Cp,[Be(e.$slots,"rooms-empty",{},()=>[Un(Qe(n.textMessages.ROOMS_EMPTY),1)])])):Te("",!0),n.loadingRooms?Te("",!0):(Q(),se("div",Bp,[(Q(!0),se(st,null,tt(a.filteredRooms,u=>(Q(),se("div",{id:u.roomId,key:u.roomId,class:$e(["vac-room-item",{"vac-room-selected":a.selectedRoomId===u.roomId}]),onClick:h=>i.openRoom(u)},[Oe(m,{"current-user-id":n.currentUserId,room:u,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:t[1]||(t[1]=h=>e.$emit("room-action-handler",h))},_t({_:2},[tt(e.$slots,(h,c)=>({name:c,fn:Ge(_=>[Be(e.$slots,c,vt(pt(_)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,Op))),128)),Oe(Ct,{name:"vac-fade-message"},{default:Ge(()=>[n.rooms.length&&!n.loadingRooms?(Q(),se("div",Lp,[Oe(l,{show:a.showLoader,infinite:!0,type:"infinite-rooms"},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["show"])])):Te("",!0)]),_:3})]))],2)),[[ha,n.showRoomsList]])}var jp=xt(Ip,[["render",Fp]]);const Np={name:"RoomHeader",components:{SvgIcon:Ht},directives:{clickOutside:ya},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return yc(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(n=>n._id!==this.currentUserId);if(!(e!=null&&e.status))return;let t="";return e.status.state==="online"?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Hp={class:"vac-room-header vac-app-border-b"},Dp={class:"vac-room-wrapper"},Pp={key:0,class:"vac-room-selection"},zp=he("span",{class:"x-icon vac-item-clickable"},[he("svg",{viewBox:"0 0 24 24",height:"24",width:"24",preserveAspectRatio:"xMidYMid meet",class:"",fill:"currentColor","enable-background":"new 0 0 24 24","xml:space":"preserve"},[he("path",{d:"M19.6004 17.2L14.3004 11.9L19.6004 6.60005L17.8004 4.80005L12.5004 10.2L7.20039 4.90005L5.40039 6.60005L10.7004 11.9L5.40039 17.2L7.20039 19L12.5004 13.7L17.8004 19L19.6004 17.2Z"})])],-1),Up={class:"vac-selection-count-container"},Vp={class:"vac-selection-button-count"},qp=["id"],Xp=["title","onClick"],Yp=[he("span",null,[he("svg",{viewBox:"0 0 24 24",height:"24",width:"24",preserveAspectRatio:"xMidYMid meet",class:"",version:"1.1",x:"0px",y:"0px","enable-background":"new 0 0 24 24","xml:space":"preserve"},[he("path",{fill:"currentColor",d:"M14.278,4.813c0-0.723,0.873-1.085,1.383-0.574l6.045,6.051 c0.317,0.317,0.317,0.829,0,1.146l-6.045,6.051c-0.51,0.51-1.383,0.149-1.383-0.574v-2.732c-5.096,0-8.829,1.455-11.604,4.611 c-0.246,0.279-0.702,0.042-0.602-0.316C3.502,13.303,6.997,8.472,14.278,7.431V4.813z"})])],-1)],Kp=["onClick"],Gp={class:"vac-text-ellipsis"},Wp={class:"vac-room-name vac-text-ellipsis"},Zp={key:0,class:"vac-room-info vac-text-ellipsis"},Qp={key:1,class:"vac-room-info vac-text-ellipsis"},Jp={key:0,class:"vac-menu-options"},$p={class:"vac-menu-list"},ev=["onClick"];function tv(e,t,n,r,a,i){const s=Ye("svg-icon"),l=oa("click-outside");return Q(),se("div",Hp,[Be(e.$slots,"room-header",{},()=>[he("div",Dp,[Oe(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.messageSelectionEnabled?(Q(),se("div",Pp,[he("div",{class:"vac-selection-cancel",onClick:t[0]||(t[0]=m=>e.$emit("cancel-message-selection"))},[zp,he("div",Up,[he("span",Vp,Qe(n.selectedMessagesTotal),1),Un(" "+Qe(n.textMessages.COUNT_SELECT_MESSAGE),1)])]),(Q(!0),se(st,null,tt(n.messageSelectionActions,m=>(Q(),se("div",{id:m.name,key:m.name},[m.name==="forwardMessages"?(Q(),se("div",{key:0,class:"vac-item-clickable forward-messages",title:m.title,onClick:u=>i.messageSelectionActionHandler(m)},Yp,8,Xp)):(Q(),se("div",{key:1,class:"vac-selection-button",onClick:u=>i.messageSelectionActionHandler(m)},Qe(m.title),9,Kp))],8,qp))),128))])):Te("",!0)]),_:1}),!n.messageSelectionEnabled&&a.messageSelectionAnimationEnded?(Q(),se(st,{key:0},[n.singleRoom?Te("",!0):(Q(),se("div",{key:0,class:$e(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:t[1]||(t[1]=m=>e.$emit("toggle-rooms-list"))},[Be(e.$slots,"toggle-icon",{},()=>[Oe(s,{name:"toggle"})])],2)),he("div",{class:$e(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:t[2]||(t[2]=m=>e.$emit("room-info"))},[Be(e.$slots,"room-header-avatar",{},()=>[n.room.avatar?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.room.avatar}')`})},null,4)):Te("",!0)]),Be(e.$slots,"room-header-info",{},()=>[he("div",Gp,[he("div",Wp,Qe(n.room.roomName),1),i.typingUsers?(Q(),se("div",Zp,Qe(i.typingUsers),1)):(Q(),se("div",Qp,Qe(i.userStatus),1))])])],2),n.room.roomId?Be(e.$slots,"room-options",{key:1},()=>[n.menuActions.length?(Q(),se("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=m=>a.menuOpened=!a.menuOpened)},[Be(e.$slots,"menu-icon",{},()=>[Oe(s,{name:"menu"})])])):Te("",!0),n.menuActions.length?(Q(),ht(Ct,{key:1,name:"vac-slide-left"},{default:Ge(()=>[a.menuOpened?zn((Q(),se("div",Jp,[he("div",$p,[(Q(!0),se(st,null,tt(n.menuActions,m=>(Q(),se("div",{key:m.name},[he("div",{class:"vac-menu-item",onClick:u=>i.menuActionHandler(m)},Qe(m.title),9,ev)]))),128))])])),[[l,i.closeMenu]]):Te("",!0)]),_:1})):Te("",!0)]):Te("",!0)],64)):Te("",!0)])])])}var nv=xt(Np,[["render",tv]]);function Sa(e){if(typeof e!="string"||!e)throw new Error("expected a non-empty string, got: "+e)}function ao(e){if(typeof e!="number")throw new Error("expected a number, got: "+e)}const rv=1,iv=1,Sr="emoji",Yr="keyvalue",so="favorites",av="tokens",kc="tokens",sv="unicode",Sc="count",ov="group",lv="order",Mc="group-order",oo="eTag",Ma="url",Ac="skinTone",Kr="readonly",lo="readwrite",Ec="skinUnicodes",cv="skinUnicodes",uv="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",dv="en";function mv(e,t){const n=new Set,r=[];for(const a of e){const i=t(a);n.has(i)||(n.add(i),r.push(a))}return r}function Tc(e){return mv(e,t=>t.unicode)}function fv(e){function t(n,r,a){const i=r?e.createObjectStore(n,{keyPath:r}):e.createObjectStore(n);if(a)for(const[s,[l,m]]of Object.entries(a))i.createIndex(s,l,{multiEntry:m});return i}t(Yr),t(Sr,sv,{[kc]:[av,!0],[Mc]:[[ov,lv]],[Ec]:[cv,!0]}),t(so,void 0,{[Sc]:[""]})}const co={},Aa={},Ea={};function Rc(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}async function hv(e){const t=await new Promise((n,r)=>{const a=indexedDB.open(e,rv);co[e]=a,a.onupgradeneeded=i=>{i.oldVersion<iv&&fv(a.result)},Rc(n,r,a)});return t.onclose=()=>uo(e),t}function pv(e){return Aa[e]||(Aa[e]=hv(e)),Aa[e]}function Xn(e,t,n,r){return new Promise((a,i)=>{const s=e.transaction(t,n,{durability:"relaxed"}),l=typeof t=="string"?s.objectStore(t):t.map(u=>s.objectStore(u));let m;r(l,s,u=>{m=u}),s.oncomplete=()=>a(m),s.onerror=()=>i(s.error)})}function uo(e){const t=co[e],n=t&&t.result;if(n){n.close();const r=Ea[e];if(r)for(const a of r)a()}delete co[e],delete Aa[e],delete Ea[e]}function vv(e){return new Promise((t,n)=>{uo(e);const r=indexedDB.deleteDatabase(e);Rc(t,n,r)})}function _v(e,t){let n=Ea[e];n||(n=Ea[e]=[]),n.push(t)}const gv=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function Gr(e){return e.split(/[\s_]+/).map(t=>!t.match(/\w/)||gv.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const bv=2;function Ic(e){return e.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=bv)}function xv(e){return e.map(({annotation:n,emoticon:r,group:a,order:i,shortcodes:s,skins:l,tags:m,emoji:u,version:h})=>{const c=[...new Set(Ic([...(s||[]).map(Gr).flat(),...m.map(Gr).flat(),...Gr(n),r]))].sort(),_={annotation:n,group:a,order:i,tags:m,tokens:c,unicode:u,version:h};if(r&&(_.emoticon=r),s&&(_.shortcodes=s),l){_.skinTones=[],_.skinUnicodes=[],_.skinVersions=[];for(const{tone:p,emoji:o,version:j}of l)_.skinTones.push(p),_.skinUnicodes.push(o),_.skinVersions.push(j)}return _})}function Cc(e,t,n,r){e[t](n).onsuccess=a=>r&&r(a.target.result)}function Mr(e,t,n){Cc(e,"get",t,n)}function Bc(e,t,n){Cc(e,"getAll",t,n)}function mo(e){e.commit&&e.commit()}function yv(e,t){let n=e[0];for(let r=1;r<e.length;r++){const a=e[r];t(n)>t(a)&&(n=a)}return n}function Oc(e,t){const n=yv(e,a=>a.length),r=[];for(const a of n)e.some(i=>i.findIndex(s=>t(s)===t(a))===-1)||r.push(a);return r}async function wv(e){return!await fo(e,Yr,Ma)}async function kv(e,t,n){const[r,a]=await Promise.all([oo,Ma].map(i=>fo(e,Yr,i)));return r===n&&a===t}async function Sv(e,t){return Xn(e,Sr,Kr,(r,a,i)=>{let s;const l=()=>{r.getAll(s&&IDBKeyRange.lowerBound(s,!0),50).onsuccess=m=>{const u=m.target.result;for(const h of u)if(s=h.unicode,t(h))return i(h);if(u.length<50)return i();l()}};l()})}async function Lc(e,t,n,r){try{const a=xv(t);await Xn(e,[Sr,Yr],lo,([i,s],l)=>{let m,u,h=0;function c(){++h===2&&_()}function _(){if(!(m===r&&u===n)){i.clear();for(const p of a)i.put(p);s.put(r,oo),s.put(n,Ma),mo(l)}}Mr(s,oo,p=>{m=p,c()}),Mr(s,Ma,p=>{u=p,c()})})}finally{}}async function Mv(e,t){return Xn(e,Sr,Kr,(n,r,a)=>{const i=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Bc(n.index(Mc),i,a)})}async function Fc(e,t){const n=Ic(Gr(t));return n.length?Xn(e,Sr,Kr,(r,a,i)=>{const s=[],l=()=>{s.length===n.length&&m()},m=()=>{const u=Oc(s,h=>h.unicode);i(u.sort((h,c)=>h.order<c.order?-1:1))};for(let u=0;u<n.length;u++){const h=n[u],c=u===n.length-1?IDBKeyRange.bound(h,h+"\uFFFF",!1,!0):IDBKeyRange.only(h);Bc(r.index(kc),c,_=>{s.push(_),l()})}}):[]}async function Av(e,t){const n=await Fc(e,t);return n.length?n.filter(r=>(r.shortcodes||[]).map(i=>i.toLowerCase()).includes(t.toLowerCase()))[0]||null:await Sv(e,a=>(a.shortcodes||[]).includes(t.toLowerCase()))||null}async function Ev(e,t){return Xn(e,Sr,Kr,(n,r,a)=>Mr(n,t,i=>{if(i)return a(i);Mr(n.index(Ec),t,s=>a(s||null))}))}function fo(e,t,n){return Xn(e,t,Kr,(r,a,i)=>Mr(r,n,i))}function Tv(e,t,n,r){return Xn(e,t,lo,(a,i)=>{a.put(r,n),mo(i)})}function Rv(e,t){return Xn(e,so,lo,(n,r)=>Mr(n,t,a=>{n.put((a||0)+1,t),mo(r)}))}function Iv(e,t,n){return n===0?[]:Xn(e,[so,Sr],Kr,([r,a],i,s)=>{const l=[];r.index(Sc).openCursor(void 0,"prev").onsuccess=m=>{const u=m.target.result;if(!u)return s(l);function h(p){if(l.push(p),l.length===n)return s(l);u.continue()}const c=u.primaryKey,_=t.byName(c);if(_)return h(_);Mr(a,c,p=>{if(p)return h(p);u.continue()})}})}const Ta="";function Cv(e,t){const n=new Map;for(const a of e){const i=t(a);for(const s of i){let l=n;for(let u=0;u<s.length;u++){const h=s.charAt(u);let c=l.get(h);c||(c=new Map,l.set(h,c)),l=c}let m=l.get(Ta);m||(m=[],l.set(Ta,m)),m.push(a)}}return(a,i)=>{let s=n;for(let u=0;u<a.length;u++){const h=a.charAt(u),c=s.get(h);if(c)s=c;else return[]}if(i)return s.get(Ta)||[];const l=[],m=[s];for(;m.length;){const h=[...m.shift().entries()].sort((c,_)=>c[0]<_[0]?-1:1);for(const[c,_]of h)c===Ta?l.push(..._):m.push(_)}return l}}const Bv=["name","url"];function Ov(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||Bv.some(r=>!(r in e[0])));if(!t||n)throw new Error("Custom emojis are in the wrong format")}function jc(e){Ov(e);const t=(_,p)=>_.name.toLowerCase()<p.name.toLowerCase()?-1:1,n=e.sort(t),a=Cv(e,_=>[...new Set((_.shortcodes||[]).map(p=>Gr(p)).flat())]),i=_=>a(_,!0),s=_=>a(_,!1),l=_=>{const p=Gr(_),o=p.map((j,O)=>(O<p.length-1?i:s)(j));return Oc(o,j=>j.name).sort(t)},m=new Map,u=new Map;for(const _ of e){u.set(_.name.toLowerCase(),_);for(const p of _.shortcodes||[])m.set(p.toLowerCase(),_)}return{all:n,search:l,byShortcode:_=>m.get(_.toLowerCase()),byName:_=>u.get(_.toLowerCase())}}function ki(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function Nc(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Lv=["annotation","emoji","group","order","tags","version"];function Fv(e){if(!e||!Array.isArray(e)||!e[0]||typeof e[0]!="object"||Lv.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function Hc(e,t){if(Math.floor(e.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+e.status)}async function jv(e){const t=await fetch(e,{method:"HEAD"});Hc(t,e);const n=t.headers.get("etag");return Nc(n),n}async function ho(e){const t=await fetch(e);Hc(t,e);const n=t.headers.get("etag");Nc(n);const r=await t.json();return Fv(r),[n,r]}function Nv(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,a=-1;++a<r;)t+=String.fromCharCode(n[a]);return t}function Hv(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),a=-1;++a<t;)r[a]=e.charCodeAt(a);return n}async function Dc(e){const t=JSON.stringify(e),n=Hv(t),r=await crypto.subtle.digest("SHA-1",n),a=Nv(r);return btoa(a)}async function Dv(e,t){let n,r=await jv(t);if(!r){const a=await ho(t);r=a[0],n=a[1],r||(r=await Dc(n))}await kv(e,t,r)||(n||(n=(await ho(t))[1]),await Lc(e,n,t,r))}async function Pv(e,t){let[n,r]=await ho(t);n||(n=await Dc(r)),await Lc(e,r,t,n)}class Pc{constructor({dataSource:t=uv,locale:n=dv,customEmoji:r=[]}={}){this.dataSource=t,this.locale=n,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=jc(r),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await pv(this._dbName);_v(this._dbName,this._clear);const n=this.dataSource;await wv(t)?await Pv(t,n):this._lazyUpdate=Dv(t,n)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return ao(t),await this.ready(),Tc(await Mv(this._db,t)).map(ki)}async getEmojiBySearchQuery(t){Sa(t),await this.ready();const n=this._custom.search(t),r=Tc(await Fc(this._db,t)).map(ki);return[...n,...r]}async getEmojiByShortcode(t){Sa(t),await this.ready();const n=this._custom.byShortcode(t);return n||ki(await Av(this._db,t))}async getEmojiByUnicodeOrName(t){Sa(t),await this.ready();const n=this._custom.byName(t);return n||ki(await Ev(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await fo(this._db,Yr,Ac)||0}async setPreferredSkinTone(t){return ao(t),await this.ready(),Tv(this._db,Yr,Ac,t)}async incrementFavoriteEmojiCount(t){return Sa(t),await this.ready(),Rv(this._db,t)}async getTopFavoriteEmoji(t){return ao(t),await this.ready(),(await Iv(this._db,this._custom,t)).map(ki)}set customEmoji(t){this._custom=jc(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await uo(this._dbName)}async delete(){await this._shutdown(),await vv(this._dbName)}}function Si(){}function zc(e){return e()}function Uc(){return Object.create(null)}function Mi(e){e.forEach(zc)}function Vc(e){return typeof e=="function"}function zv(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let Ra;function Ia(e,t){return Ra||(Ra=document.createElement("a")),Ra.href=t,e===Ra.href}function Uv(e){return Object.keys(e).length===0}function Vv(e){return e&&Vc(e.destroy)?e.destroy:Si}function wt(e,t){e.appendChild(t)}function gn(e,t,n){e.insertBefore(t,n||null)}function bn(e){e.parentNode.removeChild(e)}function gt(e){return document.createElement(e)}function Bn(e){return document.createTextNode(e)}function xn(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function ie(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function On(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function qc(e,t){e.value=t==null?"":t}function ir(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}let po;function Ai(e){po=e}const Ei=[],Wr=[],Ca=[],Xc=[],Yc=Promise.resolve();let vo=!1;function Kc(){vo||(vo=!0,Yc.then(Gc))}function qv(){return Kc(),Yc}function _o(e){Ca.push(e)}const go=new Set;let Ba=0;function Gc(){const e=po;do{for(;Ba<Ei.length;){const t=Ei[Ba];Ba++,Ai(t),Xv(t.$$)}for(Ai(null),Ei.length=0,Ba=0;Wr.length;)Wr.pop()();for(let t=0;t<Ca.length;t+=1){const n=Ca[t];go.has(n)||(go.add(n),n())}Ca.length=0}while(Ei.length);for(;Xc.length;)Xc.pop()();vo=!1,go.clear(),Ai(e)}function Xv(e){if(e.fragment!==null){e.update(),Mi(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(_o)}}const Yv=new Set;function Kv(e,t){e&&e.i&&(Yv.delete(e),e.i(t))}const Gv=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Ti(e,t){e.d(1),t.delete(e.key)}function Ri(e,t,n,r,a,i,s,l,m,u,h,c){let _=e.length,p=i.length,o=_;const j={};for(;o--;)j[e[o].key]=o;const O=[],I=new Map,v=new Map;for(o=p;o--;){const R=c(a,i,o),g=n(R);let A=s.get(g);A?r&&A.p(R,t):(A=u(g,R),A.c()),I.set(g,O[o]=A),g in j&&v.set(g,Math.abs(o-j[g]))}const E=new Set,L=new Set;function T(R){Kv(R,1),R.m(l,h),s.set(R.key,R),h=R.first,p--}for(;_&&p;){const R=O[p-1],g=e[_-1],A=R.key,S=g.key;R===g?(h=R.first,_--,p--):I.has(S)?!s.has(A)||E.has(A)?T(R):L.has(S)?_--:v.get(A)>v.get(S)?(L.add(A),T(R)):(E.add(S),_--):(m(g,s),_--)}for(;_--;){const R=e[_];I.has(R.key)||m(R,s)}for(;p;)T(O[p-1]);return O}function Wv(e,t,n,r){const{fragment:a,on_mount:i,on_destroy:s,after_update:l}=e.$$;a&&a.m(t,n),r||_o(()=>{const m=i.map(zc).filter(Vc);s?s.push(...m):Mi(m),e.$$.on_mount=[]}),l.forEach(_o)}function Zv(e,t){const n=e.$$;n.fragment!==null&&(Mi(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Qv(e,t){e.$$.dirty[0]===-1&&(Ei.push(e),Kc(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Jv(e,t,n,r,a,i,s,l=[-1]){const m=po;Ai(e);const u=e.$$={fragment:null,ctx:null,props:i,update:Si,not_equal:a,bound:Uc(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:[]),callbacks:Uc(),dirty:l,skip_bound:!1,root:t.target||m.$$.root};s&&s(u.root);let h=!1;u.ctx=n?n(e,t.props||{},(c,_,...p)=>{const o=p.length?p[0]:_;return u.ctx&&a(u.ctx[c],u.ctx[c]=o)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](o),h&&Qv(e,c)),_}):[],u.update(),h=!0,Mi(u.before_update),u.fragment=r?r(u.ctx):!1,t.target&&(u.fragment&&u.fragment.c(),Wv(e,t.target,void 0,void 0),Gc()),Ai(m)}class $v{$destroy(){Zv(this,1),this.$destroy=Si}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const a=r.indexOf(n);a!==-1&&r.splice(a,1)}}$set(t){this.$$set&&!Uv(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Wc=[[-1,"\u2728","custom"],[0,"\u{1F600}","smileys-emotion"],[1,"\u{1F44B}","people-body"],[3,"\u{1F431}","animals-nature"],[4,"\u{1F34E}","food-drink"],[5,"\u{1F3E0}\uFE0F","travel-places"],[6,"\u26BD","activities"],[7,"\u{1F4DD}","objects"],[8,"\u26D4\uFE0F","symbols"],[9,"\u{1F3C1}","flags"]].map(([e,t,n])=>({id:e,emoji:t,name:n})),Oa=Wc.slice(1),e_=Wc[0],t_=2,Zc=6,Qc=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function Jc(e){return e.unicode.includes("\u200D")}const n_={"\u{1FAE0}":14,"\u{1F972}":13.1,"\u{1F97B}":12.1,"\u{1F970}":11,"\u{1F929}":5,"\u{1F471}\u200D\u2640\uFE0F":4,"\u{1F923}":3,"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":2,"\u{1F600}":1,"\u{1F610}\uFE0F":.7,"\u{1F603}":.6},r_=1e3,i_="\u{1F590}\uFE0F",a_=8,s_=["\u{1F60A}","\u{1F612}","\u2665\uFE0F","\u{1F44D}\uFE0F","\u{1F60D}","\u{1F602}","\u{1F62D}","\u263A\uFE0F","\u{1F614}","\u{1F629}","\u{1F60F}","\u{1F495}","\u{1F64C}","\u{1F618}"],$c='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',o_=(e,t)=>e<t?-1:e>t?1:0,eu=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const r=n.getContext("2d");return r.textBaseline="top",r.font=`100px ${$c}`,r.fillStyle=t,r.scale(.01,.01),r.fillText(e,0,0),r.getImageData(0,0,1,1).data},l_=(e,t)=>{const n=[...e].join(","),r=[...t].join(",");return n===r&&!n.startsWith("0,0,0,")};function c_(e){const t=eu(e,"#000"),n=eu(e,"#fff");return t&&n&&l_(t,n)}function u_(){const e=Object.entries(n_);try{for(const[t,n]of e)if(c_(t))return n}catch{}finally{}return e[0][1]}const bo=new Promise(e=>Qc(()=>e(u_()))),xo=new Map,d_="\uFE0F",m_="\uD83C",f_="\u200D",h_=127995,p_=57339;function v_(e,t){if(t===0)return e;const n=e.indexOf(f_);return n!==-1?e.substring(0,n)+String.fromCodePoint(h_+t-1)+e.substring(n):(e.endsWith(d_)&&(e=e.substring(0,e.length-1)),e+m_+String.fromCodePoint(p_+t-1))}function ar(e){e.preventDefault(),e.stopPropagation()}function yo(e,t,n){return t+=e?-1:1,t<0?t=n.length-1:t>=n.length&&(t=0),t}function tu(e,t){const n=new Set,r=[];for(const a of e){const i=t(a);n.has(i)||(n.add(i),r.push(a))}return r}function __(e,t){const n=r=>{const a={};for(const i of r)typeof i.tone=="number"&&i.version<=t&&(a[i.tone]=i.unicode);return a};return e.map(({unicode:r,skins:a,shortcodes:i,url:s,name:l,category:m})=>({unicode:r,name:l,shortcodes:i,url:s,category:m,id:r||l,skins:a&&n(a),title:(i||[]).join(", ")}))}const La=requestAnimationFrame;let g_=typeof ResizeObserver=="function";function b_(e,t){let n;return g_?(n=new ResizeObserver(r=>t(r[0].contentRect.width)),n.observe(e)):La(()=>t(e.getBoundingClientRect().width)),{destroy(){n&&n.disconnect()}}}function nu(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}let wo;function x_(e,t,n){for(const r of e){const a=n(r),i=nu(a);typeof wo=="undefined"&&(wo=nu(t));const s=i/1.8<wo;xo.set(r.unicode,s)}}function y_(e){return tu(e,t=>t)}const{Map:Ii}=Gv;function ru(e,t,n){const r=e.slice();return r[63]=t[n],r[65]=n,r}function iu(e,t,n){const r=e.slice();return r[66]=t[n],r[65]=n,r}function au(e,t,n){const r=e.slice();return r[63]=t[n],r[65]=n,r}function su(e,t,n){const r=e.slice();return r[69]=t[n],r}function ou(e,t,n){const r=e.slice();return r[72]=t[n],r[65]=n,r}function lu(e,t){let n,r=t[72]+"",a,i,s,l,m,u;return{key:e,first:null,c(){n=gt("div"),a=Bn(r),ie(n,"id",i="skintone-"+t[65]),ie(n,"class",s="emoji hide-focus "+(t[65]===t[20]?"active":"")),ie(n,"aria-selected",l=t[65]===t[20]),ie(n,"role","option"),ie(n,"title",m=t[0].skinTones[t[65]]),ie(n,"tabindex","-1"),ie(n,"aria-label",u=t[0].skinTones[t[65]]),this.first=n},m(h,c){gn(h,n,c),wt(n,a)},p(h,c){t=h,c[0]&512&&r!==(r=t[72]+"")&&On(a,r),c[0]&512&&i!==(i="skintone-"+t[65])&&ie(n,"id",i),c[0]&1049088&&s!==(s="emoji hide-focus "+(t[65]===t[20]?"active":""))&&ie(n,"class",s),c[0]&1049088&&l!==(l=t[65]===t[20])&&ie(n,"aria-selected",l),c[0]&513&&m!==(m=t[0].skinTones[t[65]])&&ie(n,"title",m),c[0]&513&&u!==(u=t[0].skinTones[t[65]])&&ie(n,"aria-label",u)},d(h){h&&bn(n)}}}function cu(e,t){let n,r,a=t[69].emoji+"",i,s,l,m,u,h,c;function _(){return t[49](t[69])}return{key:e,first:null,c(){n=gt("button"),r=gt("div"),i=Bn(a),ie(r,"class","nav-emoji emoji"),ie(n,"role","tab"),ie(n,"class","nav-button"),ie(n,"aria-controls",s="tab-"+t[69].id),ie(n,"aria-label",l=t[0].categories[t[69].name]),ie(n,"aria-selected",m=!t[4]&&t[13].id===t[69].id),ie(n,"title",u=t[0].categories[t[69].name]),this.first=n},m(p,o){gn(p,n,o),wt(n,r),wt(r,i),h||(c=xn(n,"click",_),h=!0)},p(p,o){t=p,o[0]&4096&&a!==(a=t[69].emoji+"")&&On(i,a),o[0]&4096&&s!==(s="tab-"+t[69].id)&&ie(n,"aria-controls",s),o[0]&4097&&l!==(l=t[0].categories[t[69].name])&&ie(n,"aria-label",l),o[0]&12304&&m!==(m=!t[4]&&t[13].id===t[69].id)&&ie(n,"aria-selected",m),o[0]&4097&&u!==(u=t[0].categories[t[69].name])&&ie(n,"title",u)},d(p){p&&bn(n),h=!1,c()}}}function w_(e){let t,n;return{c(){t=gt("img"),ie(t,"class","custom-emoji"),Ia(t.src,n=e[63].url)||ie(t,"src",n),ie(t,"alt",""),ie(t,"loading","lazy")},m(r,a){gn(r,t,a)},p(r,a){a[0]&32768&&!Ia(t.src,n=r[63].url)&&ie(t,"src",n)},d(r){r&&bn(t)}}}function k_(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Bn(t)},m(r,a){gn(r,n,a)},p(r,a){a[0]&33024&&t!==(t=r[27](r[63],r[8])+"")&&On(n,t)},d(r){r&&bn(n)}}}function uu(e,t){let n,r,a,i,s,l,m;function u(_,p){return _[63].unicode?k_:w_}let h=u(t),c=h(t);return{key:e,first:null,c(){n=gt("button"),c.c(),ie(n,"role",r=t[4]?"option":"menuitem"),ie(n,"aria-selected",a=t[4]?t[65]==t[5]:""),ie(n,"aria-label",i=t[28](t[63],t[8])),ie(n,"title",s=t[63].title),ie(n,"class",l="emoji "+(t[4]&&t[65]===t[5]?"active":"")),ie(n,"id",m="emo-"+t[63].id),this.first=n},m(_,p){gn(_,n,p),c.m(n,null)},p(_,p){t=_,h===(h=u(t))&&c?c.p(t,p):(c.d(1),c=h(t),c&&(c.c(),c.m(n,null))),p[0]&16&&r!==(r=t[4]?"option":"menuitem")&&ie(n,"role",r),p[0]&32816&&a!==(a=t[4]?t[65]==t[5]:"")&&ie(n,"aria-selected",a),p[0]&33024&&i!==(i=t[28](t[63],t[8]))&&ie(n,"aria-label",i),p[0]&32768&&s!==(s=t[63].title)&&ie(n,"title",s),p[0]&32816&&l!==(l="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&ie(n,"class",l),p[0]&32768&&m!==(m="emo-"+t[63].id)&&ie(n,"id",m)},d(_){_&&bn(n),c.d()}}}function du(e,t){let n,r=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",a,i,s,l,m=[],u=new Ii,h,c,_,p=t[66].emojis;const o=j=>j[63].id;for(let j=0;j<p.length;j+=1){let O=au(t,p,j),I=o(O);u.set(I,m[j]=uu(I,O))}return{key:e,first:null,c(){n=gt("div"),a=Bn(r),l=gt("div");for(let j=0;j<m.length;j+=1)m[j].c();ie(n,"id",i="menu-label-"+t[65]),ie(n,"class",s="category "+(t[15].length===1&&t[15][0].category===""?"gone":"")),ie(n,"aria-hidden","true"),ie(l,"class","emoji-menu"),ie(l,"role",h=t[4]?"listbox":"menu"),ie(l,"aria-labelledby",c="menu-label-"+t[65]),ie(l,"id",_=t[4]?"search-results":""),this.first=n},m(j,O){gn(j,n,O),wt(n,a),gn(j,l,O);for(let I=0;I<m.length;I+=1)m[I].m(l,null)},p(j,O){t=j,O[0]&40977&&r!==(r=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&On(a,r),O[0]&32768&&i!==(i="menu-label-"+t[65])&&ie(n,"id",i),O[0]&32768&&s!==(s="category "+(t[15].length===1&&t[15][0].category===""?"gone":""))&&ie(n,"class",s),O[0]&402686256&&(p=t[66].emojis,m=Ri(m,O,o,1,t,p,u,l,Ti,uu,null,au)),O[0]&16&&h!==(h=t[4]?"listbox":"menu")&&ie(l,"role",h),O[0]&32768&&c!==(c="menu-label-"+t[65])&&ie(l,"aria-labelledby",c),O[0]&16&&_!==(_=t[4]?"search-results":"")&&ie(l,"id",_)},d(j){j&&bn(n),j&&bn(l);for(let O=0;O<m.length;O+=1)m[O].d()}}}function S_(e){let t,n;return{c(){t=gt("img"),ie(t,"class","custom-emoji"),Ia(t.src,n=e[63].url)||ie(t,"src",n),ie(t,"alt",""),ie(t,"loading","lazy")},m(r,a){gn(r,t,a)},p(r,a){a[0]&1024&&!Ia(t.src,n=r[63].url)&&ie(t,"src",n)},d(r){r&&bn(t)}}}function M_(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Bn(t)},m(r,a){gn(r,n,a)},p(r,a){a[0]&1280&&t!==(t=r[27](r[63],r[8])+"")&&On(n,t)},d(r){r&&bn(n)}}}function mu(e,t){let n,r,a,i;function s(u,h){return u[63].unicode?M_:S_}let l=s(t),m=l(t);return{key:e,first:null,c(){n=gt("button"),m.c(),ie(n,"role","menuitem"),ie(n,"aria-label",r=t[28](t[63],t[8])),ie(n,"title",a=t[63].title),ie(n,"class","emoji"),ie(n,"id",i="fav-"+t[63].id),this.first=n},m(u,h){gn(u,n,h),m.m(n,null)},p(u,h){t=u,l===(l=s(t))&&m?m.p(t,h):(m.d(1),m=l(t),m&&(m.c(),m.m(n,null))),h[0]&1280&&r!==(r=t[28](t[63],t[8]))&&ie(n,"aria-label",r),h[0]&1024&&a!==(a=t[63].title)&&ie(n,"title",a),h[0]&1024&&i!==(i="fav-"+t[63].id)&&ie(n,"id",i)},d(u){u&&bn(n),m.d()}}}function A_(e){let t,n,r,a,i,s,l,m,u,h=e[0].searchLabel+"",c,_,p=e[0].searchDescription+"",o,j,O,I,v,E,L,T=e[0].skinToneDescription+"",R,g,A=[],S=new Ii,f,x,b,y,k,w=[],H=new Ii,Y,P,V,d,M,W,C,fe,Se=[],ge=new Ii,_e,He,Re,pe,Ve,rt=[],z=new Ii,X,ne,ce,de,Me,Ee,we=e[9];const Ae=ue=>ue[72];for(let ue=0;ue<we.length;ue+=1){let ke=ou(e,we,ue),ee=Ae(ke);S.set(ee,A[ue]=lu(ee,ke))}let be=e[12];const Pe=ue=>ue[69].id;for(let ue=0;ue<be.length;ue+=1){let ke=su(e,be,ue),ee=Pe(ke);H.set(ee,w[ue]=cu(ee,ke))}let je=e[15];const ze=ue=>ue[66].category;for(let ue=0;ue<je.length;ue+=1){let ke=iu(e,je,ue),ee=ze(ke);ge.set(ee,Se[ue]=du(ee,ke))}let Ue=e[10];const Ke=ue=>ue[63].id;for(let ue=0;ue<Ue.length;ue+=1){let ke=ru(e,Ue,ue),ee=Ke(ke);z.set(ee,rt[ue]=mu(ee,ke))}return{c(){t=gt("section"),n=gt("div"),r=gt("div"),a=gt("div"),i=gt("input"),u=gt("label"),c=Bn(h),_=gt("span"),o=Bn(p),j=gt("div"),O=gt("button"),I=Bn(e[21]),L=gt("span"),R=Bn(T),g=gt("div");for(let ue=0;ue<A.length;ue+=1)A[ue].c();k=gt("div");for(let ue=0;ue<w.length;ue+=1)w[ue].c();P=gt("div"),V=gt("div"),d=gt("div"),M=Bn(e[18]),C=gt("div"),fe=gt("div");for(let ue=0;ue<Se.length;ue+=1)Se[ue].c();Ve=gt("div");for(let ue=0;ue<rt.length;ue+=1)rt[ue].c();ce=gt("button"),ce.textContent="\u{1F600}",ie(n,"class","pad-top"),ie(i,"id","search"),ie(i,"class","search"),ie(i,"type","search"),ie(i,"role","combobox"),ie(i,"enterkeyhint","search"),ie(i,"placeholder",s=e[0].searchLabel),ie(i,"autocapitalize","none"),ie(i,"autocomplete","off"),ie(i,"spellcheck","true"),ie(i,"aria-expanded",l=!!(e[4]&&e[1].length)),ie(i,"aria-controls","search-results"),ie(i,"aria-describedby","search-description"),ie(i,"aria-autocomplete","list"),ie(i,"aria-activedescendant",m=e[26]?`emo-${e[26]}`:""),ie(u,"class","sr-only"),ie(u,"for","search"),ie(_,"id","search-description"),ie(_,"class","sr-only"),ie(a,"class","search-wrapper"),ie(O,"id","skintone-button"),ie(O,"class",v="emoji "+(e[6]?"hide-focus":"")),ie(O,"aria-label",e[23]),ie(O,"title",e[23]),ie(O,"aria-describedby","skintone-description"),ie(O,"aria-haspopup","listbox"),ie(O,"aria-expanded",e[6]),ie(O,"aria-controls","skintone-list"),ie(j,"class",E="skintone-button-wrapper "+(e[19]?"expanded":"")),ie(L,"id","skintone-description"),ie(L,"class","sr-only"),ie(g,"id","skintone-list"),ie(g,"class",f="skintone-list "+(e[6]?"":"hidden no-animate")),ir(g,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ie(g,"role","listbox"),ie(g,"aria-label",x=e[0].skinTonesLabel),ie(g,"aria-activedescendant",b="skintone-"+e[20]),ie(g,"aria-hidden",y=!e[6]),ie(r,"class","search-row"),ie(k,"class","nav"),ie(k,"role","tablist"),ir(k,"grid-template-columns","repeat("+e[12].length+", 1fr)"),ie(k,"aria-label",Y=e[0].categoriesLabel),ie(V,"class","indicator"),ir(V,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),ie(P,"class","indicator-wrapper"),ie(d,"class",W="message "+(e[18]?"":"gone")),ie(d,"role","alert"),ie(d,"aria-live","polite"),ie(C,"class",_e="tabpanel "+(!e[14]||e[18]?"gone":"")),ie(C,"role",He=e[4]?"region":"tabpanel"),ie(C,"aria-label",Re=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),ie(C,"id",pe=e[4]?"":`tab-${e[13].id}`),ie(C,"tabindex","0"),ie(Ve,"class",X="favorites emoji-menu "+(e[18]?"gone":"")),ie(Ve,"role","menu"),ie(Ve,"aria-label",ne=e[0].favoritesLabel),ir(Ve,"padding-inline-end",e[25]+"px"),ie(ce,"aria-hidden","true"),ie(ce,"tabindex","-1"),ie(ce,"class","abs-pos hidden emoji"),ie(t,"class","picker"),ie(t,"aria-label",de=e[0].regionLabel),ie(t,"style",e[22])},m(ue,ke){gn(ue,t,ke),wt(t,n),wt(t,r),wt(r,a),wt(a,i),qc(i,e[2]),wt(a,u),wt(u,c),wt(a,_),wt(_,o),wt(r,j),wt(j,O),wt(O,I),wt(r,L),wt(L,R),wt(r,g);for(let ee=0;ee<A.length;ee+=1)A[ee].m(g,null);e[48](g),wt(t,k);for(let ee=0;ee<w.length;ee+=1)w[ee].m(k,null);wt(t,P),wt(P,V),wt(t,d),wt(d,M),wt(t,C),wt(C,fe);for(let ee=0;ee<Se.length;ee+=1)Se[ee].m(fe,null);e[50](C),wt(t,Ve);for(let ee=0;ee<rt.length;ee+=1)rt[ee].m(Ve,null);wt(t,ce),e[51](ce),e[52](t),Me||(Ee=[xn(i,"input",e[47]),xn(i,"keydown",e[30]),xn(O,"click",e[35]),xn(g,"focusout",e[38]),xn(g,"click",e[34]),xn(g,"keydown",e[36]),xn(g,"keyup",e[37]),xn(k,"keydown",e[32]),Vv(e[29].call(null,fe)),xn(C,"click",e[33]),xn(Ve,"click",e[33])],Me=!0)},p(ue,ke){ke[0]&1&&s!==(s=ue[0].searchLabel)&&ie(i,"placeholder",s),ke[0]&18&&l!==(l=!!(ue[4]&&ue[1].length))&&ie(i,"aria-expanded",l),ke[0]&67108864&&m!==(m=ue[26]?`emo-${ue[26]}`:"")&&ie(i,"aria-activedescendant",m),ke[0]&4&&qc(i,ue[2]),ke[0]&1&&h!==(h=ue[0].searchLabel+"")&&On(c,h),ke[0]&1&&p!==(p=ue[0].searchDescription+"")&&On(o,p),ke[0]&2097152&&On(I,ue[21]),ke[0]&64&&v!==(v="emoji "+(ue[6]?"hide-focus":""))&&ie(O,"class",v),ke[0]&8388608&&ie(O,"aria-label",ue[23]),ke[0]&8388608&&ie(O,"title",ue[23]),ke[0]&64&&ie(O,"aria-expanded",ue[6]),ke[0]&524288&&E!==(E="skintone-button-wrapper "+(ue[19]?"expanded":""))&&ie(j,"class",E),ke[0]&1&&T!==(T=ue[0].skinToneDescription+"")&&On(R,T),ke[0]&1049089&&(we=ue[9],A=Ri(A,ke,Ae,1,ue,we,S,g,Ti,lu,null,ou)),ke[0]&64&&f!==(f="skintone-list "+(ue[6]?"":"hidden no-animate"))&&ie(g,"class",f),ke[0]&64&&ir(g,"transform","translateY("+(ue[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ke[0]&1&&x!==(x=ue[0].skinTonesLabel)&&ie(g,"aria-label",x),ke[0]&1048576&&b!==(b="skintone-"+ue[20])&&ie(g,"aria-activedescendant",b),ke[0]&64&&y!==(y=!ue[6])&&ie(g,"aria-hidden",y),ke[0]&12305|ke[1]&1&&(be=ue[12],w=Ri(w,ke,Pe,1,ue,be,H,k,Ti,cu,null,su)),ke[0]&4096&&ir(k,"grid-template-columns","repeat("+ue[12].length+", 1fr)"),ke[0]&1&&Y!==(Y=ue[0].categoriesLabel)&&ie(k,"aria-label",Y),ke[0]&16779264&&ir(V,"transform","translateX("+(ue[24]?-1:1)*ue[11]*100+"%)"),ke[0]&262144&&On(M,ue[18]),ke[0]&262144&&W!==(W="message "+(ue[18]?"":"gone"))&&ie(d,"class",W),ke[0]&402694449&&(je=ue[15],Se=Ri(Se,ke,ze,1,ue,je,ge,fe,Ti,du,null,iu)),ke[0]&278528&&_e!==(_e="tabpanel "+(!ue[14]||ue[18]?"gone":""))&&ie(C,"class",_e),ke[0]&16&&He!==(He=ue[4]?"region":"tabpanel")&&ie(C,"role",He),ke[0]&8209&&Re!==(Re=ue[4]?ue[0].searchResultsLabel:ue[0].categories[ue[13].name])&&ie(C,"aria-label",Re),ke[0]&8208&&pe!==(pe=ue[4]?"":`tab-${ue[13].id}`)&&ie(C,"id",pe),ke[0]&402654464&&(Ue=ue[10],rt=Ri(rt,ke,Ke,1,ue,Ue,z,Ve,Ti,mu,null,ru)),ke[0]&262144&&X!==(X="favorites emoji-menu "+(ue[18]?"gone":""))&&ie(Ve,"class",X),ke[0]&1&&ne!==(ne=ue[0].favoritesLabel)&&ie(Ve,"aria-label",ne),ke[0]&33554432&&ir(Ve,"padding-inline-end",ue[25]+"px"),ke[0]&1&&de!==(de=ue[0].regionLabel)&&ie(t,"aria-label",de),ke[0]&4194304&&ie(t,"style",ue[22])},i:Si,o:Si,d(ue){ue&&bn(t);for(let ke=0;ke<A.length;ke+=1)A[ke].d();e[48](null);for(let ke=0;ke<w.length;ke+=1)w[ke].d();for(let ke=0;ke<Se.length;ke+=1)Se[ke].d();e[50](null);for(let ke=0;ke<rt.length;ke+=1)rt[ke].d();e[51](null),e[52](null),Me=!1,Mi(Ee)}}}function E_(e,t,n){let{skinToneEmoji:r}=t,{i18n:a}=t,{database:i}=t,{customEmoji:s}=t,{customCategorySorting:l}=t,m=!0,u=[],h=[],c="",_="",p,o,j,O=!1,I=-1,v,E=!1,L=!1,T,R=0,g=0,A,S,f="",x=[],b=[],y,k=a_,w=!1,H=0,Y=0,P=Oa,V,d=!1,M;const W=ee=>{p.getRootNode().getElementById(ee).focus()},C=(ee,Ce)=>{p.dispatchEvent(new CustomEvent(ee,{detail:Ce,bubbles:!0,composed:!0}))},fe=(ee,Ce)=>Ce&&ee.skins&&ee.skins[Ce]||ee.unicode,Se=(ee,Ce)=>y_([ee.name||fe(ee,Ce),...ee.shortcodes||[]]).join(", "),ge=ee=>/^skintone-/.test(ee.id);bo.then(ee=>{ee||n(18,v=a.emojiUnsupportedMessage)});function _e(ee){return b_(ee,Ce=>{{const B=getComputedStyle(p),N=parseInt(B.getPropertyValue("--num-columns"),10),U=B.getPropertyValue("direction")==="rtl",K=ee.parentElement.getBoundingClientRect().width-Ce;n(46,k=N),n(25,H=K),n(24,w=U)}})}function He(ee){const Ce=p.getRootNode();x_(ee,o,N=>Ce.getElementById(`emo-${N.id}`)),n(1,u=u)}function Re(ee){return!ee.unicode||!Jc(ee)||xo.get(ee.unicode)}async function pe(ee){const Ce=await bo;return ee.filter(({version:B})=>!B||B<=Ce)}async function Ve(ee){return __(ee,await bo)}async function rt(ee){if(typeof ee=="undefined")return[];const Ce=ee===-1?s:await i.getEmojiByGroup(ee);return Ve(await pe(Ce))}async function z(ee){return Ve(await pe(await i.getEmojiBySearchQuery(ee)))}function X(ee){if(!O||!u.length)return;const Ce=B=>{ar(ee),n(5,I=yo(B,I,u))};switch(ee.key){case"ArrowDown":return Ce(!1);case"ArrowUp":return Ce(!0);case"Enter":if(I!==-1)return ar(ee),de(u[I].id);u.length&&n(5,I=0)}}function ne(ee){n(2,c=""),n(44,_=""),n(5,I=-1),n(11,Y=P.findIndex(Ce=>Ce.id===ee.id))}function ce(ee){const{target:Ce,key:B}=ee,N=U=>{U&&(ar(ee),U.focus())};switch(B){case"ArrowLeft":return N(Ce.previousSibling);case"ArrowRight":return N(Ce.nextSibling);case"Home":return N(Ce.parentElement.firstChild);case"End":return N(Ce.parentElement.lastChild)}}async function de(ee){const Ce=await i.getEmojiByUnicodeOrName(ee),B=[...u,...b].find(U=>U.id===ee),N=B.unicode&&fe(B,R);await i.incrementFavoriteEmojiCount(ee),C("emoji-click",{emoji:Ce,skinTone:R,...N&&{unicode:N},...B.name&&{name:B.name}})}async function Me(ee){const{target:Ce}=ee;if(!Ce.classList.contains("emoji"))return;ar(ee);const B=Ce.id.substring(4);de(B)}async function Ee(ee){const{target:Ce}=ee;if(!ge(Ce))return;ar(ee);const B=parseInt(Ce.id.slice(9),10);n(8,R=B),n(6,E=!1),W("skintone-button"),C("skin-tone-change",{skinTone:B}),i.setPreferredSkinTone(B)}async function we(ee){n(6,E=!E),n(20,g=R),E&&(ar(ee),La(()=>W(`skintone-${g}`)))}function Ae(ee){if(!E)return;const Ce=async B=>{ar(ee),n(20,g=B),await qv(),W(`skintone-${g}`)};switch(ee.key){case"ArrowUp":return Ce(yo(!0,g,x));case"ArrowDown":return Ce(yo(!1,g,x));case"Home":return Ce(0);case"End":return Ce(x.length-1);case"Enter":return Ee(ee);case"Escape":return ar(ee),n(6,E=!1),W("skintone-button")}}function be(ee){if(!!E)switch(ee.key){case" ":return Ee(ee)}}async function Pe(ee){const{relatedTarget:Ce}=ee;(!Ce||!ge(Ce))&&n(6,E=!1)}function je(){c=this.value,n(2,c)}function ze(ee){Wr[ee?"unshift":"push"](()=>{T=ee,n(7,T)})}const Ue=ee=>ne(ee);function Ke(ee){Wr[ee?"unshift":"push"](()=>{j=ee,n(3,j)})}function ue(ee){Wr[ee?"unshift":"push"](()=>{o=ee,n(17,o)})}function ke(ee){Wr[ee?"unshift":"push"](()=>{p=ee,n(16,p)})}return e.$$set=ee=>{"skinToneEmoji"in ee&&n(40,r=ee.skinToneEmoji),"i18n"in ee&&n(0,a=ee.i18n),"database"in ee&&n(39,i=ee.database),"customEmoji"in ee&&n(41,s=ee.customEmoji),"customCategorySorting"in ee&&n(42,l=ee.customCategorySorting)},e.$$.update=()=>{if(e.$$.dirty[1]&1280&&s&&i&&n(39,i.customEmoji=s,i),e.$$.dirty[0]&1|e.$$.dirty[1]&256){async function ee(){let Ce=!1;const B=setTimeout(()=>{Ce=!0,n(18,v=a.loadingMessage)},r_);try{await i.ready(),n(14,d=!0)}catch(N){console.error(N),n(18,v=a.networkErrorMessage)}finally{clearTimeout(B),Ce&&(Ce=!1,n(18,v=""))}}i&&ee()}if(e.$$.dirty[0]&6144|e.$$.dirty[1]&1024&&(s&&s.length?n(12,P=[e_,...Oa]):P!==Oa&&(Y&&n(11,Y--,Y),n(12,P=Oa))),e.$$.dirty[0]&4&&Qc(()=>{n(44,_=(c||"").trim()),n(5,I=-1)}),e.$$.dirty[0]&6144&&n(13,V=P[Y]),e.$$.dirty[0]&24576|e.$$.dirty[1]&8192){async function ee(){if(!d)n(1,u=[]),n(4,O=!1);else if(_.length>=t_){const Ce=_,B=await z(Ce);Ce===_&&(n(1,u=B),n(4,O=!0))}else if(V){const Ce=V.id,B=await rt(Ce);Ce===V.id&&(n(1,u=B),n(4,O=!1))}}ee()}if(e.$$.dirty[0]&4112&&n(22,S=`
  --font-family: ${$c};
  --num-groups: ${P.length}; 
  --indicator-opacity: ${O?0:1}; 
  --num-skintones: ${Zc};`),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){d&&n(8,R=await i.getPreferredSkinTone())}ee()}if(e.$$.dirty[1]&512&&n(9,x=Array(Zc).fill().map((ee,Ce)=>v_(r,Ce))),e.$$.dirty[0]&768&&n(21,A=x[R]),e.$$.dirty[0]&257&&n(23,f=a.skinToneLabel.replace("{skinTone}",a.skinTones[R])),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){n(45,y=(await Promise.all(s_.map(Ce=>i.getEmojiByUnicodeOrName(Ce)))).filter(Boolean))}d&&ee()}if(e.$$.dirty[0]&16384|e.$$.dirty[1]&49408){async function ee(){const Ce=await i.getTopFavoriteEmoji(k),B=await Ve(tu([...Ce,...y],N=>N.unicode||N.name).slice(0,k));n(10,b=B)}d&&y&&ee()}if(e.$$.dirty[0]&10){const ee=u.filter(Ce=>Ce.unicode).filter(Ce=>Jc(Ce)&&!xo.has(Ce.unicode));ee.length?La(()=>He(ee)):(n(1,u=u.filter(Re)),La(()=>{(j||{}).scrollTop=0}))}e.$$.dirty[0]&1026|e.$$.dirty[1]&4096,e.$$.dirty[0]&18|e.$$.dirty[1]&2048&&n(15,h=function(){if(O)return[{category:"",emojis:u}];const Ce=new Map;for(const B of u){const N=B.category||"";let U=Ce.get(N);U||(U=[],Ce.set(N,U)),U.push(B)}return[...Ce.entries()].map(([B,N])=>({category:B,emojis:N})).sort((B,N)=>l(B.category,N.category))}()),e.$$.dirty[0]&34&&n(26,M=I!==-1&&u[I].id),e.$$.dirty[0]&192&&(E?T.addEventListener("transitionend",()=>{n(19,L=!0)},{once:!0}):n(19,L=!1))},[a,u,c,j,O,I,E,T,R,x,b,Y,P,V,d,h,p,o,v,L,g,A,S,f,w,H,M,fe,Se,_e,X,ne,ce,Me,Ee,we,Ae,be,Pe,i,r,s,l,m,_,y,k,je,ze,Ue,Ke,ue,ke]}class T_ extends $v{constructor(t){super(),Jv(this,t,E_,A_,zv,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const R_="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",I_="en";var C_={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading\u2026",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const fu=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class hu extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const n=document.createElement("style");n.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(n),this._ctx={locale:I_,dataSource:R_,skinToneEmoji:i_,customCategorySorting:o_,customEmoji:null,i18n:C_,...t};for(const r of fu)r!=="database"&&Object.prototype.hasOwnProperty.call(this,r)&&(this._ctx[r]=this[r],delete this[r]);this._dbFlush()}connectedCallback(){this._cmp=new T_({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t&&t.close().catch(n=>console.error(n))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(t,n,r){this._set(t.replace(/-([a-z])/g,(a,i)=>i.toUpperCase()),r)}_set(t,n){this._ctx[t]=n,this._cmp&&this._cmp.$set({[t]:n}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:n,database:r}=this._ctx;(!r||r.locale!==t||r.dataSource!==n)&&this._set("database",new Pc({locale:t,dataSource:n}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const pu={};for(const e of fu)pu[e]={get(){return e==="database"&&this._dbCreate(),this._ctx[e]},set(t){if(e==="database")throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(hu.prototype,pu),customElements.get("emoji-picker")||customElements.define("emoji-picker",hu);function vu(e,t){for(;e&&!e.querySelector(t);){e=e.parentNode;const n=e.querySelector(t);if(n)return n}return null}const B_={name:"EmojiPickerContainer",components:{SvgIcon:Ht},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:t})=>{this.$emit("add-emoji",{unicode:t.unicode})})},0)}},methods:{addCustomStyling(){const e=`.picker {
				border: none;
			}`,t=`.nav {
				overflow-x: auto;
			}`,n=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,r=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,a=document.createElement("style");a.textContent=e+t+n+r,this.$refs.emojiPicker.shadowRoot.appendChild(a)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,n){const r=t<500||n<700,a=vu(this.$el,"#room-footer");if(!a){r&&(this.emojiPickerRight="-50px");return}r?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200):(a.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},O_={class:"vac-emoji-wrapper"};function L_(e,t,n,r,a,i){const s=Ye("svg-icon"),l=Ye("emoji-picker");return Q(),se("div",O_,[he("div",{class:$e(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:t[0]||(t[0]=(...m)=>i.openEmoji&&i.openEmoji(...m))},[Be(e.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},()=>[Oe(s,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])])],2),n.emojiOpened?(Q(),ht(Ct,{key:0,name:"vac-slide-up",appear:""},{default:Ge(()=>[he("div",{class:$e(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:St({height:`${a.emojiPickerHeight}px`,top:n.positionTop?a.emojiPickerHeight:`${a.emojiPickerTop}px`,right:a.emojiPickerRight,display:a.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(Q(),ht(l,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):Te("",!0)],6)]),_:1})):Te("",!0)])}var _u=xt(B_,[["render",L_]]);const F_={name:"RoomFiles",components:{Loader:pa,SvgIcon:Ht},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return Xr(this.file)},isVideo(){return wi(this.file)}}},j_={class:"vac-room-file-container"},N_=["src"],H_={class:"vac-text-ellipsis"},D_={key:0,class:"vac-text-ellipsis vac-text-extension"};function P_(e,t,n,r,a,i){const s=Ye("loader"),l=Ye("svg-icon");return Q(),se("div",j_,[Oe(s,{show:n.file.loading,type:"room-file"},_t({_:2},[tt(e.$slots,(m,u)=>({name:u,fn:Ge(h=>[Be(e.$slots,u,vt(pt(h)))])}))]),1032,["show"]),he("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=m=>e.$emit("remove-file",n.index))},[Be(e.$slots,"image-close-icon",{},()=>[Oe(l,{name:"close",param:"image"})])]),i.isImage?(Q(),se("div",{key:0,class:$e(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:St({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):i.isVideo?(Q(),se("video",{key:1,controls:"",class:$e({"vac-blur-loading":n.file.loading})},[he("source",{src:n.file.localUrl||n.file.url},null,8,N_)],2)):(Q(),se("div",{key:2,class:$e(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[he("div",null,[Be(e.$slots,"file-icon",{},()=>[Oe(l,{name:"file"})])]),he("div",H_,Qe(n.file.name),1),n.file.extension?(Q(),se("div",D_,Qe(n.file.extension),1)):Te("",!0)],2))])}var z_=xt(F_,[["render",P_]]);const U_={name:"RoomFiles",components:{SvgIcon:Ht,RoomFile:z_},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},V_={key:0,class:"vac-room-files-container"},q_={class:"vac-files-box"},X_={class:"vac-icon-close"};function Y_(e,t,n,r,a,i){const s=Ye("room-file"),l=Ye("svg-icon");return Q(),ht(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.files.length?(Q(),se("div",V_,[he("div",q_,[(Q(!0),se(st,null,tt(n.files,(m,u)=>(Q(),se("div",{key:u},[Oe(s,{file:m,index:u,onRemoveFile:t[0]||(t[0]=h=>e.$emit("remove-file",h))},_t({_:2},[tt(e.$slots,(h,c)=>({name:c,fn:Ge(_=>[Be(e.$slots,c,vt(pt(_)))])}))]),1032,["file","index"])]))),128))]),he("div",X_,[he("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=m=>e.$emit("reset-message"))},[Be(e.$slots,"files-close-icon",{},()=>[Oe(l,{name:"close-outline"})])])])])):Te("",!0)]),_:3})}var K_=xt(U_,[["render",Y_]]);const G_={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const n=t.getBoundingClientRect().width,r=t.getBoundingClientRect().left;let a=(e.clientX-r)/n;return a=a<0?0:a,a=a>1?1:a,a}}},W_={class:"vac-player-progress"},Z_={class:"vac-line-container"};function Q_(e,t,n,r,a,i){return Q(),se("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...s)=>i.onMouseDown&&i.onMouseDown(...s)),onMouseover:t[1]||(t[1]=s=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=s=>e.$emit("hover-audio-progress",!1))},[he("div",W_,[he("div",Z_,[he("div",{class:"vac-line-progress",style:St({width:`${n.percentage}%`})},null,4),he("div",{class:$e(["vac-line-dot",{"vac-line-dot__active":a.isMouseDown}]),style:St({left:`${n.percentage}%`})},null,6)])])],544)}var J_=xt(G_,[["render",Q_]]);const $_={name:"AudioPlayer",components:{SvgIcon:Ht,AudioControl:J_},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(e*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},eg={class:"vac-audio-player"},tg=["id","src"];function ng(e,t,n,r,a,i){const s=Ye("svg-icon"),l=Ye("audio-control");return Q(),se("div",null,[he("div",eg,[he("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...m)=>i.playback&&i.playback(...m))},[a.isPlaying?Be(e.$slots,"audio-pause-icon_"+n.messageId,{key:0},()=>[Oe(s,{name:"audio-pause"})]):Be(e.$slots,"audio-play-icon_"+n.messageId,{key:1},()=>[Oe(s,{name:"audio-play"})])]),Oe(l,{percentage:a.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:i.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=m=>e.$emit("hover-audio-progress",m))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),he("audio",{id:i.playerUniqId,src:i.audioSource},null,8,tg)])])}var ko=xt($_,[["render",ng]]);const rg={name:"RoomMessageReply",components:{SvgIcon:Ht,FormatMessage:xi,AudioPlayer:ko},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(t=(e=this.messageReply)==null?void 0:e.files)!=null&&t.length?this.messageReply.files[0]:{}},isImage(){return Xr(this.firstFile)},isVideo(){return wi(this.firstFile)},isAudio(){return wa(this.firstFile)},isOtherFile(){var e,t;return((t=(e=this.messageReply)==null?void 0:e.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},ig={key:0,class:"vac-reply-container"},ag={class:"vac-reply-box"},sg={class:"vac-reply-info"},og={class:"vac-reply-username"},lg={class:"vac-reply-content"},cg=["src"],ug={key:1,controls:"",class:"vac-image-reply"},dg=["src"],mg={key:3,class:"vac-image-reply vac-file-container"},fg={class:"vac-text-ellipsis"},hg={key:0,class:"vac-text-ellipsis vac-text-extension"},pg={class:"vac-icon-reply"};function vg(e,t,n,r,a,i){const s=Ye("format-message"),l=Ye("audio-player"),m=Ye("svg-icon");return Q(),ht(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.messageReply?(Q(),se("div",ig,[he("div",ag,[he("div",sg,[he("div",og,Qe(n.messageReply.username),1),he("div",lg,[Oe(s,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),i.isImage?(Q(),se("img",{key:0,src:i.firstFile.url,class:"vac-image-reply"},null,8,cg)):i.isVideo?(Q(),se("video",ug,[he("source",{src:i.firstFile.url},null,8,dg)])):i.isAudio?(Q(),ht(l,{key:2,src:i.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["src"])):i.isOtherFile?(Q(),se("div",mg,[he("div",null,[Be(e.$slots,"file-icon",{},()=>[Oe(m,{name:"file"})])]),he("div",fg,Qe(i.firstFile.name),1),i.firstFile.extension?(Q(),se("div",hg,Qe(i.firstFile.extension),1)):Te("",!0)])):Te("",!0)]),he("div",pg,[he("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=u=>e.$emit("reset-message"))},[Be(e.$slots,"reply-close-icon",{},()=>[Oe(m,{name:"close-outline"})])])])])):Te("",!0)]),_:3})}var _g=xt(rg,[["render",vg]]);const gg={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},bg={key:0,class:"vac-tags-container"},xg=["onMouseover","onClick"],yg={class:"vac-tags-info"},wg={class:"vac-tags-username"};function kg(e,t,n,r,a,i){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.filteredUsersTag.length?(Q(),se("div",bg,[(Q(!0),se(st,null,tt(n.filteredUsersTag,(s,l)=>(Q(),se("div",{key:s._id,class:$e(["vac-tags-box",{"vac-tags-box-active":l===a.activeItem}]),onMouseover:m=>a.activeItem=l,onClick:m=>e.$emit("select-user-tag",s)},[he("div",yg,[s.avatar?(Q(),se("div",{key:0,class:"vac-avatar vac-tags-avatar",style:St({"background-image":`url('${s.avatar}')`})},null,4)):Te("",!0),he("div",wg,Qe(s.username),1)])],42,xg))),128))])):Te("",!0)]),_:1})}var Sg=xt(gg,[["render",kg]]);const Mg={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Ag={key:0,class:"vac-emojis-container"},Eg=["onMouseover","onClick"];function Tg(e,t,n,r,a,i){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.filteredEmojis.length?(Q(),se("div",Ag,[(Q(!0),se(st,null,tt(n.filteredEmojis,(s,l)=>(Q(),se("div",{key:s,class:$e(["vac-emoji-element",{"vac-emoji-element-active":l===a.activeItem}]),onMouseover:m=>a.activeItem=l,onClick:m=>e.$emit("select-emoji",s)},Qe(s),43,Eg))),128))])):Te("",!0)]),_:1})}var Rg=xt(Mg,[["render",Tg]]);const Ig={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},Cg={key:0,class:"vac-template-container vac-app-box-shadow"},Bg=["onMouseover","onClick"],Og={class:"vac-template-info"},Lg={class:"vac-template-tag"},Fg={class:"vac-template-text"};function jg(e,t,n,r,a,i){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Ge(()=>[n.filteredTemplatesText.length?(Q(),se("div",Cg,[(Q(!0),se(st,null,tt(n.filteredTemplatesText,(s,l)=>(Q(),se("div",{key:l,class:$e(["vac-template-box",{"vac-template-active":l===a.activeItem}]),onMouseover:m=>a.activeItem=l,onClick:m=>e.$emit("select-template-text",s)},[he("div",Og,[he("div",Lg," /"+Qe(s.tag),1),he("div",Fg,Qe(s.text),1)])],42,Bg))),128))])):Te("",!0)]),_:1})}var Ng=xt(Ig,[["render",jg]]);function Hg(e){return new Int8Array(e)}function gu(e){return new Int16Array(e)}function bu(e){return new Int32Array(e)}function xu(e){return new Float32Array(e)}function Dg(e){return new Float64Array(e)}function yu(e){if(e.length==1)return xu(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(yu(e));return n}function wu(e){if(e.length==1)return bu(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(wu(e));return n}function ku(e){if(e.length==1)return gu(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(ku(e));return n}function Su(e){if(e.length==1)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(Su(e));return n}var Mu={};Mu.fill=function(e,t,n,r){if(arguments.length==2)for(var a=0;a<e.length;a++)e[a]=arguments[1];else for(var a=t;a<n;a++)e[a]=r};var Ci={};Ci.arraycopy=function(e,t,n,r,a){for(var i=t+a;t<i;)n[r++]=e[t++]},Ci.out={},Ci.out.println=function(e){console.log(e)},Ci.out.printf=function(){console.log.apply(console,arguments)};var Fa={};Fa.SQRT2=1.4142135623730951,Fa.FAST_LOG10=function(e){return Math.log10(e)},Fa.FAST_LOG10_X=function(e,t){return Math.log10(e)*t};function Yn(e){this.ordinal=e}Yn.short_block_allowed=new Yn(0),Yn.short_block_coupled=new Yn(1),Yn.short_block_dispensed=new Yn(2),Yn.short_block_forced=new Yn(3);var Au={};Au.MAX_VALUE=34028235e31;function sn(e){this.ordinal=e}sn.vbr_off=new sn(0),sn.vbr_mt=new sn(1),sn.vbr_rh=new sn(2),sn.vbr_abr=new sn(3),sn.vbr_mtrh=new sn(4),sn.vbr_default=sn.vbr_mtrh;var Pg=function(e){},Ie={System:Ci,VbrMode:sn,Float:Au,ShortBlock:Yn,Util:Fa,Arrays:Mu,new_array_n:Su,new_byte:Hg,new_double:Dg,new_float:xu,new_float_n:yu,new_int:bu,new_int_n:wu,new_short:gu,new_short_n:ku,assert:Pg},zg=Ie.System,Rt=Ie.Util,Ug=Ie.Arrays,Vg=Ie.new_float;function qg(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Rt.SQRT2*.5/2384e-9,.017876148*Rt.SQRT2*.5/2384e-9,.003134727*Rt.SQRT2*.5/2384e-9,.002457142*Rt.SQRT2*.5/2384e-9,971317e-9*Rt.SQRT2*.5/2384e-9,218868e-9*Rt.SQRT2*.5/2384e-9,101566e-9*Rt.SQRT2*.5/2384e-9,13828e-9*Rt.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,n=36,r=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],a=r[F.SHORT_TYPE],i=r[F.SHORT_TYPE],s=r[F.SHORT_TYPE],l=r[F.SHORT_TYPE],m=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function u(_,p,o){for(var j=10,O=p+238-14-286,I=-15;I<0;I++){var v,E,L;v=e[j+-10],E=_[O+-224]*v,L=_[p+224]*v,v=e[j+-9],E+=_[O+-160]*v,L+=_[p+160]*v,v=e[j+-8],E+=_[O+-96]*v,L+=_[p+96]*v,v=e[j+-7],E+=_[O+-32]*v,L+=_[p+32]*v,v=e[j+-6],E+=_[O+32]*v,L+=_[p+-32]*v,v=e[j+-5],E+=_[O+96]*v,L+=_[p+-96]*v,v=e[j+-4],E+=_[O+160]*v,L+=_[p+-160]*v,v=e[j+-3],E+=_[O+224]*v,L+=_[p+-224]*v,v=e[j+-2],E+=_[p+-256]*v,L-=_[O+256]*v,v=e[j+-1],E+=_[p+-192]*v,L-=_[O+192]*v,v=e[j+0],E+=_[p+-128]*v,L-=_[O+128]*v,v=e[j+1],E+=_[p+-64]*v,L-=_[O+64]*v,v=e[j+2],E+=_[p+0]*v,L-=_[O+0]*v,v=e[j+3],E+=_[p+64]*v,L-=_[O+-64]*v,v=e[j+4],E+=_[p+128]*v,L-=_[O+-128]*v,v=e[j+5],E+=_[p+192]*v,L-=_[O+-192]*v,E*=e[j+6],v=L-E,o[30+I*2]=L+E,o[31+I*2]=e[j+7]*v,j+=18,p--,O++}{var E,L,T,R;L=_[p+-16]*e[j+-10],E=_[p+-32]*e[j+-2],L+=(_[p+-48]-_[p+16])*e[j+-9],E+=_[p+-96]*e[j+-1],L+=(_[p+-80]+_[p+48])*e[j+-8],E+=_[p+-160]*e[j+0],L+=(_[p+-112]-_[p+80])*e[j+-7],E+=_[p+-224]*e[j+1],L+=(_[p+-144]+_[p+112])*e[j+-6],E-=_[p+32]*e[j+2],L+=(_[p+-176]-_[p+144])*e[j+-5],E-=_[p+96]*e[j+3],L+=(_[p+-208]+_[p+176])*e[j+-4],E-=_[p+160]*e[j+4],L+=(_[p+-240]-_[p+208])*e[j+-3],E-=_[p+224],T=E-L,R=E+L,L=o[14],E=o[15]-L,o[31]=R+L,o[30]=T+E,o[15]=T-E,o[14]=R-L}{var g;g=o[28]-o[0],o[0]+=o[28],o[28]=g*e[j+-2*18+7],g=o[29]-o[1],o[1]+=o[29],o[29]=g*e[j+-2*18+7],g=o[26]-o[2],o[2]+=o[26],o[26]=g*e[j+-4*18+7],g=o[27]-o[3],o[3]+=o[27],o[27]=g*e[j+-4*18+7],g=o[24]-o[4],o[4]+=o[24],o[24]=g*e[j+-6*18+7],g=o[25]-o[5],o[5]+=o[25],o[25]=g*e[j+-6*18+7],g=o[22]-o[6],o[6]+=o[22],o[22]=g*Rt.SQRT2,g=o[23]-o[7],o[7]+=o[23],o[23]=g*Rt.SQRT2-o[7],o[7]-=o[6],o[22]-=o[7],o[23]-=o[22],g=o[6],o[6]=o[31]-g,o[31]=o[31]+g,g=o[7],o[7]=o[30]-g,o[30]=o[30]+g,g=o[22],o[22]=o[15]-g,o[15]=o[15]+g,g=o[23],o[23]=o[14]-g,o[14]=o[14]+g,g=o[20]-o[8],o[8]+=o[20],o[20]=g*e[j+-10*18+7],g=o[21]-o[9],o[9]+=o[21],o[21]=g*e[j+-10*18+7],g=o[18]-o[10],o[10]+=o[18],o[18]=g*e[j+-12*18+7],g=o[19]-o[11],o[11]+=o[19],o[19]=g*e[j+-12*18+7],g=o[16]-o[12],o[12]+=o[16],o[16]=g*e[j+-14*18+7],g=o[17]-o[13],o[13]+=o[17],o[17]=g*e[j+-14*18+7],g=-o[20]+o[24],o[20]+=o[24],o[24]=g*e[j+-12*18+7],g=-o[21]+o[25],o[21]+=o[25],o[25]=g*e[j+-12*18+7],g=o[4]-o[8],o[4]+=o[8],o[8]=g*e[j+-12*18+7],g=o[5]-o[9],o[5]+=o[9],o[9]=g*e[j+-12*18+7],g=o[0]-o[12],o[0]+=o[12],o[12]=g*e[j+-4*18+7],g=o[1]-o[13],o[1]+=o[13],o[13]=g*e[j+-4*18+7],g=o[16]-o[28],o[16]+=o[28],o[28]=g*e[j+-4*18+7],g=-o[17]+o[29],o[17]+=o[29],o[29]=g*e[j+-4*18+7],g=Rt.SQRT2*(o[2]-o[10]),o[2]+=o[10],o[10]=g,g=Rt.SQRT2*(o[3]-o[11]),o[3]+=o[11],o[11]=g,g=Rt.SQRT2*(-o[18]+o[26]),o[18]+=o[26],o[26]=g-o[18],g=Rt.SQRT2*(-o[19]+o[27]),o[19]+=o[27],o[27]=g-o[19],g=o[2],o[19]-=o[3],o[3]-=g,o[2]=o[31]-g,o[31]+=g,g=o[3],o[11]-=o[19],o[18]-=g,o[3]=o[30]-g,o[30]+=g,g=o[18],o[27]-=o[11],o[19]-=g,o[18]=o[15]-g,o[15]+=g,g=o[19],o[10]-=g,o[19]=o[14]-g,o[14]+=g,g=o[10],o[11]-=g,o[10]=o[23]-g,o[23]+=g,g=o[11],o[26]-=g,o[11]=o[22]-g,o[22]+=g,g=o[26],o[27]-=g,o[26]=o[7]-g,o[7]+=g,g=o[27],o[27]=o[6]-g,o[6]+=g,g=Rt.SQRT2*(o[0]-o[4]),o[0]+=o[4],o[4]=g,g=Rt.SQRT2*(o[1]-o[5]),o[1]+=o[5],o[5]=g,g=Rt.SQRT2*(o[16]-o[20]),o[16]+=o[20],o[20]=g,g=Rt.SQRT2*(o[17]-o[21]),o[17]+=o[21],o[21]=g,g=-Rt.SQRT2*(o[8]-o[12]),o[8]+=o[12],o[12]=g-o[8],g=-Rt.SQRT2*(o[9]-o[13]),o[9]+=o[13],o[13]=g-o[9],g=-Rt.SQRT2*(o[25]-o[29]),o[25]+=o[29],o[29]=g-o[25],g=-Rt.SQRT2*(o[24]+o[28]),o[24]-=o[28],o[28]=g-o[24],g=o[24]-o[16],o[24]=g,g=o[20]-g,o[20]=g,g=o[28]-g,o[28]=g,g=o[25]-o[17],o[25]=g,g=o[21]-g,o[21]=g,g=o[29]-g,o[29]=g,g=o[17]-o[1],o[17]=g,g=o[9]-g,o[9]=g,g=o[25]-g,o[25]=g,g=o[5]-g,o[5]=g,g=o[21]-g,o[21]=g,g=o[13]-g,o[13]=g,g=o[29]-g,o[29]=g,g=o[1]-o[0],o[1]=g,g=o[16]-g,o[16]=g,g=o[17]-g,o[17]=g,g=o[8]-g,o[8]=g,g=o[9]-g,o[9]=g,g=o[24]-g,o[24]=g,g=o[25]-g,o[25]=g,g=o[4]-g,o[4]=g,g=o[5]-g,o[5]=g,g=o[20]-g,o[20]=g,g=o[21]-g,o[21]=g,g=o[12]-g,o[12]=g,g=o[13]-g,o[13]=g,g=o[28]-g,o[28]=g,g=o[29]-g,o[29]=g,g=o[0],o[0]+=o[31],o[31]-=g,g=o[1],o[1]+=o[30],o[30]-=g,g=o[16],o[16]+=o[15],o[15]-=g,g=o[17],o[17]+=o[14],o[14]-=g,g=o[8],o[8]+=o[23],o[23]-=g,g=o[9],o[9]+=o[22],o[22]-=g,g=o[24],o[24]+=o[7],o[7]-=g,g=o[25],o[25]+=o[6],o[6]-=g,g=o[4],o[4]+=o[27],o[27]-=g,g=o[5],o[5]+=o[26],o[26]-=g,g=o[20],o[20]+=o[11],o[11]-=g,g=o[21],o[21]+=o[10],o[10]-=g,g=o[12],o[12]+=o[19],o[19]-=g,g=o[13],o[13]+=o[18],o[18]-=g,g=o[28],o[28]+=o[3],o[3]-=g,g=o[29],o[29]+=o[2],o[2]-=g}}function h(_,p){for(var o=0;o<3;o++){var j,O,I,v,E,L;v=_[p+2*3]*r[F.SHORT_TYPE][0]-_[p+5*3],j=_[p+0*3]*r[F.SHORT_TYPE][2]-_[p+3*3],O=v+j,I=v-j,v=_[p+5*3]*r[F.SHORT_TYPE][0]+_[p+2*3],j=_[p+3*3]*r[F.SHORT_TYPE][2]+_[p+0*3],E=v+j,L=-v+j,j=(_[p+1*3]*r[F.SHORT_TYPE][1]-_[p+4*3])*2069978111953089e-26,v=(_[p+4*3]*r[F.SHORT_TYPE][1]+_[p+1*3])*2069978111953089e-26,_[p+3*0]=O*190752519173728e-25+j,_[p+3*5]=-E*190752519173728e-25+v,I=I*.8660254037844387*1907525191737281e-26,E=E*.5*1907525191737281e-26+v,_[p+3*1]=I-E,_[p+3*2]=I+E,O=O*.5*1907525191737281e-26-j,L=L*.8660254037844387*1907525191737281e-26,_[p+3*3]=O+L,_[p+3*4]=O-L,p++}}function c(_,p,o){var j,O;{var I,v,E,L,T,R,g,A;I=o[17]-o[9],E=o[15]-o[11],L=o[14]-o[12],T=o[0]+o[8],R=o[1]+o[7],g=o[2]+o[6],A=o[3]+o[5],_[p+17]=T+g-A-(R-o[4]),O=(T+g-A)*i[12+7]+(R-o[4]),j=(I-E-L)*i[12+6],_[p+5]=j+O,_[p+6]=j-O,v=(o[16]-o[10])*i[12+6],R=R*i[12+7]+o[4],j=I*i[12+0]+v+E*i[12+1]+L*i[12+2],O=-T*i[12+4]+R-g*i[12+5]+A*i[12+3],_[p+1]=j+O,_[p+2]=j-O,j=I*i[12+1]-v-E*i[12+2]+L*i[12+0],O=-T*i[12+5]+R-g*i[12+3]+A*i[12+4],_[p+9]=j+O,_[p+10]=j-O,j=I*i[12+2]-v+E*i[12+0]-L*i[12+1],O=T*i[12+3]-R+g*i[12+4]-A*i[12+5],_[p+13]=j+O,_[p+14]=j-O}{var S,f,x,b,y,k,w,H;S=o[8]-o[0],x=o[6]-o[2],b=o[5]-o[3],y=o[17]+o[9],k=o[16]+o[10],w=o[15]+o[11],H=o[14]+o[12],_[p+0]=y+w+H+(k+o[13]),j=(y+w+H)*i[12+7]-(k+o[13]),O=(S-x+b)*i[12+6],_[p+11]=j+O,_[p+12]=j-O,f=(o[7]-o[1])*i[12+6],k=o[13]-k*i[12+7],j=y*i[12+3]-k+w*i[12+4]+H*i[12+5],O=S*i[12+2]+f+x*i[12+0]+b*i[12+1],_[p+3]=j+O,_[p+4]=j-O,j=-y*i[12+5]+k-w*i[12+3]-H*i[12+4],O=S*i[12+1]+f-x*i[12+2]-b*i[12+0],_[p+7]=j+O,_[p+8]=j-O,j=-y*i[12+4]+k-w*i[12+5]-H*i[12+3],O=S*i[12+0]-f+x*i[12+1]-b*i[12+2],_[p+15]=j+O,_[p+16]=j-O}}this.mdct_sub48=function(_,p,o){for(var j=p,O=286,I=0;I<_.channels_out;I++){for(var v=0;v<_.mode_gr;v++){for(var E,L=_.l3_side.tt[v][I],T=L.xr,R=0,g=_.sb_sample[I][1-v],A=0,S=0;S<18/2;S++)for(u(j,O,g[A]),u(j,O+32,g[A+1]),A+=2,O+=64,E=1;E<32;E+=2)g[A-1][E]*=-1;for(E=0;E<32;E++,R+=18){var f=L.block_type,x=_.sb_sample[I][v],b=_.sb_sample[I][1-v];if(L.mixed_block_flag!=0&&E<2&&(f=0),_.amp_filter[E]<1e-12)Ug.fill(T,R+0,R+18,0);else{if(_.amp_filter[E]<1)for(var S=0;S<18;S++)b[S][m[E]]*=_.amp_filter[E];if(f==F.SHORT_TYPE){for(var S=-t/4;S<0;S++){var y=r[F.SHORT_TYPE][S+3];T[R+S*3+9]=x[9+S][m[E]]*y-x[8-S][m[E]],T[R+S*3+18]=x[14-S][m[E]]*y+x[15+S][m[E]],T[R+S*3+10]=x[15+S][m[E]]*y-x[14-S][m[E]],T[R+S*3+19]=b[2-S][m[E]]*y+b[3+S][m[E]],T[R+S*3+11]=b[3+S][m[E]]*y-b[2-S][m[E]],T[R+S*3+20]=b[8-S][m[E]]*y+b[9+S][m[E]]}h(T,R)}else{for(var k=Vg(18),S=-n/4;S<0;S++){var w,H;w=r[f][S+27]*b[S+9][m[E]]+r[f][S+36]*b[8-S][m[E]],H=r[f][S+9]*x[S+9][m[E]]-r[f][S+18]*x[8-S][m[E]],k[S+9]=w-H*a[3+S+9],k[S+18]=w*a[3+S+9]+H}c(T,R,k)}}if(f!=F.SHORT_TYPE&&E!=0)for(var S=7;S>=0;--S){var Y,P;Y=T[R+S]*s[20+S]+T[R+-1-S]*l[28+S],P=T[R+S]*l[28+S]-T[R+-1-S]*s[20+S],T[R+-1-S]=Y,T[R+S]=P}}}if(j=o,O=286,_.mode_gr==1)for(var V=0;V<18;V++)zg.arraycopy(_.sb_sample[I][1][V],0,_.sb_sample[I][0][V],0,32)}}}var Xg=Ie.System,Yg=Ie.new_float,Kg=Ie.new_float_n;function ja(){this.l=Yg(F.SBMAX_l),this.s=Kg([F.SBMAX_s,3]);var e=this;this.assign=function(t){Xg.arraycopy(t.l,0,e.l,0,F.SBMAX_l);for(var n=0;n<F.SBMAX_s;n++)for(var r=0;r<3;r++)e.s[n][r]=t.s[n][r]}}function sr(){this.thm=new ja,this.en=new ja}function dt(e){var t=e;this.ordinal=function(){return t}}dt.STEREO=new dt(0),dt.JOINT_STEREO=new dt(1),dt.DUAL_CHANNEL=new dt(2),dt.MONO=new dt(3),dt.NOT_SET=new dt(4);var Eu=Ie.System,Na=Ie.VbrMode,Tu=Ie.new_array_n,Ru=Ie.new_float,Gg=Ie.new_float_n,Wg=Ie.new_int,Ha=Ie.assert;F.ENCDELAY=576,F.POSTDELAY=1152,F.MDCTDELAY=48,F.FFTOFFSET=224+F.MDCTDELAY,F.DECDELAY=528,F.SBLIMIT=32,F.CBANDS=64,F.SBPSY_l=21,F.SBPSY_s=12,F.SBMAX_l=22,F.SBMAX_s=13,F.PSFB21=6,F.PSFB12=6,F.BLKSIZE=1024,F.HBLKSIZE=F.BLKSIZE/2+1,F.BLKSIZE_s=256,F.HBLKSIZE_s=F.BLKSIZE_s/2+1,F.NORM_TYPE=0,F.START_TYPE=1,F.SHORT_TYPE=2,F.STOP_TYPE=3,F.MPG_MD_LR_LR=0,F.MPG_MD_LR_I=1,F.MPG_MD_MS_LR=2,F.MPG_MD_MS_I=3,F.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function F(){var e=F.FFTOFFSET,t=F.MPG_MD_MS_LR,n=null;this.psy=null;var r=null,a=null,i=null;this.setModules=function(h,c,_,p){n=h,this.psy=c,r=c,a=p,i=_};var s=new qg;function l(h){var c,_;if(h.ATH.useAdjust==0){h.ATH.adjust=1;return}if(_=h.loudness_sq[0][0],c=h.loudness_sq[1][0],h.channels_out==2?(_+=h.loudness_sq[0][1],c+=h.loudness_sq[1][1]):(_+=_,c+=c),h.mode_gr==2&&(_=Math.max(_,c)),_*=.5,_*=h.ATH.aaSensitivityP,_>.03125)h.ATH.adjust>=1?h.ATH.adjust=1:h.ATH.adjust<h.ATH.adjustLimit&&(h.ATH.adjust=h.ATH.adjustLimit),h.ATH.adjustLimit=1;else{var p=31.98*_+625e-6;h.ATH.adjust>=p?(h.ATH.adjust*=p*.075+.925,h.ATH.adjust<p&&(h.ATH.adjust=p)):h.ATH.adjustLimit>=p?h.ATH.adjust=p:h.ATH.adjust<h.ATH.adjustLimit&&(h.ATH.adjust=h.ATH.adjustLimit),h.ATH.adjustLimit=p}}function m(h){var c,_;for(Ha(h.bitrate_index>=0&&h.bitrate_index<16),Ha(h.mode_ext>=0&&h.mode_ext<4),h.bitrate_stereoMode_Hist[h.bitrate_index][4]++,h.bitrate_stereoMode_Hist[15][4]++,h.channels_out==2&&(h.bitrate_stereoMode_Hist[h.bitrate_index][h.mode_ext]++,h.bitrate_stereoMode_Hist[15][h.mode_ext]++),c=0;c<h.mode_gr;++c)for(_=0;_<h.channels_out;++_){var p=h.l3_side.tt[c][_].block_type|0;h.l3_side.tt[c][_].mixed_block_flag!=0&&(p=4),h.bitrate_blockType_Hist[h.bitrate_index][p]++,h.bitrate_blockType_Hist[h.bitrate_index][5]++,h.bitrate_blockType_Hist[15][p]++,h.bitrate_blockType_Hist[15][5]++}}function u(h,c){var _=h.internal_flags,p,o;if(_.lame_encode_frame_init==0){var j,O,I=Ru(2014),v=Ru(286+1152+576);for(_.lame_encode_frame_init=1,j=0,O=0;j<286+576*(1+_.mode_gr);++j)j<576*_.mode_gr?(I[j]=0,_.channels_out==2&&(v[j]=0)):(I[j]=c[0][O],_.channels_out==2&&(v[j]=c[1][O]),++O);for(o=0;o<_.mode_gr;o++)for(p=0;p<_.channels_out;p++)_.l3_side.tt[o][p].block_type=F.SHORT_TYPE;s.mdct_sub48(_,I,v),Ha(_.mf_size>=F.BLKSIZE+h.framesize-F.FFTOFFSET),Ha(_.mf_size>=512+h.framesize-32)}}this.lame_encode_mp3_frame=function(h,c,_,p,o,j){var O,I=Tu([2,2]);I[0][0]=new sr,I[0][1]=new sr,I[1][0]=new sr,I[1][1]=new sr;var v=Tu([2,2]);v[0][0]=new sr,v[0][1]=new sr,v[1][0]=new sr,v[1][1]=new sr;var E,L=[null,null],T=h.internal_flags,R=Gg([2,4]),g=[.5,.5],A=[[0,0],[0,0]],S=[[0,0],[0,0]],f,x,b;if(L[0]=c,L[1]=_,T.lame_encode_frame_init==0&&u(h,L),T.padding=0,(T.slot_lag-=T.frac_SpF)<0&&(T.slot_lag+=h.out_samplerate,T.padding=1),T.psymodel!=0){var y,k=[null,null],w=0,H=Wg(2);for(b=0;b<T.mode_gr;b++){for(x=0;x<T.channels_out;x++)k[x]=L[x],w=576+b*576-F.FFTOFFSET;if(h.VBR==Na.vbr_mtrh||h.VBR==Na.vbr_mt?y=r.L3psycho_anal_vbr(h,k,w,b,I,v,A[b],S[b],R[b],H):y=r.L3psycho_anal_ns(h,k,w,b,I,v,A[b],S[b],R[b],H),y!=0)return-4;for(h.mode==dt.JOINT_STEREO&&(g[b]=R[b][2]+R[b][3],g[b]>0&&(g[b]=R[b][3]/g[b])),x=0;x<T.channels_out;x++){var Y=T.l3_side.tt[b][x];Y.block_type=H[x],Y.mixed_block_flag=0}}}else for(b=0;b<T.mode_gr;b++)for(x=0;x<T.channels_out;x++)T.l3_side.tt[b][x].block_type=F.NORM_TYPE,T.l3_side.tt[b][x].mixed_block_flag=0,S[b][x]=A[b][x]=700;if(l(T),s.mdct_sub48(T,L[0],L[1]),T.mode_ext=F.MPG_MD_LR_LR,h.force_ms)T.mode_ext=F.MPG_MD_MS_LR;else if(h.mode==dt.JOINT_STEREO){var P=0,V=0;for(b=0;b<T.mode_gr;b++)for(x=0;x<T.channels_out;x++)P+=S[b][x],V+=A[b][x];if(P<=1*V){var d=T.l3_side.tt[0],M=T.l3_side.tt[T.mode_gr-1];d[0].block_type==d[1].block_type&&M[0].block_type==M[1].block_type&&(T.mode_ext=F.MPG_MD_MS_LR)}}if(T.mode_ext==t?(E=v,f=S):(E=I,f=A),h.analysis&&T.pinfo!=null)for(b=0;b<T.mode_gr;b++)for(x=0;x<T.channels_out;x++)T.pinfo.ms_ratio[b]=T.ms_ratio[b],T.pinfo.ms_ener_ratio[b]=g[b],T.pinfo.blocktype[b][x]=T.l3_side.tt[b][x].block_type,T.pinfo.pe[b][x]=f[b][x],Eu.arraycopy(T.l3_side.tt[b][x].xr,0,T.pinfo.xr[b][x],0,576),T.mode_ext==t&&(T.pinfo.ers[b][x]=T.pinfo.ers[b][x+2],Eu.arraycopy(T.pinfo.energy[b][x+2],0,T.pinfo.energy[b][x],0,T.pinfo.energy[b][x].length));if(h.VBR==Na.vbr_off||h.VBR==Na.vbr_abr){var W,C;for(W=0;W<18;W++)T.nsPsy.pefirbuf[W]=T.nsPsy.pefirbuf[W+1];for(C=0,b=0;b<T.mode_gr;b++)for(x=0;x<T.channels_out;x++)C+=f[b][x];for(T.nsPsy.pefirbuf[18]=C,C=T.nsPsy.pefirbuf[9],W=0;W<9;W++)C+=(T.nsPsy.pefirbuf[W]+T.nsPsy.pefirbuf[18-W])*F.fircoef[W];for(C=670*5*T.mode_gr*T.channels_out/C,b=0;b<T.mode_gr;b++)for(x=0;x<T.channels_out;x++)f[b][x]*=C}if(T.iteration_loop.iteration_loop(h,f,g,E),n.format_bitstream(h),O=n.copy_buffer(T,p,o,j,1),h.bWriteVbrTag&&a.addVbrFrame(h),h.analysis&&T.pinfo!=null){for(x=0;x<T.channels_out;x++){var fe;for(fe=0;fe<e;fe++)T.pinfo.pcmdata[x][fe]=T.pinfo.pcmdata[x][fe+h.framesize];for(fe=e;fe<1600;fe++)T.pinfo.pcmdata[x][fe]=L[x][fe-e]}i.set_frame_pinfo(h,E)}return m(T),O}}var Iu=Ie.Util,Cu=Ie.new_float;function Zg(){var e=Cu(F.BLKSIZE),t=Cu(F.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(i,s,l){var m=0,u,h,c;l<<=1;var _=s+l;u=4;do{var p,o,j,O,I,v,E;E=u>>1,O=u,I=u<<1,v=I+O,u=I<<1,h=s,c=h+E;do{var L,T,R,g;T=i[h+0]-i[h+O],L=i[h+0]+i[h+O],g=i[h+I]-i[h+v],R=i[h+I]+i[h+v],i[h+I]=L-R,i[h+0]=L+R,i[h+v]=T-g,i[h+O]=T+g,T=i[c+0]-i[c+O],L=i[c+0]+i[c+O],g=Iu.SQRT2*i[c+v],R=Iu.SQRT2*i[c+I],i[c+I]=L-R,i[c+0]=L+R,i[c+v]=T-g,i[c+O]=T+g,c+=u,h+=u}while(h<_);for(o=n[m+0],p=n[m+1],j=1;j<E;j++){var A,S;A=1-2*p*p,S=2*p*o,h=s+j,c=s+O-j;do{var f,x,b,L,T,y,R,k,g,w;x=S*i[h+O]-A*i[c+O],f=A*i[h+O]+S*i[c+O],T=i[h+0]-f,L=i[h+0]+f,y=i[c+0]-x,b=i[c+0]+x,x=S*i[h+v]-A*i[c+v],f=A*i[h+v]+S*i[c+v],g=i[h+I]-f,R=i[h+I]+f,w=i[c+I]-x,k=i[c+I]+x,x=p*R-o*w,f=o*R+p*w,i[h+I]=L-f,i[h+0]=L+f,i[c+v]=y-x,i[c+O]=y+x,x=o*k-p*g,f=p*k+o*g,i[c+I]=b-f,i[c+0]=b+f,i[h+v]=T-x,i[h+O]=T+x,c+=u,h+=u}while(h<_);A=o,o=A*n[m+0]-p*n[m+1],p=A*n[m+1]+p*n[m+0]}m+=2}while(u<l)}var a=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(i,s,l,m,u){for(var h=0;h<3;h++){var c=F.BLKSIZE_s/2,_=65535&576/3*(h+1),p=F.BLKSIZE_s/8-1;do{var o,j,O,I,v,E=a[p<<2]&255;o=t[E]*m[l][u+E+_],v=t[127-E]*m[l][u+E+_+128],j=o-v,o=o+v,O=t[E+64]*m[l][u+E+_+64],v=t[63-E]*m[l][u+E+_+192],I=O-v,O=O+v,c-=4,s[h][c+0]=o+O,s[h][c+2]=o-O,s[h][c+1]=j+I,s[h][c+3]=j-I,o=t[E+1]*m[l][u+E+_+1],v=t[126-E]*m[l][u+E+_+129],j=o-v,o=o+v,O=t[E+65]*m[l][u+E+_+65],v=t[62-E]*m[l][u+E+_+193],I=O-v,O=O+v,s[h][c+F.BLKSIZE_s/2+0]=o+O,s[h][c+F.BLKSIZE_s/2+2]=o-O,s[h][c+F.BLKSIZE_s/2+1]=j+I,s[h][c+F.BLKSIZE_s/2+3]=j-I}while(--p>=0);r(s[h],c,F.BLKSIZE_s/2)}},this.fft_long=function(i,s,l,m,u){var h=F.BLKSIZE/8-1,c=F.BLKSIZE/2;do{var _,p,o,j,O,I=a[h]&255;_=e[I]*m[l][u+I],O=e[I+512]*m[l][u+I+512],p=_-O,_=_+O,o=e[I+256]*m[l][u+I+256],O=e[I+768]*m[l][u+I+768],j=o-O,o=o+O,c-=4,s[c+0]=_+o,s[c+2]=_-o,s[c+1]=p+j,s[c+3]=p-j,_=e[I+1]*m[l][u+I+1],O=e[I+513]*m[l][u+I+513],p=_-O,_=_+O,o=e[I+257]*m[l][u+I+257],O=e[I+769]*m[l][u+I+769],j=o-O,o=o+O,s[c+F.BLKSIZE/2+0]=_+o,s[c+F.BLKSIZE/2+2]=_-o,s[c+F.BLKSIZE/2+1]=p+j,s[c+F.BLKSIZE/2+3]=p-j}while(--h>=0);r(s,c,F.BLKSIZE/2)},this.init_fft=function(i){for(var s=0;s<F.BLKSIZE;s++)e[s]=.42-.5*Math.cos(2*Math.PI*(s+.5)/F.BLKSIZE)+.08*Math.cos(4*Math.PI*(s+.5)/F.BLKSIZE);for(var s=0;s<F.BLKSIZE_s/2;s++)t[s]=.5*(1-Math.cos(2*Math.PI*(s+.5)/F.BLKSIZE_s))}}var Zr=Ie.VbrMode,Bu=Ie.Float,Qr=Ie.ShortBlock,Qt=Ie.Util,Qg=Ie.Arrays,Ot=Ie.new_float,fn=Ie.new_float_n,Ar=Ie.new_int,et=Ie.assert;function So(){var e=new Zg,t=2.302585092994046,n=2,r=16,a=2,i=16,s=.34,l=1/(14752*14752)/(F.BLKSIZE/2),m=.01,u=.8,h=.6,c=.3,_=3.5,p=21,o=.2302585093;function j(B){return B}function O(B,N){for(var U=0,q=0;q<F.BLKSIZE/2;++q)U+=B[q]*N.ATH.eql_w[q];return U*=l,U}function I(B,N,U,q,K,D,Z,$,G,oe,te){var le=B.internal_flags;if(G<2)e.fft_long(le,q[K],G,oe,te),e.fft_short(le,D[Z],G,oe,te);else if(G==2){for(var J=F.BLKSIZE-1;J>=0;--J){var ve=q[K+0][J],me=q[K+1][J];q[K+0][J]=(ve+me)*Qt.SQRT2*.5,q[K+1][J]=(ve-me)*Qt.SQRT2*.5}for(var De=2;De>=0;--De)for(var J=F.BLKSIZE_s-1;J>=0;--J){var ve=D[Z+0][De][J],me=D[Z+1][De][J];D[Z+0][De][J]=(ve+me)*Qt.SQRT2*.5,D[Z+1][De][J]=(ve-me)*Qt.SQRT2*.5}}N[0]=q[K+0][0],N[0]*=N[0];for(var J=F.BLKSIZE/2-1;J>=0;--J){var re=q[K+0][F.BLKSIZE/2-J],Le=q[K+0][F.BLKSIZE/2+J];N[F.BLKSIZE/2-J]=(re*re+Le*Le)*.5}for(var De=2;De>=0;--De){U[De][0]=D[Z+0][De][0],U[De][0]*=U[De][0];for(var J=F.BLKSIZE_s/2-1;J>=0;--J){var re=D[Z+0][De][F.BLKSIZE_s/2-J],Le=D[Z+0][De][F.BLKSIZE_s/2+J];U[De][F.BLKSIZE_s/2-J]=(re*re+Le*Le)*.5}}{for(var Xe=0,J=11;J<F.HBLKSIZE;J++)Xe+=N[J];le.tot_ener[G]=Xe}if(B.analysis){for(var J=0;J<F.HBLKSIZE;J++)le.pinfo.energy[$][G][J]=le.pinfo.energy_save[G][J],le.pinfo.energy_save[G][J]=N[J];le.pinfo.pe[$][G]=le.pe[G]}B.athaa_loudapprox==2&&G<2&&(le.loudness_sq[$][G]=le.loudness_sq_save[G],le.loudness_sq_save[G]=O(N,le))}var v=8,E=23,L=15,T,R,g,A=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){T=Math.pow(10,(v+1)/16),R=Math.pow(10,(E+1)/16),g=Math.pow(10,L/10)}var f=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],x=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],b=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function y(B,N,U,q,K,D){var Z;if(N>B)if(N<B*R)Z=N/B;else return B+N;else{if(B>=N*R)return B+N;Z=B/N}if(B+=N,q+3<=3+3){if(Z>=T)return B;var $=0|Qt.FAST_LOG10_X(Z,16);return B*x[$]}var $=0|Qt.FAST_LOG10_X(Z,16);if(D!=0?N=K.ATH.cb_s[U]*K.ATH.adjust:N=K.ATH.cb_l[U]*K.ATH.adjust,B<g*N){if(B>N){var G,oe;return G=1,$<=13&&(G=b[$]),oe=Qt.FAST_LOG10_X(B/N,10/15),B*((f[$]-G)*oe+G)}return $>13?B:B*b[$]}return B*f[$]}var k=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function w(B,N,U){var q;if(B<0&&(B=0),N<0&&(N=0),B<=0)return N;if(N<=0)return B;if(N>B?q=N/B:q=B/N,U>=-2&&U<=2){if(q>=T)return B+N;var K=0|Qt.FAST_LOG10_X(q,16);return(B+N)*k[K]}return q<R?B+N:(B<N&&(B=N),B)}function H(B,N){var U=B.internal_flags;if(U.channels_out>1){for(var q=0;q<F.SBMAX_l;q++){var K=U.thm[0].l[q],D=U.thm[1].l[q];U.thm[0].l[q]+=D*N,U.thm[1].l[q]+=K*N}for(var q=0;q<F.SBMAX_s;q++)for(var Z=0;Z<3;Z++){var K=U.thm[0].s[q][Z],D=U.thm[1].s[q][Z];U.thm[0].s[q][Z]+=D*N,U.thm[1].s[q][Z]+=K*N}}}function Y(B){for(var N=0;N<F.SBMAX_l;N++)if(!(B.thm[0].l[N]>1.58*B.thm[1].l[N]||B.thm[1].l[N]>1.58*B.thm[0].l[N])){var U=B.mld_l[N]*B.en[3].l[N],q=Math.max(B.thm[2].l[N],Math.min(B.thm[3].l[N],U));U=B.mld_l[N]*B.en[2].l[N];var K=Math.max(B.thm[3].l[N],Math.min(B.thm[2].l[N],U));B.thm[2].l[N]=q,B.thm[3].l[N]=K}for(var N=0;N<F.SBMAX_s;N++)for(var D=0;D<3;D++)if(!(B.thm[0].s[N][D]>1.58*B.thm[1].s[N][D]||B.thm[1].s[N][D]>1.58*B.thm[0].s[N][D])){var U=B.mld_s[N]*B.en[3].s[N][D],q=Math.max(B.thm[2].s[N][D],Math.min(B.thm[3].s[N][D],U));U=B.mld_s[N]*B.en[2].s[N][D];var K=Math.max(B.thm[3].s[N][D],Math.min(B.thm[2].s[N][D],U));B.thm[2].s[N][D]=q,B.thm[3].s[N][D]=K}}function P(B,N,U){var q=N,K=Math.pow(10,U);N*=2,q*=2;for(var D=0;D<F.SBMAX_l;D++){var Z,$,G,oe;if(oe=B.ATH.cb_l[B.bm_l[D]]*K,Z=Math.min(Math.max(B.thm[0].l[D],oe),Math.max(B.thm[1].l[D],oe)),$=Math.max(B.thm[2].l[D],oe),G=Math.max(B.thm[3].l[D],oe),Z*N<$+G){var te=Z*q/($+G);$*=te,G*=te}B.thm[2].l[D]=Math.min($,B.thm[2].l[D]),B.thm[3].l[D]=Math.min(G,B.thm[3].l[D])}K*=F.BLKSIZE_s/F.BLKSIZE;for(var D=0;D<F.SBMAX_s;D++)for(var le=0;le<3;le++){var Z,$,G,oe;if(oe=B.ATH.cb_s[B.bm_s[D]]*K,Z=Math.min(Math.max(B.thm[0].s[D][le],oe),Math.max(B.thm[1].s[D][le],oe)),$=Math.max(B.thm[2].s[D][le],oe),G=Math.max(B.thm[3].s[D][le],oe),Z*N<$+G){var te=Z*N/($+G);$*=te,G*=te}B.thm[2].s[D][le]=Math.min(B.thm[2].s[D][le],$),B.thm[3].s[D][le]=Math.min(B.thm[3].s[D][le],G)}}function V(B,N,U,q,K){var D,Z,$=0,G=0;for(D=Z=0;D<F.SBMAX_s;++Z,++D){for(var oe=B.bo_s[D],te=B.npart_s,le=oe<te?oe:te;Z<le;)et(N[Z]>=0),et(U[Z]>=0),$+=N[Z],G+=U[Z],Z++;if(B.en[q].s[D][K]=$,B.thm[q].s[D][K]=G,Z>=te){++D;break}et(N[Z]>=0),et(U[Z]>=0);{var J=B.PSY.bo_s_weight[D],ve=1-J;$=J*N[Z],G=J*U[Z],B.en[q].s[D][K]+=$,B.thm[q].s[D][K]+=G,$=ve*N[Z],G=ve*U[Z]}}for(;D<F.SBMAX_s;++D)B.en[q].s[D][K]=0,B.thm[q].s[D][K]=0}function d(B,N,U,q){var K,D,Z=0,$=0;for(K=D=0;K<F.SBMAX_l;++D,++K){for(var G=B.bo_l[K],oe=B.npart_l,te=G<oe?G:oe;D<te;)et(N[D]>=0),et(U[D]>=0),Z+=N[D],$+=U[D],D++;if(B.en[q].l[K]=Z,B.thm[q].l[K]=$,D>=oe){++K;break}et(N[D]>=0),et(U[D]>=0);{var le=B.PSY.bo_l_weight[K],J=1-le;Z=le*N[D],$=le*U[D],B.en[q].l[K]+=Z,B.thm[q].l[K]+=$,Z=J*N[D],$=J*U[D]}}for(;K<F.SBMAX_l;++K)B.en[q].l[K]=0,B.thm[q].l[K]=0}function M(B,N,U,q,K,D){var Z=B.internal_flags,$,G;for(G=$=0;G<Z.npart_s;++G){for(var oe=0,te=Z.numlines_s[G],le=0;le<te;++le,++$){var J=N[D][$];oe+=J}U[G]=oe}for(et(G==Z.npart_s),$=G=0;G<Z.npart_s;G++){var ve=Z.s3ind_s[G][0],me=Z.s3_ss[$++]*U[ve];for(++ve;ve<=Z.s3ind_s[G][1];)me+=Z.s3_ss[$]*U[ve],++$,++ve;{var De=a*Z.nb_s1[K][G];q[G]=Math.min(me,De)}if(Z.blocktype_old[K&1]==F.SHORT_TYPE){var De=i*Z.nb_s2[K][G],re=q[G];q[G]=Math.min(De,re)}Z.nb_s2[K][G]=Z.nb_s1[K][G],Z.nb_s1[K][G]=me,et(q[G]>=0)}for(;G<=F.CBANDS;++G)U[G]=0,q[G]=0}function W(B,N,U,q){var K=B.internal_flags;B.short_blocks==Qr.short_block_coupled&&!(N[0]!=0&&N[1]!=0)&&(N[0]=N[1]=0);for(var D=0;D<K.channels_out;D++)q[D]=F.NORM_TYPE,B.short_blocks==Qr.short_block_dispensed&&(N[D]=1),B.short_blocks==Qr.short_block_forced&&(N[D]=0),N[D]!=0?(et(K.blocktype_old[D]!=F.START_TYPE),K.blocktype_old[D]==F.SHORT_TYPE&&(q[D]=F.STOP_TYPE)):(q[D]=F.SHORT_TYPE,K.blocktype_old[D]==F.NORM_TYPE&&(K.blocktype_old[D]=F.START_TYPE),K.blocktype_old[D]==F.STOP_TYPE&&(K.blocktype_old[D]=F.SHORT_TYPE)),U[D]=K.blocktype_old[D],K.blocktype_old[D]=q[D]}function C(B,N,U){return U>=1?B:U<=0?N:N>0?Math.pow(B/N,U)*N:0}var fe=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Se(B,N){for(var U=309.07,q=0;q<F.SBMAX_s-1;q++)for(var K=0;K<3;K++){var D=B.thm.s[q][K];if(D>0){var Z=D*N,$=B.en.s[q][K];$>Z&&($>Z*1e10?U+=fe[q]*(10*t):U+=fe[q]*Qt.FAST_LOG10($/Z))}}return U}var ge=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function _e(B,N){for(var U=281.0575,q=0;q<F.SBMAX_l-1;q++){var K=B.thm.l[q];if(K>0){var D=K*N,Z=B.en.l[q];Z>D&&(Z>D*1e10?U+=ge[q]*(10*t):U+=ge[q]*Qt.FAST_LOG10(Z/D))}}return U}function He(B,N,U,q,K){var D,Z;for(D=Z=0;D<B.npart_l;++D){var $=0,G=0,oe;for(oe=0;oe<B.numlines_l[D];++oe,++Z){var te=N[Z];$+=te,G<te&&(G=te)}U[D]=$,q[D]=G,K[D]=$*B.rnumlines_l[D],et(B.rnumlines_l[D]>=0),et(U[D]>=0),et(q[D]>=0),et(K[D]>=0)}}function Re(B,N,U,q){var K=A.length-1,D=0,Z=U[D]+U[D+1];if(Z>0){var $=N[D];$<N[D+1]&&($=N[D+1]),et(B.numlines_l[D]+B.numlines_l[D+1]-1>0),Z=20*($*2-Z)/(Z*(B.numlines_l[D]+B.numlines_l[D+1]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;for(D=1;D<B.npart_l-1;D++)if(Z=U[D-1]+U[D]+U[D+1],Z>0){var $=N[D-1];$<N[D]&&($=N[D]),$<N[D+1]&&($=N[D+1]),et(B.numlines_l[D-1]+B.numlines_l[D]+B.numlines_l[D+1]-1>0),Z=20*($*3-Z)/(Z*(B.numlines_l[D-1]+B.numlines_l[D]+B.numlines_l[D+1]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;if(et(D==B.npart_l-1),Z=U[D-1]+U[D],Z>0){var $=N[D-1];$<N[D]&&($=N[D]),et(B.numlines_l[D-1]+B.numlines_l[D]-1>0),Z=20*($*2-Z)/(Z*(B.numlines_l[D-1]+B.numlines_l[D]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;et(D==B.npart_l-1)}var pe=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(B,N,U,q,K,D,Z,$,G,oe){var te=B.internal_flags,le=fn([2,F.BLKSIZE]),J=fn([2,3,F.BLKSIZE_s]),ve=Ot(F.CBANDS+1),me=Ot(F.CBANDS+1),De=Ot(F.CBANDS+2),re=Ar(2),Le=Ar(2),Xe,xe,Ne,ye,qe,Mt,Fe,Ze,nt=fn([2,576]),At,on=Ar(F.CBANDS+2),Bt=Ar(F.CBANDS+2);for(Qg.fill(Bt,0),Xe=te.channels_out,B.mode==dt.JOINT_STEREO&&(Xe=4),B.VBR==Zr.vbr_off?At=te.ResvMax==0?0:te.ResvSize/te.ResvMax*.5:B.VBR==Zr.vbr_rh||B.VBR==Zr.vbr_mtrh||B.VBR==Zr.vbr_mt?At=.6:At=1,xe=0;xe<te.channels_out;xe++){var Et=N[xe],$t=U+576-350-p+192;for(ye=0;ye<576;ye++){var ln,cn;for(ln=Et[$t+ye+10],cn=0,qe=0;qe<(p-1)/2-1;qe+=2)ln+=pe[qe]*(Et[$t+ye+qe]+Et[$t+ye+p-qe]),cn+=pe[qe+1]*(Et[$t+ye+qe+1]+Et[$t+ye+p-qe-1]);nt[xe][ye]=ln+cn}K[q][xe].en.assign(te.en[xe]),K[q][xe].thm.assign(te.thm[xe]),Xe>2&&(D[q][xe].en.assign(te.en[xe+2]),D[q][xe].thm.assign(te.thm[xe+2]))}for(xe=0;xe<Xe;xe++){var wn,kn,Vt=Ot(12),Nn=[0,0,0,0],ei=Ot(12),Lo=1,Zu,Qu=Ot(F.CBANDS),Ju=Ot(F.CBANDS),Tt=[0,0,0,0],$u=Ot(F.HBLKSIZE),e1=fn([3,F.HBLKSIZE_s]);for(et(te.npart_s<=F.CBANDS),et(te.npart_l<=F.CBANDS),ye=0;ye<3;ye++)Vt[ye]=te.nsPsy.last_en_subshort[xe][ye+6],et(te.nsPsy.last_en_subshort[xe][ye+4]>0),ei[ye]=Vt[ye]/te.nsPsy.last_en_subshort[xe][ye+4],Nn[0]+=Vt[ye];if(xe==2)for(ye=0;ye<576;ye++){var Fo,jo;Fo=nt[0][ye],jo=nt[1][ye],nt[0][ye]=Fo+jo,nt[1][ye]=Fo-jo}{var t1=nt[xe&1],Hi=0;for(ye=0;ye<9;ye++){for(var zb=Hi+64,Nt=1;Hi<zb;Hi++)Nt<Math.abs(t1[Hi])&&(Nt=Math.abs(t1[Hi]));te.nsPsy.last_en_subshort[xe][ye]=Vt[ye+3]=Nt,Nn[1+ye/3]+=Nt,Nt>Vt[ye+3-2]?(et(Vt[ye+3-2]>0),Nt=Nt/Vt[ye+3-2]):Vt[ye+3-2]>Nt*10?Nt=Vt[ye+3-2]/(Nt*10):Nt=0,ei[ye+3]=Nt}}if(B.analysis){var No=ei[0];for(ye=1;ye<12;ye++)No<ei[ye]&&(No=ei[ye]);te.pinfo.ers[q][xe]=te.pinfo.ers_save[xe],te.pinfo.ers_save[xe]=No}for(Zu=xe==3?te.nsPsy.attackthre_s:te.nsPsy.attackthre,ye=0;ye<12;ye++)Tt[ye/3]==0&&ei[ye]>Zu&&(Tt[ye/3]=ye%3+1);for(ye=1;ye<4;ye++){var Ho;Nn[ye-1]>Nn[ye]?(et(Nn[ye]>0),Ho=Nn[ye-1]/Nn[ye]):(et(Nn[ye-1]>0),Ho=Nn[ye]/Nn[ye-1]),Ho<1.7&&(Tt[ye]=0,ye==1&&(Tt[0]=0))}for(Tt[0]!=0&&te.nsPsy.lastAttacks[xe]!=0&&(Tt[0]=0),(te.nsPsy.lastAttacks[xe]==3||Tt[0]+Tt[1]+Tt[2]+Tt[3]!=0)&&(Lo=0,Tt[1]!=0&&Tt[0]!=0&&(Tt[1]=0),Tt[2]!=0&&Tt[1]!=0&&(Tt[2]=0),Tt[3]!=0&&Tt[2]!=0&&(Tt[3]=0)),xe<2?Le[xe]=Lo:Lo==0&&(Le[0]=Le[1]=0),G[xe]=te.tot_ener[xe],kn=J,wn=le,I(B,$u,e1,wn,xe&1,kn,xe&1,q,xe,N,U),He(te,$u,ve,Qu,Ju),Re(te,Qu,Ju,on),Ze=0;Ze<3;Ze++){var Do,en;for(M(B,e1,me,De,xe,Ze),V(te,me,De,xe,Ze),Fe=0;Fe<F.SBMAX_s;Fe++){if(en=te.thm[xe].s[Fe][Ze],en*=u,Tt[Ze]>=2||Tt[Ze+1]==1){var Di=Ze!=0?Ze-1:2,Nt=C(te.thm[xe].s[Fe][Di],en,h*At);en=Math.min(en,Nt)}if(Tt[Ze]==1){var Di=Ze!=0?Ze-1:2,Nt=C(te.thm[xe].s[Fe][Di],en,c*At);en=Math.min(en,Nt)}else if(Ze!=0&&Tt[Ze-1]==3||Ze==0&&te.nsPsy.lastAttacks[xe]==3){var Di=Ze!=2?Ze+1:0,Nt=C(te.thm[xe].s[Fe][Di],en,c*At);en=Math.min(en,Nt)}Do=Vt[Ze*3+3]+Vt[Ze*3+4]+Vt[Ze*3+5],Vt[Ze*3+5]*6<Do&&(en*=.5,Vt[Ze*3+4]*6<Do&&(en*=.5)),te.thm[xe].s[Fe][Ze]=en}}for(te.nsPsy.lastAttacks[xe]=Tt[2],Mt=0,Ne=0;Ne<te.npart_l;Ne++){for(var Or=te.s3ind[Ne][0],Po=ve[Or]*A[on[Or]],Lr=te.s3_ll[Mt++]*Po;++Or<=te.s3ind[Ne][1];)Po=ve[Or]*A[on[Or]],Lr=y(Lr,te.s3_ll[Mt++]*Po,Or,Or-Ne,te,0);Lr*=.158489319246111,te.blocktype_old[xe&1]==F.SHORT_TYPE?De[Ne]=Lr:De[Ne]=C(Math.min(Lr,Math.min(n*te.nb_1[xe][Ne],r*te.nb_2[xe][Ne])),Lr,At),te.nb_2[xe][Ne]=te.nb_1[xe][Ne],te.nb_1[xe][Ne]=Lr}for(;Ne<=F.CBANDS;++Ne)ve[Ne]=0,De[Ne]=0;d(te,ve,De,xe)}if((B.mode==dt.STEREO||B.mode==dt.JOINT_STEREO)&&B.interChRatio>0&&H(B,B.interChRatio),B.mode==dt.JOINT_STEREO){var zo;Y(te),zo=B.msfix,Math.abs(zo)>0&&P(te,zo,B.ATHlower*te.ATH.adjust)}for(W(B,Le,oe,re),xe=0;xe<Xe;xe++){var Pi,zi=0,Ya,Ka;xe>1?(Pi=$,zi=-2,Ya=F.NORM_TYPE,(oe[0]==F.SHORT_TYPE||oe[1]==F.SHORT_TYPE)&&(Ya=F.SHORT_TYPE),Ka=D[q][xe-2]):(Pi=Z,zi=0,Ya=oe[xe],Ka=K[q][xe]),Ya==F.SHORT_TYPE?Pi[zi+xe]=Se(Ka,te.masking_lower):Pi[zi+xe]=_e(Ka,te.masking_lower),B.analysis&&(te.pinfo.pe[q][xe]=Pi[zi+xe])}return 0};function Ve(B,N,U,q,K,D,Z,$){var G=B.internal_flags;if(q<2)e.fft_long(G,Z[$],q,N,U);else if(q==2)for(var oe=F.BLKSIZE-1;oe>=0;--oe){var te=Z[$+0][oe],le=Z[$+1][oe];Z[$+0][oe]=(te+le)*Qt.SQRT2*.5,Z[$+1][oe]=(te-le)*Qt.SQRT2*.5}D[0]=Z[$+0][0],D[0]*=D[0];for(var oe=F.BLKSIZE/2-1;oe>=0;--oe){var J=Z[$+0][F.BLKSIZE/2-oe],ve=Z[$+0][F.BLKSIZE/2+oe];D[F.BLKSIZE/2-oe]=(J*J+ve*ve)*.5}{for(var me=0,oe=11;oe<F.HBLKSIZE;oe++)me+=D[oe];G.tot_ener[q]=me}if(B.analysis){for(var oe=0;oe<F.HBLKSIZE;oe++)G.pinfo.energy[K][q][oe]=G.pinfo.energy_save[q][oe],G.pinfo.energy_save[q][oe]=D[oe];G.pinfo.pe[K][q]=G.pe[q]}}function rt(B,N,U,q,K,D,Z,$){var G=B.internal_flags;if(K==0&&q<2&&e.fft_short(G,Z[$],q,N,U),q==2)for(var oe=F.BLKSIZE_s-1;oe>=0;--oe){var te=Z[$+0][K][oe],le=Z[$+1][K][oe];Z[$+0][K][oe]=(te+le)*Qt.SQRT2*.5,Z[$+1][K][oe]=(te-le)*Qt.SQRT2*.5}D[K][0]=Z[$+0][K][0],D[K][0]*=D[K][0];for(var oe=F.BLKSIZE_s/2-1;oe>=0;--oe){var J=Z[$+0][K][F.BLKSIZE_s/2-oe],ve=Z[$+0][K][F.BLKSIZE_s/2+oe];D[K][F.BLKSIZE_s/2-oe]=(J*J+ve*ve)*.5}}function z(B,N,U,q){var K=B.internal_flags;B.athaa_loudapprox==2&&U<2&&(K.loudness_sq[N][U]=K.loudness_sq_save[U],K.loudness_sq_save[U]=O(q,K))}var X=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function ne(B,N,U,q,K,D,Z,$,G,oe){for(var te=fn([2,576]),le=B.internal_flags,J=le.channels_out,ve=B.mode==dt.JOINT_STEREO?4:J,me=0;me<J;me++){firbuf=N[me];for(var De=U+576-350-p+192,re=0;re<576;re++){var Le,Xe;Le=firbuf[De+re+10],Xe=0;for(var xe=0;xe<(p-1)/2-1;xe+=2)Le+=X[xe]*(firbuf[De+re+xe]+firbuf[De+re+p-xe]),Xe+=X[xe+1]*(firbuf[De+re+xe+1]+firbuf[De+re+p-xe-1]);te[me][re]=Le+Xe}K[q][me].en.assign(le.en[me]),K[q][me].thm.assign(le.thm[me]),ve>2&&(D[q][me].en.assign(le.en[me+2]),D[q][me].thm.assign(le.thm[me+2]))}for(var me=0;me<ve;me++){var Ne=Ot(12),ye=Ot(12),qe=[0,0,0,0],Mt=te[me&1],Fe=0,Ze=me==3?le.nsPsy.attackthre_s:le.nsPsy.attackthre,nt=1;if(me==2)for(var re=0,xe=576;xe>0;++re,--xe){var At=te[0][re],on=te[1][re];te[0][re]=At+on,te[1][re]=At-on}for(var re=0;re<3;re++)ye[re]=le.nsPsy.last_en_subshort[me][re+6],et(le.nsPsy.last_en_subshort[me][re+4]>0),Ne[re]=ye[re]/le.nsPsy.last_en_subshort[me][re+4],qe[0]+=ye[re];for(var re=0;re<9;re++){for(var Bt=Fe+64,Et=1;Fe<Bt;Fe++)Et<Math.abs(Mt[Fe])&&(Et=Math.abs(Mt[Fe]));le.nsPsy.last_en_subshort[me][re]=ye[re+3]=Et,qe[1+re/3]+=Et,Et>ye[re+3-2]?(et(ye[re+3-2]>0),Et=Et/ye[re+3-2]):ye[re+3-2]>Et*10?Et=ye[re+3-2]/(Et*10):Et=0,Ne[re+3]=Et}for(var re=0;re<3;++re){var $t=ye[re*3+3]+ye[re*3+4]+ye[re*3+5],ln=1;ye[re*3+5]*6<$t&&(ln*=.5,ye[re*3+4]*6<$t&&(ln*=.5)),$[me][re]=ln}if(B.analysis){for(var cn=Ne[0],re=1;re<12;re++)cn<Ne[re]&&(cn=Ne[re]);le.pinfo.ers[q][me]=le.pinfo.ers_save[me],le.pinfo.ers_save[me]=cn}for(var re=0;re<12;re++)G[me][re/3]==0&&Ne[re]>Ze&&(G[me][re/3]=re%3+1);for(var re=1;re<4;re++){var wn=qe[re-1],kn=qe[re],Vt=Math.max(wn,kn);Vt<4e4&&wn<1.7*kn&&kn<1.7*wn&&(re==1&&G[me][0]<=G[me][re]&&(G[me][0]=0),G[me][re]=0)}G[me][0]<=le.nsPsy.lastAttacks[me]&&(G[me][0]=0),(le.nsPsy.lastAttacks[me]==3||G[me][0]+G[me][1]+G[me][2]+G[me][3]!=0)&&(nt=0,G[me][1]!=0&&G[me][0]!=0&&(G[me][1]=0),G[me][2]!=0&&G[me][1]!=0&&(G[me][2]=0),G[me][3]!=0&&G[me][2]!=0&&(G[me][3]=0)),me<2?oe[me]=nt:nt==0&&(oe[0]=oe[1]=0),Z[me]=le.tot_ener[me]}}function ce(B,N,U){if(U==0)for(var q=0;q<B.npart_s;q++)B.nb_s2[N][q]=B.nb_s1[N][q],B.nb_s1[N][q]=0}function de(B,N){for(var U=0;U<B.npart_l;U++)B.nb_2[N][U]=B.nb_1[N][U],B.nb_1[N][U]=0}function Me(B,N,U,q){var K=A.length-1,D=0,Z=U[D]+U[D+1];if(Z>0){var $=N[D];$<N[D+1]&&($=N[D+1]),et(B.numlines_s[D]+B.numlines_s[D+1]-1>0),Z=20*($*2-Z)/(Z*(B.numlines_s[D]+B.numlines_s[D+1]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;for(D=1;D<B.npart_s-1;D++)if(Z=U[D-1]+U[D]+U[D+1],et(D+1<B.npart_s),Z>0){var $=N[D-1];$<N[D]&&($=N[D]),$<N[D+1]&&($=N[D+1]),et(B.numlines_s[D-1]+B.numlines_s[D]+B.numlines_s[D+1]-1>0),Z=20*($*3-Z)/(Z*(B.numlines_s[D-1]+B.numlines_s[D]+B.numlines_s[D+1]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;if(et(D==B.npart_s-1),Z=U[D-1]+U[D],Z>0){var $=N[D-1];$<N[D]&&($=N[D]),et(B.numlines_s[D-1]+B.numlines_s[D]-1>0),Z=20*($*2-Z)/(Z*(B.numlines_s[D-1]+B.numlines_s[D]-1));var G=0|Z;G>K&&(G=K),q[D]=G}else q[D]=0;et(D==B.npart_s-1)}function Ee(B,N,U,q,K,D){var Z=B.internal_flags,$=new float[F.CBANDS],G=Ot(F.CBANDS),oe,te,le,J=new int[F.CBANDS];for(le=te=0;le<Z.npart_s;++le){var ve=0,me=0,De=Z.numlines_s[le];for(oe=0;oe<De;++oe,++te){var re=N[D][te];ve+=re,me<re&&(me=re)}U[le]=ve,$[le]=me,G[le]=ve/De,et(G[le]>=0)}for(et(le==Z.npart_s);le<F.CBANDS;++le)$[le]=0,G[le]=0;for(Me(Z,$,G,J),te=le=0;le<Z.npart_s;le++){var Le=Z.s3ind_s[le][0],Xe=Z.s3ind_s[le][1],xe,Ne,ye,qe,Mt;for(xe=J[Le],Ne=1,qe=Z.s3_ss[te]*U[Le]*A[J[Le]],++te,++Le;Le<=Xe;)xe+=J[Le],Ne+=1,ye=Z.s3_ss[te]*U[Le]*A[J[Le]],qe=w(qe,ye,Le-le),++te,++Le;xe=(1+2*xe)/(2*Ne),Mt=A[xe]*.5,qe*=Mt,q[le]=qe,Z.nb_s2[K][le]=Z.nb_s1[K][le],Z.nb_s1[K][le]=qe,ye=$[le],ye*=Z.minval_s[le],ye*=Mt,q[le]>ye&&(q[le]=ye),Z.masking_lower>1&&(q[le]*=Z.masking_lower),q[le]>U[le]&&(q[le]=U[le]),Z.masking_lower<1&&(q[le]*=Z.masking_lower),et(q[le]>=0)}for(;le<F.CBANDS;++le)U[le]=0,q[le]=0}function we(B,N,U,q,K){var D=Ot(F.CBANDS),Z=Ot(F.CBANDS),$=Ar(F.CBANDS+2),G;He(B,N,U,D,Z),Re(B,D,Z,$);var oe=0;for(G=0;G<B.npart_l;G++){var te,le,J,ve,me=B.s3ind[G][0],De=B.s3ind[G][1],re=0,Le=0;for(re=$[me],Le+=1,le=B.s3_ll[oe]*U[me]*A[$[me]],++oe,++me;me<=De;)re+=$[me],Le+=1,te=B.s3_ll[oe]*U[me]*A[$[me]],ve=w(le,te,me-G),le=ve,++oe,++me;if(re=(1+2*re)/(2*Le),J=A[re]*.5,le*=J,B.blocktype_old[K&1]==F.SHORT_TYPE){var Xe=n*B.nb_1[K][G];Xe>0?q[G]=Math.min(le,Xe):q[G]=Math.min(le,U[G]*c)}else{var xe=r*B.nb_2[K][G],Ne=n*B.nb_1[K][G],Xe;xe<=0&&(xe=le),Ne<=0&&(Ne=le),B.blocktype_old[K&1]==F.NORM_TYPE?Xe=Math.min(Ne,xe):Xe=Ne,q[G]=Math.min(le,Xe)}B.nb_2[K][G]=B.nb_1[K][G],B.nb_1[K][G]=le,te=D[G],te*=B.minval_l[G],te*=J,q[G]>te&&(q[G]=te),B.masking_lower>1&&(q[G]*=B.masking_lower),q[G]>U[G]&&(q[G]=U[G]),B.masking_lower<1&&(q[G]*=B.masking_lower),et(q[G]>=0)}for(;G<F.CBANDS;++G)U[G]=0,q[G]=0}function Ae(B,N){var U=B.internal_flags;B.short_blocks==Qr.short_block_coupled&&!(N[0]!=0&&N[1]!=0)&&(N[0]=N[1]=0);for(var q=0;q<U.channels_out;q++)B.short_blocks==Qr.short_block_dispensed&&(N[q]=1),B.short_blocks==Qr.short_block_forced&&(N[q]=0)}function be(B,N,U){for(var q=B.internal_flags,K=0;K<q.channels_out;K++){var D=F.NORM_TYPE;N[K]!=0?(et(q.blocktype_old[K]!=F.START_TYPE),q.blocktype_old[K]==F.SHORT_TYPE&&(D=F.STOP_TYPE)):(D=F.SHORT_TYPE,q.blocktype_old[K]==F.NORM_TYPE&&(q.blocktype_old[K]=F.START_TYPE),q.blocktype_old[K]==F.STOP_TYPE&&(q.blocktype_old[K]=F.SHORT_TYPE)),U[K]=q.blocktype_old[K],q.blocktype_old[K]=D}}function Pe(B,N,U,q,K,D,Z){for(var $=D*2,G=D>0?Math.pow(10,K):1,oe,te,le=0;le<Z;++le){var J=B[2][le],ve=B[3][le],me=N[0][le],De=N[1][le],re=N[2][le],Le=N[3][le];if(me<=1.58*De&&De<=1.58*me){var Xe=U[le]*ve,xe=U[le]*J;te=Math.max(re,Math.min(Le,Xe)),oe=Math.max(Le,Math.min(re,xe))}else te=re,oe=Le;if(D>0){var Ne,ye,qe=q[le]*G;if(Ne=Math.min(Math.max(me,qe),Math.max(De,qe)),re=Math.max(te,qe),Le=Math.max(oe,qe),ye=re+Le,ye>0&&Ne*$<ye){var Mt=Ne*$/ye;re*=Mt,Le*=Mt}te=Math.min(re,te),oe=Math.min(Le,oe)}te>J&&(te=J),oe>ve&&(oe=ve),N[2][le]=te,N[3][le]=oe}}this.L3psycho_anal_vbr=function(B,N,U,q,K,D,Z,$,G,oe){var te=B.internal_flags,le,J,ve=Ot(F.HBLKSIZE),me=fn([3,F.HBLKSIZE_s]),De=fn([2,F.BLKSIZE]),re=fn([2,3,F.BLKSIZE_s]),Le=fn([4,F.CBANDS]),Xe=fn([4,F.CBANDS]),xe=fn([4,3]),Ne=.6,ye=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],qe=Ar(2),Mt=B.mode==dt.JOINT_STEREO?4:te.channels_out;ne(B,N,U,q,K,D,G,xe,ye,qe),Ae(B,qe);{for(var Fe=0;Fe<Mt;Fe++){var Ze=Fe&1;le=De,Ve(B,N,U,Fe,q,ve,le,Ze),z(B,q,Fe,ve),qe[Ze]!=0?we(te,ve,Le[Fe],Xe[Fe],Fe):de(te,Fe)}qe[0]+qe[1]==2&&B.mode==dt.JOINT_STEREO&&Pe(Le,Xe,te.mld_cb_l,te.ATH.cb_l,B.ATHlower*te.ATH.adjust,B.msfix,te.npart_l);for(var Fe=0;Fe<Mt;Fe++){var Ze=Fe&1;qe[Ze]!=0&&d(te,Le[Fe],Xe[Fe],Fe)}}{for(var nt=0;nt<3;nt++){for(var Fe=0;Fe<Mt;++Fe){var Ze=Fe&1;qe[Ze]!=0?ce(te,Fe,nt):(J=re,rt(B,N,U,Fe,nt,me,J,Ze),Ee(B,me,Le[Fe],Xe[Fe],Fe,nt))}qe[0]+qe[1]==0&&B.mode==dt.JOINT_STEREO&&Pe(Le,Xe,te.mld_cb_s,te.ATH.cb_s,B.ATHlower*te.ATH.adjust,B.msfix,te.npart_s);for(var Fe=0;Fe<Mt;++Fe){var Ze=Fe&1;qe[Ze]==0&&V(te,Le[Fe],Xe[Fe],Fe,nt)}}for(var Fe=0;Fe<Mt;Fe++){var Ze=Fe&1;if(qe[Ze]==0)for(var At=0;At<F.SBMAX_s;At++){for(var on=Ot(3),nt=0;nt<3;nt++){var Bt=te.thm[Fe].s[At][nt];if(Bt*=u,ye[Fe][nt]>=2||ye[Fe][nt+1]==1){var Et=nt!=0?nt-1:2,$t=C(te.thm[Fe].s[At][Et],Bt,h*Ne);Bt=Math.min(Bt,$t)}else if(ye[Fe][nt]==1){var Et=nt!=0?nt-1:2,$t=C(te.thm[Fe].s[At][Et],Bt,c*Ne);Bt=Math.min(Bt,$t)}else if(nt!=0&&ye[Fe][nt-1]==3||nt==0&&te.nsPsy.lastAttacks[Fe]==3){var Et=nt!=2?nt+1:0,$t=C(te.thm[Fe].s[At][Et],Bt,c*Ne);Bt=Math.min(Bt,$t)}Bt*=xe[Fe][nt],on[nt]=Bt}for(var nt=0;nt<3;nt++)te.thm[Fe].s[At][nt]=on[nt]}}}for(var Fe=0;Fe<Mt;Fe++)te.nsPsy.lastAttacks[Fe]=ye[Fe][2];be(B,qe,oe);for(var Fe=0;Fe<Mt;Fe++){var ln,cn,wn,kn;Fe>1?(ln=$,cn=-2,wn=F.NORM_TYPE,(oe[0]==F.SHORT_TYPE||oe[1]==F.SHORT_TYPE)&&(wn=F.SHORT_TYPE),kn=D[q][Fe-2]):(ln=Z,cn=0,wn=oe[Fe],kn=K[q][Fe]),wn==F.SHORT_TYPE?ln[cn+Fe]=Se(kn,te.masking_lower):ln[cn+Fe]=_e(kn,te.masking_lower),B.analysis&&(te.pinfo.pe[q][Fe]=ln[cn+Fe])}return 0};function je(B,N){var U=B,q;return U>=0?q=-U*27:q=U*N,q<=-72?0:Math.exp(q*o)}function ze(B){var N=0,U=0;{var q=0,K,D;for(q=0;je(q,B)>1e-20;q-=1);for(K=q,D=0;Math.abs(D-K)>1e-12;)q=(D+K)/2,je(q,B)>0?D=q:K=q;N=K}{var q=0,K,D;for(q=0;je(q,B)>1e-20;q+=1);for(K=0,D=q;Math.abs(D-K)>1e-12;)q=(D+K)/2,je(q,B)>0?K=q:D=q;U=D}{var Z=0,$=1e3,G;for(G=0;G<=$;++G){var q=N+G*(U-N)/$,oe=je(q,B);Z+=oe}{var te=($+1)/(Z*(U-N));return te}}}function Ue(B){var N,U,q,K;return N=B,N>=0?N*=3:N*=1.5,N>=.5&&N<=2.5?(K=N-.5,U=8*(K*K-2*K)):U=0,N+=.474,q=15.811389+7.5*N-17.5*Math.sqrt(1+N*N),q<=-60?0:(N=Math.exp((U+q)*o),N/=.6609193,N)}function Ke(B){return B<0&&(B=0),B=B*.001,13*Math.atan(.76*B)+3.5*Math.atan(B*B/(7.5*7.5))}function ue(B,N,U,q,K,D,Z,$,G,oe,te,le){var J=Ot(F.CBANDS+1),ve=$/(le>15?2*576:2*192),me=Ar(F.HBLKSIZE),De;$/=G;var re=0,Le=0;for(De=0;De<F.CBANDS;De++){var Xe,xe;for(Xe=Ke($*re),J[De]=$*re,xe=re;Ke($*xe)-Xe<s&&xe<=G/2;xe++);for(B[De]=xe-re,Le=De+1;re<xe;)me[re++]=De;if(re>G/2){re=G/2,++De;break}}J[De]=$*re;for(var Ne=0;Ne<le;Ne++){var ye,qe,Mt,Fe,Ze;Mt=oe[Ne],Fe=oe[Ne+1],ye=0|Math.floor(.5+te*(Mt-.5)),ye<0&&(ye=0),qe=0|Math.floor(.5+te*(Fe-.5)),qe>G/2&&(qe=G/2),U[Ne]=(me[ye]+me[qe])/2,N[Ne]=me[qe];var nt=ve*Fe;Z[Ne]=(nt-J[N[Ne]])/(J[N[Ne]+1]-J[N[Ne]]),Z[Ne]<0?Z[Ne]=0:Z[Ne]>1&&(Z[Ne]=1),Ze=Ke($*oe[Ne]*te),Ze=Math.min(Ze,15.5)/15.5,D[Ne]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Ze))-2.5)}re=0;for(var At=0;At<Le;At++){var on=B[At],Xe,Bt;Xe=Ke($*re),Bt=Ke($*(re+on-1)),q[At]=.5*(Xe+Bt),Xe=Ke($*(re-.5)),Bt=Ke($*(re+on-.5)),K[At]=Bt-Xe,re+=on}return Le}function ke(B,N,U,q,K,D){var Z=fn([F.CBANDS,F.CBANDS]),$,G=0;if(D)for(var oe=0;oe<N;oe++)for($=0;$<N;$++){var te=Ue(U[oe]-U[$])*q[$];Z[oe][$]=te*K[oe]}else for($=0;$<N;$++)for(var le=15+Math.min(21/U[$],12),J=ze(le),oe=0;oe<N;oe++){var te=J*je(U[oe]-U[$],le)*q[$];Z[oe][$]=te*K[oe]}for(var oe=0;oe<N;oe++){for($=0;$<N&&!(Z[oe][$]>0);$++);for(B[oe][0]=$,$=N-1;$>0&&!(Z[oe][$]>0);$--);B[oe][1]=$,G+=B[oe][1]-B[oe][0]+1}for(var ve=Ot(G),me=0,oe=0;oe<N;oe++)for($=B[oe][0];$<=B[oe][1];$++)ve[me++]=Z[oe][$];return ve}function ee(B){var N=Ke(B);return N=Math.min(N,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*N))-2.5)}this.psymodel_init=function(B){var N=B.internal_flags,U,q=!0,K=13,D=24,Z=0,$=0,G=-8.25,oe=-4.5,te=Ot(F.CBANDS),le=Ot(F.CBANDS),J=Ot(F.CBANDS),ve=B.out_samplerate;switch(B.experimentalZ){default:case 0:q=!0;break;case 1:q=!(B.VBR==Zr.vbr_mtrh||B.VBR==Zr.vbr_mt);break;case 2:q=!1;break;case 3:K=8,Z=-1.75,$=-.0125,G=-8.25,oe=-2.25;break}for(N.ms_ener_ratio_old=.25,N.blocktype_old[0]=N.blocktype_old[1]=F.NORM_TYPE,U=0;U<4;++U){for(var re=0;re<F.CBANDS;++re)N.nb_1[U][re]=1e20,N.nb_2[U][re]=1e20,N.nb_s1[U][re]=N.nb_s2[U][re]=1;for(var me=0;me<F.SBMAX_l;me++)N.en[U].l[me]=1e20,N.thm[U].l[me]=1e20;for(var re=0;re<3;++re){for(var me=0;me<F.SBMAX_s;me++)N.en[U].s[me][re]=1e20,N.thm[U].s[me][re]=1e20;N.nsPsy.lastAttacks[U]=0}for(var re=0;re<9;re++)N.nsPsy.last_en_subshort[U][re]=10}for(N.loudness_sq_save[0]=N.loudness_sq_save[1]=0,N.npart_l=ue(N.numlines_l,N.bo_l,N.bm_l,te,le,N.mld_l,N.PSY.bo_l_weight,ve,F.BLKSIZE,N.scalefac_band.l,F.BLKSIZE/(2*576),F.SBMAX_l),et(N.npart_l<F.CBANDS),U=0;U<N.npart_l;U++){var De=Z;te[U]>=K&&(De=$*(te[U]-K)/(D-K)+Z*(D-te[U])/(D-K)),J[U]=Math.pow(10,De/10),N.numlines_l[U]>0?N.rnumlines_l[U]=1/N.numlines_l[U]:N.rnumlines_l[U]=0}N.s3_ll=ke(N.s3ind,N.npart_l,te,le,J,q);var re=0;for(U=0;U<N.npart_l;U++){var Le;Le=Bu.MAX_VALUE;for(var Xe=0;Xe<N.numlines_l[U];Xe++,re++){var xe=ve*re/(1e3*F.BLKSIZE),Ne;Ne=this.ATHformula(xe*1e3,B)-20,Ne=Math.pow(10,.1*Ne),Ne*=N.numlines_l[U],Le>Ne&&(Le=Ne)}N.ATH.cb_l[U]=Le,Le=-20+te[U]*20/10,Le>6&&(Le=100),Le<-15&&(Le=-15),Le-=8,N.minval_l[U]=Math.pow(10,Le/10)*N.numlines_l[U]}for(N.npart_s=ue(N.numlines_s,N.bo_s,N.bm_s,te,le,N.mld_s,N.PSY.bo_s_weight,ve,F.BLKSIZE_s,N.scalefac_band.s,F.BLKSIZE_s/(2*192),F.SBMAX_s),et(N.npart_s<F.CBANDS),re=0,U=0;U<N.npart_s;U++){var Le,De=G;te[U]>=K&&(De=oe*(te[U]-K)/(D-K)+G*(D-te[U])/(D-K)),J[U]=Math.pow(10,De/10),Le=Bu.MAX_VALUE;for(var Xe=0;Xe<N.numlines_s[U];Xe++,re++){var xe=ve*re/(1e3*F.BLKSIZE_s),Ne;Ne=this.ATHformula(xe*1e3,B)-20,Ne=Math.pow(10,.1*Ne),Ne*=N.numlines_s[U],Le>Ne&&(Le=Ne)}N.ATH.cb_s[U]=Le,Le=-7+te[U]*7/12,te[U]>12&&(Le*=1+Math.log(1+Le)*3.1),te[U]<12&&(Le*=1+Math.log(1-Le)*2.3),Le<-15&&(Le=-15),Le-=8,N.minval_s[U]=Math.pow(10,Le/10)*N.numlines_s[U]}N.s3_ss=ke(N.s3ind_s,N.npart_s,te,le,J,q),S(),e.init_fft(N),N.decay=Math.exp(-1*t/(m*ve/192));{var ye;ye=_,(B.exp_nspsytune&2)!=0&&(ye=1),Math.abs(B.msfix)>0&&(ye=B.msfix),B.msfix=ye;for(var qe=0;qe<N.npart_l;qe++)N.s3ind[qe][1]>N.npart_l-1&&(N.s3ind[qe][1]=N.npart_l-1)}var Mt=576*N.mode_gr/ve;if(N.ATH.decay=Math.pow(10,-12/10*Mt),N.ATH.adjust=.01,N.ATH.adjustLimit=1,et(N.bo_l[F.SBMAX_l-1]<=N.npart_l),et(N.bo_s[F.SBMAX_s-1]<=N.npart_s),B.ATHtype!=-1){var xe,Fe=B.out_samplerate/F.BLKSIZE,Ze=0;for(xe=0,U=0;U<F.BLKSIZE/2;++U)xe+=Fe,N.ATH.eql_w[U]=1/Math.pow(10,this.ATHformula(xe,B)/10),Ze+=N.ATH.eql_w[U];for(Ze=1/Ze,U=F.BLKSIZE/2;--U>=0;)N.ATH.eql_w[U]*=Ze}{for(var qe=re=0;qe<N.npart_s;++qe)for(U=0;U<N.numlines_s[qe];++U)++re;for(var qe=re=0;qe<N.npart_l;++qe)for(U=0;U<N.numlines_l[qe];++U)++re}for(re=0,U=0;U<N.npart_l;U++){var xe=ve*(re+N.numlines_l[U]/2)/(1*F.BLKSIZE);N.mld_cb_l[U]=ee(xe),re+=N.numlines_l[U]}for(;U<F.CBANDS;++U)N.mld_cb_l[U]=1;for(re=0,U=0;U<N.npart_s;U++){var xe=ve*(re+N.numlines_s[U]/2)/(1*F.BLKSIZE_s);N.mld_cb_s[U]=ee(xe),re+=N.numlines_s[U]}for(;U<F.CBANDS;++U)N.mld_cb_s[U]=1;return 0};function Ce(B,N){B<-.3&&(B=3410),B/=1e3,B=Math.max(.1,B);var U=3.64*Math.pow(B,-.8)-6.8*Math.exp(-.6*Math.pow(B-3.4,2))+6*Math.exp(-.15*Math.pow(B-8.7,2))+(.6+.04*N)*.001*Math.pow(B,4);return U}this.ATHformula=function(B,N){var U;switch(N.ATHtype){case 0:U=Ce(B,9);break;case 1:U=Ce(B,-1);break;case 2:U=Ce(B,0);break;case 3:U=Ce(B,1)+6;break;case 4:U=Ce(B,N.ATHcurve);break;default:U=Ce(B,0);break}return U}}function Jg(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=dt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var or={};or.SFBMAX=F.SBMAX_s*3;var $g=Ie.new_float,Er=Ie.new_int;function Da(){this.xr=$g(576),this.l3_enc=Er(576),this.scalefac=Er(or.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Er(3),this.subblock_gain=Er(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Er(or.SFBMAX),this.window=Er(or.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Er(4),this.max_nonzero_coeff=0;var e=this;function t(r){return new Int32Array(r)}function n(r){return new Float32Array(r)}this.assign=function(r){e.xr=n(r.xr),e.l3_enc=t(r.l3_enc),e.scalefac=t(r.scalefac),e.xrpow_max=r.xrpow_max,e.part2_3_length=r.part2_3_length,e.big_values=r.big_values,e.count1=r.count1,e.global_gain=r.global_gain,e.scalefac_compress=r.scalefac_compress,e.block_type=r.block_type,e.mixed_block_flag=r.mixed_block_flag,e.table_select=t(r.table_select),e.subblock_gain=t(r.subblock_gain),e.region0_count=r.region0_count,e.region1_count=r.region1_count,e.preflag=r.preflag,e.scalefac_scale=r.scalefac_scale,e.count1table_select=r.count1table_select,e.part2_length=r.part2_length,e.sfb_lmax=r.sfb_lmax,e.sfb_smin=r.sfb_smin,e.psy_lmax=r.psy_lmax,e.sfbmax=r.sfbmax,e.psymax=r.psymax,e.sfbdivide=r.sfbdivide,e.width=t(r.width),e.window=t(r.window),e.count1bits=r.count1bits,e.sfb_partition_table=r.sfb_partition_table.slice(0),e.slen=t(r.slen),e.max_nonzero_coeff=r.max_nonzero_coeff}}var Ou=Ie.new_int;function e3(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Ou(4),Ou(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Da}var Pa=Ie.System,za=Ie.new_int;function Ln(e,t,n,r){this.l=za(1+F.SBMAX_l),this.s=za(1+F.SBMAX_s),this.psfb21=za(1+F.PSFB21),this.psfb12=za(1+F.PSFB12);var a=this.l,i=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Pa.arraycopy(this.arrL,0,a,0,Math.min(this.arrL.length,this.l.length)),Pa.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),Pa.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Pa.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Mo=Ie.new_float,t3=Ie.new_float_n,n3=Ie.new_int;function r3(){this.last_en_subshort=t3([4,9]),this.lastAttacks=n3(4),this.pefirbuf=Mo(19),this.longfact=Mo(F.SBMAX_l),this.shortfact=Mo(F.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function i3(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var a3=Ie.new_byte,s3=Ie.new_double,hn=Ie.new_float,Tr=Ie.new_float_n,yn=Ie.new_int,Ua=Ie.new_int_n;ut.MFSIZE=3*1152+F.ENCDELAY-F.MDCTDELAY,ut.MAX_HEADER_BUF=256,ut.MAX_BITS_PER_CHANNEL=4095,ut.MAX_BITS_PER_GRANULE=7680,ut.BPC=320;function ut(){var e=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Tr([2,ut.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new e3,this.ms_ratio=hn(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=yn(2),this.CurrentStep=yn(2),this.masking_lower=0,this.bv_scf=yn(576),this.pseudohalf=yn(or.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*ut.BPC+1),this.itime=s3(2),this.sideinfo_len=0,this.sb_sample=Tr([2,2,18,F.SBLIMIT]),this.amp_filter=hn(32);function t(){this.write_timing=0,this.ptr=0,this.buf=a3(e)}this.header=new Array(ut.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Ln,this.minval_l=hn(F.CBANDS),this.minval_s=hn(F.CBANDS),this.nb_1=Tr([4,F.CBANDS]),this.nb_2=Tr([4,F.CBANDS]),this.nb_s1=Tr([4,F.CBANDS]),this.nb_s2=Tr([4,F.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=hn(4),this.loudness_sq=Tr([2,2]),this.loudness_sq_save=hn(2),this.mld_l=hn(F.SBMAX_l),this.mld_s=hn(F.SBMAX_s),this.bm_l=yn(F.SBMAX_l),this.bo_l=yn(F.SBMAX_l),this.bm_s=yn(F.SBMAX_s),this.bo_s=yn(F.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Ua([F.CBANDS,2]),this.s3ind_s=Ua([F.CBANDS,2]),this.numlines_s=yn(F.CBANDS),this.numlines_l=yn(F.CBANDS),this.rnumlines_l=hn(F.CBANDS),this.mld_cb_l=hn(F.CBANDS),this.mld_cb_s=hn(F.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=hn(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=yn(2),this.nsPsy=new r3,this.VBR_seek_table=new i3,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Ua([16,4+1]),this.bitrate_blockType_Hist=Ua([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new ja;for(var n=0;n<this.thm.length;n++)this.thm[n]=new ja;for(var n=0;n<this.header.length;n++)this.header[n]=new t}var Rr=Ie.new_float;function o3(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Rr(F.SBMAX_l),this.s=Rr(F.SBMAX_s),this.psfb21=Rr(F.PSFB21),this.psfb12=Rr(F.PSFB12),this.cb_l=Rr(F.CBANDS),this.cb_s=Rr(F.CBANDS),this.eql_w=Rr(F.BLKSIZE/2)}var Jt=Ie.System,Lu=Ie.Arrays;It.STEPS_per_dB=100,It.MAX_dB=120,It.GAIN_NOT_ENOUGH_SAMPLES=-24601,It.GAIN_ANALYSIS_ERROR=0,It.GAIN_ANALYSIS_OK=1,It.INIT_GAIN_ANALYSIS_ERROR=0,It.INIT_GAIN_ANALYSIS_OK=1,It.YULE_ORDER=10,It.MAX_ORDER=It.YULE_ORDER,It.MAX_SAMP_FREQ=48e3,It.RMS_WINDOW_TIME_NUMERATOR=1,It.RMS_WINDOW_TIME_DENOMINATOR=20,It.MAX_SAMPLES_PER_WINDOW=It.MAX_SAMP_FREQ*It.RMS_WINDOW_TIME_NUMERATOR/It.RMS_WINDOW_TIME_DENOMINATOR+1;function It(){var e=64.82,t=.95,n=It.RMS_WINDOW_TIME_NUMERATOR,r=It.RMS_WINDOW_TIME_DENOMINATOR,a=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],i=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function s(c,_,p,o,j,O){for(;j--!=0;)p[o]=1e-10+c[_+0]*O[0]-p[o-1]*O[1]+c[_-1]*O[2]-p[o-2]*O[3]+c[_-2]*O[4]-p[o-3]*O[5]+c[_-3]*O[6]-p[o-4]*O[7]+c[_-4]*O[8]-p[o-5]*O[9]+c[_-5]*O[10]-p[o-6]*O[11]+c[_-6]*O[12]-p[o-7]*O[13]+c[_-7]*O[14]-p[o-8]*O[15]+c[_-8]*O[16]-p[o-9]*O[17]+c[_-9]*O[18]-p[o-10]*O[19]+c[_-10]*O[20],++o,++_}function l(c,_,p,o,j,O){for(;j--!=0;)p[o]=c[_+0]*O[0]-p[o-1]*O[1]+c[_-1]*O[2]-p[o-2]*O[3]+c[_-2]*O[4],++o,++_}function m(c,_){for(var p=0;p<MAX_ORDER;p++)c.linprebuf[p]=c.lstepbuf[p]=c.loutbuf[p]=c.rinprebuf[p]=c.rstepbuf[p]=c.routbuf[p]=0;switch(0|_){case 48e3:c.reqindex=0;break;case 44100:c.reqindex=1;break;case 32e3:c.reqindex=2;break;case 24e3:c.reqindex=3;break;case 22050:c.reqindex=4;break;case 16e3:c.reqindex=5;break;case 12e3:c.reqindex=6;break;case 11025:c.reqindex=7;break;case 8e3:c.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return c.sampleWindow=0|(_*n+r-1)/r,c.lsum=0,c.rsum=0,c.totsamp=0,Lu.ill(c.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(c,_){return m(c,_)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(c.linpre=MAX_ORDER,c.rinpre=MAX_ORDER,c.lstep=MAX_ORDER,c.rstep=MAX_ORDER,c.lout=MAX_ORDER,c.rout=MAX_ORDER,Lu.fill(c.B,0),INIT_GAIN_ANALYSIS_OK)};function u(c){return c*c}this.AnalyzeSamples=function(c,_,p,o,j,O,I){var v,E,L,T,R,g,A;if(O==0)return GAIN_ANALYSIS_OK;switch(A=0,R=O,I){case 1:o=_,j=p;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(O<MAX_ORDER?(Jt.arraycopy(_,p,c.linprebuf,MAX_ORDER,O),Jt.arraycopy(o,j,c.rinprebuf,MAX_ORDER,O)):(Jt.arraycopy(_,p,c.linprebuf,MAX_ORDER,MAX_ORDER),Jt.arraycopy(o,j,c.rinprebuf,MAX_ORDER,MAX_ORDER));R>0;){g=R>c.sampleWindow-c.totsamp?c.sampleWindow-c.totsamp:R,A<MAX_ORDER?(v=c.linpre+A,E=c.linprebuf,L=c.rinpre+A,T=c.rinprebuf,g>MAX_ORDER-A&&(g=MAX_ORDER-A)):(v=p+A,E=_,L=j+A,T=o),s(E,v,c.lstepbuf,c.lstep+c.totsamp,g,a[c.reqindex]),s(T,L,c.rstepbuf,c.rstep+c.totsamp,g,a[c.reqindex]),l(c.lstepbuf,c.lstep+c.totsamp,c.loutbuf,c.lout+c.totsamp,g,i[c.reqindex]),l(c.rstepbuf,c.rstep+c.totsamp,c.routbuf,c.rout+c.totsamp,g,i[c.reqindex]),v=c.lout+c.totsamp,E=c.loutbuf,L=c.rout+c.totsamp,T=c.routbuf;for(var S=g%8;S--!=0;)c.lsum+=u(E[v++]),c.rsum+=u(T[L++]);for(S=g/8;S--!=0;)c.lsum+=u(E[v+0])+u(E[v+1])+u(E[v+2])+u(E[v+3])+u(E[v+4])+u(E[v+5])+u(E[v+6])+u(E[v+7]),v+=8,c.rsum+=u(T[L+0])+u(T[L+1])+u(T[L+2])+u(T[L+3])+u(T[L+4])+u(T[L+5])+u(T[L+6])+u(T[L+7]),L+=8;if(R-=g,A+=g,c.totsamp+=g,c.totsamp==c.sampleWindow){var f=It.STEPS_per_dB*10*Math.log10((c.lsum+c.rsum)/c.totsamp*.5+1e-37),x=f<=0?0:0|f;x>=c.A.length&&(x=c.A.length-1),c.A[x]++,c.lsum=c.rsum=0,Jt.arraycopy(c.loutbuf,c.totsamp,c.loutbuf,0,MAX_ORDER),Jt.arraycopy(c.routbuf,c.totsamp,c.routbuf,0,MAX_ORDER),Jt.arraycopy(c.lstepbuf,c.totsamp,c.lstepbuf,0,MAX_ORDER),Jt.arraycopy(c.rstepbuf,c.totsamp,c.rstepbuf,0,MAX_ORDER),c.totsamp=0}if(c.totsamp>c.sampleWindow)return GAIN_ANALYSIS_ERROR}return O<MAX_ORDER?(Jt.arraycopy(c.linprebuf,O,c.linprebuf,0,MAX_ORDER-O),Jt.arraycopy(c.rinprebuf,O,c.rinprebuf,0,MAX_ORDER-O),Jt.arraycopy(_,p,c.linprebuf,MAX_ORDER-O,O),Jt.arraycopy(o,j,c.rinprebuf,MAX_ORDER-O,O)):(Jt.arraycopy(_,p+O-MAX_ORDER,c.linprebuf,0,MAX_ORDER),Jt.arraycopy(o,j+O-MAX_ORDER,c.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function h(c,_){var p,o=0;for(p=0;p<_;p++)o+=c[p];if(o==0)return GAIN_NOT_ENOUGH_SAMPLES;var j=0|Math.ceil(o*(1-t));for(p=_;p-- >0&&!((j-=c[p])<=0););return e-p/It.STEPS_per_dB}this.GetTitleGain=function(c){for(var _=h(c.A,c.A.length),p=0;p<c.A.length;p++)c.B[p]+=c.A[p],c.A[p]=0;for(var p=0;p<MAX_ORDER;p++)c.linprebuf[p]=c.lstepbuf[p]=c.loutbuf[p]=c.rinprebuf[p]=c.rstepbuf[p]=c.routbuf[p]=0;return c.totsamp=0,c.lsum=c.rsum=0,_}}var Jr=Ie.new_float,Fu=Ie.new_int;function l3(){this.linprebuf=Jr(void 0*2),this.linpre=0,this.lstepbuf=Jr(void 0+void 0),this.lstep=0,this.loutbuf=Jr(void 0+void 0),this.lout=0,this.rinprebuf=Jr(void 0*2),this.rinpre=0,this.rstepbuf=Jr(void 0+void 0),this.rstep=0,this.routbuf=Jr(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=Fu(0|void 0*void 0),this.B=Fu(0|void 0*void 0)}function ju(e){this.bits=e}var Nu=Ie.new_float,c3=Ie.new_int,Hu=Ie.assert;function u3(e){var t=e;this.quantize=t,this.iteration_loop=function(n,r,a,i){var s=n.internal_flags,l=Nu(or.SFBMAX),m=Nu(576),u=c3(2),h=0,c,_=s.l3_side,p=new ju(h);this.quantize.rv.ResvFrameBegin(n,p),h=p.bits;for(var o=0;o<s.mode_gr;o++){c=this.quantize.qupvt.on_pe(n,r,u,h,o,o),s.mode_ext==F.MPG_MD_MS_LR&&(this.quantize.ms_convert(s.l3_side,o),this.quantize.qupvt.reduce_side(u,a[o],h,c));for(var j=0;j<s.channels_out;j++){var O,I,v=_.tt[o][j];v.block_type!=F.SHORT_TYPE?(O=0,I=s.PSY.mask_adjust-O):(O=0,I=s.PSY.mask_adjust_short-O),s.masking_lower=Math.pow(10,I*.1),this.quantize.init_outer_loop(s,v),this.quantize.init_xrpow(s,v,m)&&(this.quantize.qupvt.calc_xmin(n,i[o][j],v,l),this.quantize.outer_loop(n,v,l,m,j,u[j])),this.quantize.iteration_finish_one(s,o,j),Hu(v.part2_3_length<=ut.MAX_BITS_PER_CHANNEL),Hu(v.part2_3_length<=u[j])}}this.quantize.rv.ResvFrameEnd(s,h)}}function ct(e,t,n,r){this.xlen=e,this.linmax=t,this.table=n,this.hlen=r}var ae={};ae.t1HB=[1,1,1,0],ae.t2HB=[1,2,1,3,1,1,3,2,0],ae.t3HB=[3,2,1,1,1,1,3,2,0],ae.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],ae.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],ae.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],ae.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],ae.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],ae.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],ae.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],ae.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],ae.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],ae.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],ae.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],ae.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],ae.t32HB=[1<<0,5<<1,4<<1,5<<2,6<<1,5<<2,4<<2,4<<3,7<<1,3<<2,6<<2,0<<3,7<<2,2<<3,3<<3,1<<4],ae.t33HB=[15<<0,14<<1,13<<1,12<<2,11<<1,10<<2,9<<2,8<<3,7<<1,6<<2,5<<2,4<<3,3<<2,2<<3,1<<3,0<<4],ae.t1l=[1,4,3,5],ae.t2l=[1,4,7,4,5,7,6,7,8],ae.t3l=[2,3,7,4,4,7,6,7,8],ae.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],ae.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],ae.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],ae.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],ae.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],ae.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],ae.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],ae.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],ae.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],ae.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],ae.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],ae.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],ae.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],ae.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4],ae.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4],ae.ht=[new ct(0,0,null,null),new ct(2,0,ae.t1HB,ae.t1l),new ct(3,0,ae.t2HB,ae.t2l),new ct(3,0,ae.t3HB,ae.t3l),new ct(0,0,null,null),new ct(4,0,ae.t5HB,ae.t5l),new ct(4,0,ae.t6HB,ae.t6l),new ct(6,0,ae.t7HB,ae.t7l),new ct(6,0,ae.t8HB,ae.t8l),new ct(6,0,ae.t9HB,ae.t9l),new ct(8,0,ae.t10HB,ae.t10l),new ct(8,0,ae.t11HB,ae.t11l),new ct(8,0,ae.t12HB,ae.t12l),new ct(16,0,ae.t13HB,ae.t13l),new ct(0,0,null,ae.t16_5l),new ct(16,0,ae.t15HB,ae.t15l),new ct(1,1,ae.t16HB,ae.t16l),new ct(2,3,ae.t16HB,ae.t16l),new ct(3,7,ae.t16HB,ae.t16l),new ct(4,15,ae.t16HB,ae.t16l),new ct(6,63,ae.t16HB,ae.t16l),new ct(8,255,ae.t16HB,ae.t16l),new ct(10,1023,ae.t16HB,ae.t16l),new ct(13,8191,ae.t16HB,ae.t16l),new ct(4,15,ae.t24HB,ae.t24l),new ct(5,31,ae.t24HB,ae.t24l),new ct(6,63,ae.t24HB,ae.t24l),new ct(7,127,ae.t24HB,ae.t24l),new ct(8,255,ae.t24HB,ae.t24l),new ct(9,511,ae.t24HB,ae.t24l),new ct(11,2047,ae.t24HB,ae.t24l),new ct(13,8191,ae.t24HB,ae.t24l),new ct(0,0,ae.t32HB,ae.t32l),new ct(0,0,ae.t33HB,ae.t33l)],ae.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],ae.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],ae.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],ae.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],ae.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],ae.scfsi_band=[0,6,11,16,21];var Ir=Ie.VbrMode,Va=Ie.Float,Ao=Ie.Util,Cr=Ie.new_float,d3=Ie.new_int,Bi=Ie.assert;Ut.Q_MAX=256+1,Ut.Q_MAX2=116,Ut.LARGE_BITS=1e5,Ut.IXMAX_VAL=8206;function Ut(){var e=null,t=null,n=null;this.setModules=function(v,E,L){e=v,t=E,n=L};function r(v){return c[v+Ut.Q_MAX2]}this.IPOW20=function(v){return _[v]};var a=2220446049250313e-31,i=Ut.IXMAX_VAL,s=i+2,l=Ut.Q_MAX,m=Ut.Q_MAX2,u=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var h=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=h,this.sfBandIndex=[new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var c=Cr(l+m+1),_=Cr(l),p=Cr(s),o=Cr(s);this.adj43=o;function j(v,E){var L=n.ATHformula(E,v);return L-=u,L=Math.pow(10,L/10+v.ATHlower),L}function O(v){for(var E=v.internal_flags.ATH.l,L=v.internal_flags.ATH.psfb21,T=v.internal_flags.ATH.s,R=v.internal_flags.ATH.psfb12,g=v.internal_flags,A=v.out_samplerate,S=0;S<F.SBMAX_l;S++){var f=g.scalefac_band.l[S],x=g.scalefac_band.l[S+1];E[S]=Va.MAX_VALUE;for(var b=f;b<x;b++){var y=b*A/1152,k=j(v,y);E[S]=Math.min(E[S],k)}}for(var S=0;S<F.PSFB21;S++){var f=g.scalefac_band.psfb21[S],x=g.scalefac_band.psfb21[S+1];L[S]=Va.MAX_VALUE;for(var b=f;b<x;b++){var y=b*A/1152,k=j(v,y);L[S]=Math.min(L[S],k)}}for(var S=0;S<F.SBMAX_s;S++){var f=g.scalefac_band.s[S],x=g.scalefac_band.s[S+1];T[S]=Va.MAX_VALUE;for(var b=f;b<x;b++){var y=b*A/384,k=j(v,y);T[S]=Math.min(T[S],k)}T[S]*=g.scalefac_band.s[S+1]-g.scalefac_band.s[S]}for(var S=0;S<F.PSFB12;S++){var f=g.scalefac_band.psfb12[S],x=g.scalefac_band.psfb12[S+1];R[S]=Va.MAX_VALUE;for(var b=f;b<x;b++){var y=b*A/384,k=j(v,y);R[S]=Math.min(R[S],k)}R[S]*=g.scalefac_band.s[13]-g.scalefac_band.s[12]}if(v.noATH){for(var S=0;S<F.SBMAX_l;S++)E[S]=1e-20;for(var S=0;S<F.PSFB21;S++)L[S]=1e-20;for(var S=0;S<F.SBMAX_s;S++)T[S]=1e-20;for(var S=0;S<F.PSFB12;S++)R[S]=1e-20}g.ATH.floor=10*Math.log10(j(v,-1))}this.iteration_init=function(v){var E=v.internal_flags,L=E.l3_side,T;if(E.iteration_init_init==0){for(E.iteration_init_init=1,L.main_data_begin=0,O(v),p[0]=0,T=1;T<s;T++)p[T]=Math.pow(T,4/3);for(T=0;T<s-1;T++)o[T]=T+1-Math.pow(.5*(p[T]+p[T+1]),.75);for(o[T]=.5,T=0;T<l;T++)_[T]=Math.pow(2,(T-210)*-.1875);for(T=0;T<=l+m;T++)c[T]=Math.pow(2,(T-210-m)*.25);e.huffman_init(E);{var R,g,A,S;for(T=v.exp_nspsytune>>2&63,T>=32&&(T-=64),R=Math.pow(10,T/4/10),T=v.exp_nspsytune>>8&63,T>=32&&(T-=64),g=Math.pow(10,T/4/10),T=v.exp_nspsytune>>14&63,T>=32&&(T-=64),A=Math.pow(10,T/4/10),T=v.exp_nspsytune>>20&63,T>=32&&(T-=64),S=A*Math.pow(10,T/4/10),T=0;T<F.SBMAX_l;T++){var f;T<=6?f=R:T<=13?f=g:T<=20?f=A:f=S,E.nsPsy.longfact[T]=f}for(T=0;T<F.SBMAX_s;T++){var f;T<=5?f=R:T<=10?f=g:T<=11?f=A:f=S,E.nsPsy.shortfact[T]=f}}}},this.on_pe=function(v,E,L,T,R,g){var A=v.internal_flags,S=0,f,x=d3(2),b,y=new ju(S),k=t.ResvMaxBits(v,T,y,g);S=y.bits;var w=S+k;for(w>ut.MAX_BITS_PER_GRANULE&&(w=ut.MAX_BITS_PER_GRANULE),f=0,b=0;b<A.channels_out;++b)L[b]=Math.min(ut.MAX_BITS_PER_CHANNEL,S/A.channels_out),x[b]=0|L[b]*E[R][b]/700-L[b],x[b]>T*3/4&&(x[b]=T*3/4),x[b]<0&&(x[b]=0),x[b]+L[b]>ut.MAX_BITS_PER_CHANNEL&&(x[b]=Math.max(0,ut.MAX_BITS_PER_CHANNEL-L[b])),f+=x[b];if(f>k)for(b=0;b<A.channels_out;++b)x[b]=k*x[b]/f;for(b=0;b<A.channels_out;++b)L[b]+=x[b],k-=x[b];for(f=0,b=0;b<A.channels_out;++b)f+=L[b];if(f>ut.MAX_BITS_PER_GRANULE){var H=0;for(b=0;b<A.channels_out;++b)L[b]*=ut.MAX_BITS_PER_GRANULE,L[b]/=f,H+=L[b]}return w},this.reduce_side=function(v,E,L,T){Bi(v[0]+v[1]<=ut.MAX_BITS_PER_GRANULE);var R=.33*(.5-E)/.5;R<0&&(R=0),R>.5&&(R=.5);var g=0|R*.5*(v[0]+v[1]);g>ut.MAX_BITS_PER_CHANNEL-v[0]&&(g=ut.MAX_BITS_PER_CHANNEL-v[0]),g<0&&(g=0),v[1]>=125&&(v[1]-g>125?(v[0]<L&&(v[0]+=g),v[1]-=g):(v[0]+=v[1]-125,v[1]=125)),g=v[0]+v[1],g>T&&(v[0]=T*v[0]/g,v[1]=T*v[1]/g),Bi(v[0]<=ut.MAX_BITS_PER_CHANNEL),Bi(v[1]<=ut.MAX_BITS_PER_CHANNEL),Bi(v[0]+v[1]<=ut.MAX_BITS_PER_GRANULE)},this.athAdjust=function(v,E,L){var T=90.30873362,R=94.82444863,g=Ao.FAST_LOG10_X(E,10),A=v*v,S=0;return g-=L,A>1e-20&&(S=1+Ao.FAST_LOG10_X(A,10/T)),S<0&&(S=0),g*=S,g+=L+T-R,Math.pow(10,.1*g)},this.calc_xmin=function(v,E,L,T){var R=0,g=v.internal_flags,A,S=0,f=0,x=g.ATH,b=L.xr,y=v.VBR==Ir.vbr_mtrh?1:0,k=g.masking_lower;for((v.VBR==Ir.vbr_mtrh||v.VBR==Ir.vbr_mt)&&(k=1),A=0;A<L.psy_lmax;A++){var w,H,Y,P,V,d;v.VBR==Ir.vbr_rh||v.VBR==Ir.vbr_mtrh?H=athAdjust(x.adjust,x.l[A],x.floor):H=x.adjust*x.l[A],V=L.width[A],Y=H/V,P=a,d=V>>1,w=0;do{var M,W;M=b[S]*b[S],w+=M,P+=M<Y?M:Y,S++,W=b[S]*b[S],w+=W,P+=W<Y?W:Y,S++}while(--d>0);if(w>H&&f++,A==F.SBPSY_l){var C=H*g.nsPsy.longfact[A];P<C&&(P=C)}if(y!=0&&(H=P),!v.ATHonly){var fe=E.en.l[A];if(fe>0){var C;C=w*E.thm.l[A]*k/fe,y!=0&&(C*=g.nsPsy.longfact[A]),H<C&&(H=C)}}y!=0?T[R++]=H:T[R++]=H*g.nsPsy.longfact[A]}var Se=575;if(L.block_type!=F.SHORT_TYPE)for(var ge=576;ge--!=0&&pn.EQ(b[ge],0);)Se=ge;L.max_nonzero_coeff=Se;for(var _e=L.sfb_smin;A<L.psymax;_e++,A+=3){var V,He,Re;for(v.VBR==Ir.vbr_rh||v.VBR==Ir.vbr_mtrh?Re=athAdjust(x.adjust,x.s[_e],x.floor):Re=x.adjust*x.s[_e],V=L.width[A],He=0;He<3;He++){var w=0,H,Y,P,d=V>>1;Y=Re/V,P=a;do{var M,W;M=b[S]*b[S],w+=M,P+=M<Y?M:Y,S++,W=b[S]*b[S],w+=W,P+=W<Y?W:Y,S++}while(--d>0);if(w>Re&&f++,_e==F.SBPSY_s){var C=Re*g.nsPsy.shortfact[_e];P<C&&(P=C)}if(y!=0?H=P:H=Re,!v.ATHonly&&!v.ATHshort){var fe=E.en.s[_e][He];if(fe>0){var C;C=w*E.thm.s[_e][He]*k/fe,y!=0&&(C*=g.nsPsy.shortfact[_e]),H<C&&(H=C)}}y!=0?T[R++]=H:T[R++]=H*g.nsPsy.shortfact[_e]}v.useTemporal&&(T[R-3]>T[R-3+1]&&(T[R-3+1]+=(T[R-3]-T[R-3+1])*g.decay),T[R-3+1]>T[R-3+2]&&(T[R-3+2]+=(T[R-3+1]-T[R-3+2])*g.decay))}return f};function I(v){this.s=v}this.calc_noise_core=function(v,E,L,T){var R=0,g=E.s,A=v.l3_enc;if(g>v.count1)for(;L--!=0;){var S;S=v.xr[g],g++,R+=S*S,S=v.xr[g],g++,R+=S*S}else if(g>v.big_values){var f=Cr(2);for(f[0]=0,f[1]=T;L--!=0;){var S;S=Math.abs(v.xr[g])-f[A[g]],g++,R+=S*S,S=Math.abs(v.xr[g])-f[A[g]],g++,R+=S*S}}else for(;L--!=0;){var S;S=Math.abs(v.xr[g])-p[A[g]]*T,g++,R+=S*S,S=Math.abs(v.xr[g])-p[A[g]]*T,g++,R+=S*S}return E.s=g,R},this.calc_noise=function(v,E,L,T,R){var g=0,A=0,S,f,x=0,b=0,y=0,k=-20,w=0,H=v.scalefac,Y=0;for(T.over_SSD=0,S=0;S<v.psymax;S++){var P=v.global_gain-(H[Y++]+(v.preflag!=0?h[S]:0)<<v.scalefac_scale+1)-v.subblock_gain[v.window[S]]*8,V=0;if(R!=null&&R.step[S]==P)V=R.noise[S],w+=v.width[S],L[g++]=V/E[A++],V=R.noise_log[S];else{var d=r(P);if(f=v.width[S]>>1,w+v.width[S]>v.max_nonzero_coeff){var M;M=v.max_nonzero_coeff-w+1,M>0?f=M>>1:f=0}var W=new I(w);V=this.calc_noise_core(v,W,f,d),w=W.s,R!=null&&(R.step[S]=P,R.noise[S]=V),V=L[g++]=V/E[A++],V=Ao.FAST_LOG10(Math.max(V,1e-20)),R!=null&&(R.noise_log[S]=V)}if(R!=null&&(R.global_gain=v.global_gain),y+=V,V>0){var C;C=Math.max(0|V*10+.5,1),T.over_SSD+=C*C,x++,b+=V}k=Math.max(k,V)}return T.over_count=x,T.tot_noise=y,T.over_noise=b,T.max_noise=k,x},this.set_pinfo=function(v,E,L,T,R){var g=v.internal_flags,A,S,f,x,b,y=E.scalefac_scale==0?.5:1,k=E.scalefac,w=Cr(L3Side.SFBMAX),H=Cr(L3Side.SFBMAX),Y=new CalcNoiseResult;calc_xmin(v,L,E,w),calc_noise(E,w,H,Y,null);var P=0;for(S=E.sfb_lmax,E.block_type!=F.SHORT_TYPE&&E.mixed_block_flag==0&&(S=22),A=0;A<S;A++){var V=g.scalefac_band.l[A],d=g.scalefac_band.l[A+1],M=d-V;for(x=0;P<d;P++)x+=E.xr[P]*E.xr[P];x/=M,b=1e15,g.pinfo.en[T][R][A]=b*x,g.pinfo.xfsf[T][R][A]=b*w[A]*H[A]/M,L.en.l[A]>0&&!v.ATHonly?x=x/L.en.l[A]:x=0,g.pinfo.thr[T][R][A]=b*Math.max(x*L.thm.l[A],g.ATH.l[A]),g.pinfo.LAMEsfb[T][R][A]=0,E.preflag!=0&&A>=11&&(g.pinfo.LAMEsfb[T][R][A]=-y*h[A]),A<F.SBPSY_l&&(Bi(k[A]>=0),g.pinfo.LAMEsfb[T][R][A]-=y*k[A])}if(E.block_type==F.SHORT_TYPE)for(S=A,A=E.sfb_smin;A<F.SBMAX_s;A++)for(var V=g.scalefac_band.s[A],d=g.scalefac_band.s[A+1],M=d-V,W=0;W<3;W++){for(x=0,f=V;f<d;f++)x+=E.xr[P]*E.xr[P],P++;x=Math.max(x/M,1e-20),b=1e15,g.pinfo.en_s[T][R][3*A+W]=b*x,g.pinfo.xfsf_s[T][R][3*A+W]=b*w[S]*H[S]/M,L.en.s[A][W]>0?x=x/L.en.s[A][W]:x=0,(v.ATHonly||v.ATHshort)&&(x=0),g.pinfo.thr_s[T][R][3*A+W]=b*Math.max(x*L.thm.s[A][W],g.ATH.s[A]),g.pinfo.LAMEsfb_s[T][R][3*A+W]=-2*E.subblock_gain[W],A<F.SBPSY_s&&(g.pinfo.LAMEsfb_s[T][R][3*A+W]-=y*k[S]),S++}g.pinfo.LAMEqss[T][R]=E.global_gain,g.pinfo.LAMEmainbits[T][R]=E.part2_3_length+E.part2_length,g.pinfo.LAMEsfbits[T][R]=E.part2_length,g.pinfo.over[T][R]=Y.over_count,g.pinfo.max_noise[T][R]=Y.max_noise*10,g.pinfo.over_noise[T][R]=Y.over_noise*10,g.pinfo.tot_noise[T][R]=Y.tot_noise*10,g.pinfo.over_SSD[T][R]=Y.over_SSD}}var m3=Ie.System,f3=Ie.Arrays,Oi=Ie.new_int,Eo=Ie.assert;function Li(){var e=null;this.qupvt=null,this.setModules=function(f){this.qupvt=f,e=f};function t(f){this.bits=0|f}var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function r(f,x,b,y,k,w){var H=.5946/x;for(f=f>>1;f--!=0;)k[w++]=H>b[y++]?0:1,k[w++]=H>b[y++]?0:1}function a(f,x,b,y,k,w){f=f>>1;var H=f%2;for(f=f>>1;f--!=0;){var Y,P,V,d,M,W,C,fe;Y=b[y++]*x,P=b[y++]*x,M=0|Y,V=b[y++]*x,W=0|P,d=b[y++]*x,C=0|V,Y+=e.adj43[M],fe=0|d,P+=e.adj43[W],k[w++]=0|Y,V+=e.adj43[C],k[w++]=0|P,d+=e.adj43[fe],k[w++]=0|V,k[w++]=0|d}if(H!=0){var Y,P,M,W;Y=b[y++]*x,P=b[y++]*x,M=0|Y,W=0|P,Y+=e.adj43[M],P+=e.adj43[W],k[w++]=0|Y,k[w++]=0|P}}function i(f,x,b,y,k){var w,H,Y=0,P,V=0,d=0,M=0,W=x,C=0,fe=W,Se=0,ge=f,_e=0;for(P=k!=null&&y.global_gain==k.global_gain,y.block_type==F.SHORT_TYPE?H=38:H=21,w=0;w<=H;w++){var He=-1;if((P||y.block_type==F.NORM_TYPE)&&(He=y.global_gain-(y.scalefac[w]+(y.preflag!=0?e.pretab[w]:0)<<y.scalefac_scale+1)-y.subblock_gain[y.window[w]]*8),Eo(y.width[w]>=0),P&&k.step[w]==He)V!=0&&(a(V,b,ge,_e,fe,Se),V=0),d!=0&&(r(d,b,ge,_e,fe,Se),d=0);else{var Re=y.width[w];if(Y+y.width[w]>y.max_nonzero_coeff){var pe;pe=y.max_nonzero_coeff-Y+1,f3.fill(x,y.max_nonzero_coeff,576,0),Re=pe,Re<0&&(Re=0),w=H+1}if(V==0&&d==0&&(fe=W,Se=C,ge=f,_e=M),k!=null&&k.sfb_count1>0&&w>=k.sfb_count1&&k.step[w]>0&&He>=k.step[w]?(V!=0&&(a(V,b,ge,_e,fe,Se),V=0,fe=W,Se=C,ge=f,_e=M),d+=Re):(d!=0&&(r(d,b,ge,_e,fe,Se),d=0,fe=W,Se=C,ge=f,_e=M),V+=Re),Re<=0){d!=0&&(r(d,b,ge,_e,fe,Se),d=0),V!=0&&(a(V,b,ge,_e,fe,Se),V=0);break}}w<=H&&(C+=y.width[w],M+=y.width[w],Y+=y.width[w])}V!=0&&(a(V,b,ge,_e,fe,Se),V=0),d!=0&&(r(d,b,ge,_e,fe,Se),d=0)}function s(f,x,b){var y=0,k=0;do{var w=f[x++],H=f[x++];y<w&&(y=w),k<H&&(k=H)}while(x<b);return y<k&&(y=k),y}function l(f,x,b,y,k,w){var H=ae.ht[y].xlen*65536+ae.ht[k].xlen,Y=0,P;do{var V=f[x++],d=f[x++];V!=0&&(V>14&&(V=15,Y+=H),V*=16),d!=0&&(d>14&&(d=15,Y+=H),V+=d),Y+=ae.largetbl[V]}while(x<b);return P=Y&65535,Y>>=16,Y>P&&(Y=P,y=k),w.bits+=Y,y}function m(f,x,b,y){var k=0,w=ae.ht[1].hlen;do{var H=f[x+0]*2+f[x+1];x+=2,k+=w[H]}while(x<b);return y.bits+=k,1}function u(f,x,b,y,k){var w=0,H,Y=ae.ht[y].xlen,P;y==2?P=ae.table23:P=ae.table56;do{var V=f[x+0]*Y+f[x+1];x+=2,w+=P[V]}while(x<b);return H=w&65535,w>>=16,w>H&&(w=H,y++),k.bits+=w,y}function h(f,x,b,y,k){var w=0,H=0,Y=0,P=ae.ht[y].xlen,V=ae.ht[y].hlen,d=ae.ht[y+1].hlen,M=ae.ht[y+2].hlen;do{var W=f[x+0]*P+f[x+1];x+=2,w+=V[W],H+=d[W],Y+=M[W]}while(x<b);var C=y;return w>H&&(w=H,C++),w>Y&&(w=Y,C=y+2),k.bits+=w,C}var c=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function _(f,x,b,y){var k=s(f,x,b);switch(k){case 0:return k;case 1:return m(f,x,b,y);case 2:case 3:return u(f,x,b,c[k-1],y);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return h(f,x,b,c[k-1],y);default:if(k>Ut.IXMAX_VAL)return y.bits=Ut.LARGE_BITS,-1;k-=15;var w;for(w=24;w<32&&!(ae.ht[w].linmax>=k);w++);var H;for(H=w-8;H<24&&!(ae.ht[H].linmax>=k);H++);return l(f,x,b,H,w,y)}}this.noquant_count_bits=function(f,x,b){var y=x.l3_enc,k=Math.min(576,x.max_nonzero_coeff+2>>1<<1);for(b!=null&&(b.sfb_count1=0);k>1&&(y[k-1]|y[k-2])==0;k-=2);x.count1=k;for(var w=0,H=0;k>3;k-=4){var Y;if(((y[k-1]|y[k-2]|y[k-3]|y[k-4])&2147483647)>1)break;Y=((y[k-4]*2+y[k-3])*2+y[k-2])*2+y[k-1],w+=ae.t32l[Y],H+=ae.t33l[Y]}var P=w;if(x.count1table_select=0,w>H&&(P=H,x.count1table_select=1),x.count1bits=P,x.big_values=k,k==0)return P;if(x.block_type==F.SHORT_TYPE)w=3*f.scalefac_band.s[3],w>x.big_values&&(w=x.big_values),H=x.big_values;else if(x.block_type==F.NORM_TYPE){if(w=x.region0_count=f.bv_scf[k-2],H=x.region1_count=f.bv_scf[k-1],H=f.scalefac_band.l[w+H+2],w=f.scalefac_band.l[w+1],H<k){var V=new t(P);x.table_select[2]=_(y,H,k,V),P=V.bits}}else x.region0_count=7,x.region1_count=F.SBMAX_l-1-7-1,w=f.scalefac_band.l[7+1],H=k,w>H&&(w=H);if(w=Math.min(w,k),H=Math.min(H,k),w>0){var V=new t(P);x.table_select[0]=_(y,0,w,V),P=V.bits}if(w<H){var V=new t(P);x.table_select[1]=_(y,w,H,V),P=V.bits}if(f.use_best_huffman==2&&(x.part2_3_length=P,best_huffman_divide(f,x),P=x.part2_3_length),b!=null&&x.block_type==F.NORM_TYPE){for(var d=0;f.scalefac_band.l[d]<x.big_values;)d++;b.sfb_count1=d}return P},this.count_bits=function(f,x,b,y){var k=b.l3_enc,w=Ut.IXMAX_VAL/e.IPOW20(b.global_gain);if(b.xrpow_max>w)return Ut.LARGE_BITS;if(i(x,k,e.IPOW20(b.global_gain),b,y),(f.substep_shaping&2)!=0)for(var H=0,Y=b.global_gain+b.scalefac_scale,P=.634521682242439/e.IPOW20(Y),V=0;V<b.sfbmax;V++){var d=b.width[V];if(f.pseudohalf[V]==0)H+=d;else{var M;for(M=H,H+=d;M<H;++M)k[M]=x[M]>=P?k[M]:0}}return this.noquant_count_bits(f,b,y)};function p(f,x,b,y,k,w,H){for(var Y=x.big_values,P=0;P<=7+15;P++)y[P]=Ut.LARGE_BITS;for(var P=0;P<16;P++){var V=f.scalefac_band.l[P+1];if(V>=Y)break;var d=0,M=new t(d),W=_(b,0,V,M);d=M.bits;for(var C=0;C<8;C++){var fe=f.scalefac_band.l[P+C+2];if(fe>=Y)break;var Se=d;M=new t(Se);var ge=_(b,V,fe,M);Se=M.bits,y[P+C]>Se&&(y[P+C]=Se,k[P+C]=P,w[P+C]=W,H[P+C]=ge)}}}function o(f,x,b,y,k,w,H,Y){for(var P=x.big_values,V=2;V<F.SBMAX_l+1;V++){var d=f.scalefac_band.l[V];if(d>=P)break;var M=k[V-2]+x.count1bits;if(b.part2_3_length<=M)break;var W=new t(M),C=_(y,d,P,W);M=W.bits,!(b.part2_3_length<=M)&&(b.assign(x),b.part2_3_length=M,b.region0_count=w[V-2],b.region1_count=V-2-w[V-2],b.table_select[0]=H[V-2],b.table_select[1]=Y[V-2],b.table_select[2]=C)}}this.best_huffman_divide=function(f,x){var b=new Da,y=x.l3_enc,k=Oi(7+15+1),w=Oi(7+15+1),H=Oi(7+15+1),Y=Oi(7+15+1);if(!(x.block_type==F.SHORT_TYPE&&f.mode_gr==1)){b.assign(x),x.block_type==F.NORM_TYPE&&(p(f,x,y,k,w,H,Y),o(f,b,x,y,k,w,H,Y));var P=b.big_values;if(!(P==0||(y[P-2]|y[P-1])>1)&&(P=x.count1+2,!(P>576))){b.assign(x),b.count1=P;for(var V=0,d=0;P>b.big_values;P-=4){var M=((y[P-4]*2+y[P-3])*2+y[P-2])*2+y[P-1];V+=ae.t32l[M],d+=ae.t33l[M]}if(b.big_values=P,b.count1table_select=0,V>d&&(V=d,b.count1table_select=1),b.count1bits=V,b.block_type==F.NORM_TYPE)o(f,b,x,y,k,w,H,Y);else{if(b.part2_3_length=V,V=f.scalefac_band.l[7+1],V>P&&(V=P),V>0){var W=new t(b.part2_3_length);b.table_select[0]=_(y,0,V,W),b.part2_3_length=W.bits}if(P>V){var W=new t(b.part2_3_length);b.table_select[1]=_(y,V,P,W),b.part2_3_length=W.bits}x.part2_3_length>b.part2_3_length&&x.assign(b)}}}};var j=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],O=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],I=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],v=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Li.slen1_tab=I,Li.slen2_tab=v;function E(f,x){for(var b,y=x.tt[1][f],k=x.tt[0][f],w=0;w<ae.scfsi_band.length-1;w++){for(b=ae.scfsi_band[w];b<ae.scfsi_band[w+1]&&!(k.scalefac[b]!=y.scalefac[b]&&y.scalefac[b]>=0);b++);if(b==ae.scfsi_band[w+1]){for(b=ae.scfsi_band[w];b<ae.scfsi_band[w+1];b++)y.scalefac[b]=-1;x.scfsi[f][w]=1}}var H=0,Y=0;for(b=0;b<11;b++)y.scalefac[b]!=-1&&(Y++,H<y.scalefac[b]&&(H=y.scalefac[b]));for(var P=0,V=0;b<F.SBPSY_l;b++)y.scalefac[b]!=-1&&(V++,P<y.scalefac[b]&&(P=y.scalefac[b]));for(var w=0;w<16;w++)if(H<j[w]&&P<O[w]){var d=I[w]*Y+v[w]*V;y.part2_length>d&&(y.part2_length=d,y.scalefac_compress=w)}}this.best_scalefac_store=function(f,x,b,y){var k=y.tt[x][b],w,H,Y,P,V=0;for(Y=0,w=0;w<k.sfbmax;w++){var d=k.width[w];for(Y+=d,P=-d;P<0&&k.l3_enc[P+Y]==0;P++);P==0&&(k.scalefac[w]=V=-2)}if(k.scalefac_scale==0&&k.preflag==0){var M=0;for(w=0;w<k.sfbmax;w++)k.scalefac[w]>0&&(M|=k.scalefac[w]);if((M&1)==0&&M!=0){for(w=0;w<k.sfbmax;w++)k.scalefac[w]>0&&(k.scalefac[w]>>=1);k.scalefac_scale=V=1}}if(k.preflag==0&&k.block_type!=F.SHORT_TYPE&&f.mode_gr==2){for(w=11;w<F.SBPSY_l&&!(k.scalefac[w]<e.pretab[w]&&k.scalefac[w]!=-2);w++);if(w==F.SBPSY_l){for(w=11;w<F.SBPSY_l;w++)k.scalefac[w]>0&&(k.scalefac[w]-=e.pretab[w]);k.preflag=V=1}}for(H=0;H<4;H++)y.scfsi[b][H]=0;for(f.mode_gr==2&&x==1&&y.tt[0][b].block_type!=F.SHORT_TYPE&&y.tt[1][b].block_type!=F.SHORT_TYPE&&(E(b,y),V=0),w=0;w<k.sfbmax;w++)k.scalefac[w]==-2&&(k.scalefac[w]=0);V!=0&&(f.mode_gr==2?this.scale_bitcount(k):this.scale_bitcount_lsf(f,k))};function L(f,x){for(var b=0;b<x;++b)if(f[b]<0)return!1;return!0}var T=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],R=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],g=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(f){var x,b,y=0,k=0,w,H=f.scalefac;if(Eo(L(H,f.sfbmax)),f.block_type==F.SHORT_TYPE)w=T,f.mixed_block_flag!=0&&(w=R);else if(w=g,f.preflag==0){for(b=11;b<F.SBPSY_l&&!(H[b]<e.pretab[b]);b++);if(b==F.SBPSY_l)for(f.preflag=1,b=11;b<F.SBPSY_l;b++)H[b]-=e.pretab[b]}for(b=0;b<f.sfbdivide;b++)y<H[b]&&(y=H[b]);for(;b<f.sfbmax;b++)k<H[b]&&(k=H[b]);for(f.part2_length=Ut.LARGE_BITS,x=0;x<16;x++)y<j[x]&&k<O[x]&&f.part2_length>w[x]&&(f.part2_length=w[x],f.scalefac_compress=x);return f.part2_length==Ut.LARGE_BITS};var A=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(f,x){var b,y,k,w,H,Y,P,V,d=Oi(4),M=x.scalefac;for(x.preflag!=0?b=2:b=0,P=0;P<4;P++)d[P]=0;if(x.block_type==F.SHORT_TYPE){y=1;var W=e.nr_of_sfb_block[b][y];for(V=0,k=0;k<4;k++)for(w=W[k]/3,P=0;P<w;P++,V++)for(H=0;H<3;H++)M[V*3+H]>d[k]&&(d[k]=M[V*3+H])}else{y=0;var W=e.nr_of_sfb_block[b][y];for(V=0,k=0;k<4;k++)for(w=W[k],P=0;P<w;P++,V++)M[V]>d[k]&&(d[k]=M[V])}for(Y=!1,k=0;k<4;k++)d[k]>A[b][k]&&(Y=!0);if(!Y){var C,fe,Se,ge;for(x.sfb_partition_table=e.nr_of_sfb_block[b][y],k=0;k<4;k++)x.slen[k]=S[d[k]];switch(C=x.slen[0],fe=x.slen[1],Se=x.slen[2],ge=x.slen[3],b){case 0:x.scalefac_compress=(C*5+fe<<4)+(Se<<2)+ge;break;case 1:x.scalefac_compress=400+(C*5+fe<<2)+Se;break;case 2:x.scalefac_compress=500+C*3+fe;break;default:m3.err.printf(`intensity stereo not implemented yet
`);break}}if(!Y)for(Eo(x.sfb_partition_table!=null),x.part2_length=0,k=0;k<4;k++)x.part2_length+=x.slen[k]*x.sfb_partition_table[k];return Y};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(f){for(var x=2;x<=576;x+=2){for(var b=0,y;f.scalefac_band.l[++b]<x;);for(y=n[b][0];f.scalefac_band.l[y+1]>x;)y--;for(y<0&&(y=n[b][0]),f.bv_scf[x-2]=y,y=n[b][1];f.scalefac_band.l[y+f.bv_scf[x-2]+2]>x;)y--;y<0&&(y=n[b][1]),f.bv_scf[x-1]=y}}}var Fn=Ie.System,h3=Ie.Arrays,p3=Ie.new_byte,v3=Ie.new_float_n,_3=Ie.new_int,Lt=Ie.assert;pn.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=Math.abs(e)*1e-6:Math.abs(e-t)<=Math.abs(t)*1e-6},pn.NEQ=function(e,t){return!pn.EQ(e,t)};function pn(){var e=this,t=32773,n=null,r=null,a=null,i=null;this.setModules=function(A,S,f,x){n=A,r=S,a=f,i=x};var s=null,l=0,m=0,u=0;this.getframebits=function(A){var S=A.internal_flags,f;S.bitrate_index!=0?f=ae.bitrate_table[A.version][S.bitrate_index]:f=A.brate;var x=0|(A.version+1)*72e3*f/A.out_samplerate+S.padding;return 8*x};function h(A){Fn.arraycopy(A.header[A.w_ptr].buf,0,s,m,A.sideinfo_len),m+=A.sideinfo_len,l+=A.sideinfo_len*8,A.w_ptr=A.w_ptr+1&ut.MAX_HEADER_BUF-1}function c(A,S,f){for(;f>0;){var x;u==0&&(u=8,m++,Lt(A.header[A.w_ptr].write_timing>=l),A.header[A.w_ptr].write_timing==l&&h(A),s[m]=0),x=Math.min(f,u),f-=x,u-=x,s[m]|=S>>f<<u,l+=x}}function _(A,S,f){for(;f>0;){var x;u==0&&(u=8,m++,s[m]=0),x=Math.min(f,u),f-=x,u-=x,s[m]|=S>>f<<u,l+=x}}function p(A,S){var f=A.internal_flags,x;if(S>=8&&(c(f,76,8),S-=8),S>=8&&(c(f,65,8),S-=8),S>=8&&(c(f,77,8),S-=8),S>=8&&(c(f,69,8),S-=8),S>=32){var b=a.getLameShortVersion();if(S>=32)for(x=0;x<b.length&&S>=8;++x)S-=8,c(f,b.charAt(x),8)}for(;S>=1;S-=1)c(f,f.ancillary_flag,1),f.ancillary_flag^=A.disable_reservoir?0:1}function o(A,S,f){for(var x=A.header[A.h_ptr].ptr;f>0;){var b=Math.min(f,8-(x&7));f-=b,A.header[A.h_ptr].buf[x>>3]|=S>>f<<8-(x&7)-b,x+=b}A.header[A.h_ptr].ptr=x}function j(A,S){A<<=8;for(var f=0;f<8;f++)A<<=1,S<<=1,((S^A)&65536)!=0&&(S^=t);return S}this.CRC_writeheader=function(A,S){var f=65535;f=j(S[2]&255,f),f=j(S[3]&255,f);for(var x=6;x<A.sideinfo_len;x++)f=j(S[x]&255,f);S[4]=byte(f>>8),S[5]=byte(f&255)};function O(A,S){var f=A.internal_flags,x,b,y;if(x=f.l3_side,f.header[f.h_ptr].ptr=0,h3.fill(f.header[f.h_ptr].buf,0,f.sideinfo_len,0),A.out_samplerate<16e3?o(f,4094,12):o(f,4095,12),o(f,A.version,1),o(f,4-3,2),o(f,A.error_protection?0:1,1),o(f,f.bitrate_index,4),o(f,f.samplerate_index,2),o(f,f.padding,1),o(f,A.extension,1),o(f,A.mode.ordinal(),2),o(f,f.mode_ext,2),o(f,A.copyright,1),o(f,A.original,1),o(f,A.emphasis,2),A.error_protection&&o(f,0,16),A.version==1){for(Lt(x.main_data_begin>=0),o(f,x.main_data_begin,9),f.channels_out==2?o(f,x.private_bits,3):o(f,x.private_bits,5),y=0;y<f.channels_out;y++){var k;for(k=0;k<4;k++)o(f,x.scfsi[y][k],1)}for(b=0;b<2;b++)for(y=0;y<f.channels_out;y++){var w=x.tt[b][y];o(f,w.part2_3_length+w.part2_length,12),o(f,w.big_values/2,9),o(f,w.global_gain,8),o(f,w.scalefac_compress,4),w.block_type!=F.NORM_TYPE?(o(f,1,1),o(f,w.block_type,2),o(f,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),o(f,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),o(f,w.table_select[1],5),o(f,w.subblock_gain[0],3),o(f,w.subblock_gain[1],3),o(f,w.subblock_gain[2],3)):(o(f,0,1),w.table_select[0]==14&&(w.table_select[0]=16),o(f,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),o(f,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),o(f,w.table_select[2],5),Lt(w.region0_count>=0&&w.region0_count<16),Lt(w.region1_count>=0&&w.region1_count<8),o(f,w.region0_count,4),o(f,w.region1_count,3)),o(f,w.preflag,1),o(f,w.scalefac_scale,1),o(f,w.count1table_select,1)}}else for(Lt(x.main_data_begin>=0),o(f,x.main_data_begin,8),o(f,x.private_bits,f.channels_out),b=0,y=0;y<f.channels_out;y++){var w=x.tt[b][y];o(f,w.part2_3_length+w.part2_length,12),o(f,w.big_values/2,9),o(f,w.global_gain,8),o(f,w.scalefac_compress,9),w.block_type!=F.NORM_TYPE?(o(f,1,1),o(f,w.block_type,2),o(f,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),o(f,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),o(f,w.table_select[1],5),o(f,w.subblock_gain[0],3),o(f,w.subblock_gain[1],3),o(f,w.subblock_gain[2],3)):(o(f,0,1),w.table_select[0]==14&&(w.table_select[0]=16),o(f,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),o(f,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),o(f,w.table_select[2],5),Lt(w.region0_count>=0&&w.region0_count<16),Lt(w.region1_count>=0&&w.region1_count<8),o(f,w.region0_count,4),o(f,w.region1_count,3)),o(f,w.scalefac_scale,1),o(f,w.count1table_select,1)}A.error_protection&&CRC_writeheader(f,f.header[f.h_ptr].buf);{var H=f.h_ptr;Lt(f.header[H].ptr==f.sideinfo_len*8),f.h_ptr=H+1&ut.MAX_HEADER_BUF-1,f.header[f.h_ptr].write_timing=f.header[H].write_timing+S,f.h_ptr==f.w_ptr&&Fn.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function I(A,S){var f=ae.ht[S.count1table_select+32],x,b=0,y=S.big_values,k=S.big_values;for(Lt(S.count1table_select<2),x=(S.count1-S.big_values)/4;x>0;--x){var w=0,H=0,Y;Y=S.l3_enc[y+0],Y!=0&&(H+=8,S.xr[k+0]<0&&w++),Y=S.l3_enc[y+1],Y!=0&&(H+=4,w*=2,S.xr[k+1]<0&&w++),Y=S.l3_enc[y+2],Y!=0&&(H+=2,w*=2,S.xr[k+2]<0&&w++),Y=S.l3_enc[y+3],Y!=0&&(H++,w*=2,S.xr[k+3]<0&&w++),y+=4,k+=4,c(A,w+f.table[H],f.hlen[H]),b+=f.hlen[H]}return b}function v(A,S,f,x,b){var y=ae.ht[S],k=0;if(S==0)return k;for(var w=f;w<x;w+=2){var H=0,Y=0,P=y.xlen,V=y.xlen,d=0,M=b.l3_enc[w],W=b.l3_enc[w+1];if(M!=0&&(b.xr[w]<0&&d++,H--),S>15){if(M>14){var C=M-15;Lt(C<=y.linmax),d|=C<<1,Y=P,M=15}if(W>14){var fe=W-15;Lt(fe<=y.linmax),d<<=P,d|=fe,Y+=P,W=15}V=16}W!=0&&(d<<=1,b.xr[w+1]<0&&d++,H--),M=M*V+W,Y-=H,H+=y.hlen[M],c(A,y.table[M],H),c(A,d,Y),k+=H+Y}return k}function E(A,S){var f=3*A.scalefac_band.s[3];f>S.big_values&&(f=S.big_values);var x=v(A,S.table_select[0],0,f,S);return x+=v(A,S.table_select[1],f,S.big_values,S),x}function L(A,S){var f,x,b,y;f=S.big_values;var k=S.region0_count+1;return Lt(k<A.scalefac_band.l.length),b=A.scalefac_band.l[k],k+=S.region1_count+1,Lt(k<A.scalefac_band.l.length),y=A.scalefac_band.l[k],b>f&&(b=f),y>f&&(y=f),x=v(A,S.table_select[0],0,b,S),x+=v(A,S.table_select[1],b,y,S),x+=v(A,S.table_select[2],y,f,S),x}function T(A){var S,f,x,b,y=0,k=A.internal_flags,w=k.l3_side;if(A.version==1)for(S=0;S<2;S++)for(f=0;f<k.channels_out;f++){var H=w.tt[S][f],Y=Li.slen1_tab[H.scalefac_compress],P=Li.slen2_tab[H.scalefac_compress];for(b=0,x=0;x<H.sfbdivide;x++)H.scalefac[x]!=-1&&(c(k,H.scalefac[x],Y),b+=Y);for(;x<H.sfbmax;x++)H.scalefac[x]!=-1&&(c(k,H.scalefac[x],P),b+=P);Lt(b==H.part2_length),H.block_type==F.SHORT_TYPE?b+=E(k,H):b+=L(k,H),b+=I(k,H),Lt(b==H.part2_3_length+H.part2_length),y+=b}else for(S=0,f=0;f<k.channels_out;f++){var H=w.tt[S][f],V,d,M=0;if(Lt(H.sfb_partition_table!=null),b=0,x=0,d=0,H.block_type==F.SHORT_TYPE){for(;d<4;d++){var W=H.sfb_partition_table[d]/3,C=H.slen[d];for(V=0;V<W;V++,x++)c(k,Math.max(H.scalefac[x*3+0],0),C),c(k,Math.max(H.scalefac[x*3+1],0),C),c(k,Math.max(H.scalefac[x*3+2],0),C),M+=3*C}b+=E(k,H)}else{for(;d<4;d++){var W=H.sfb_partition_table[d],C=H.slen[d];for(V=0;V<W;V++,x++)c(k,Math.max(H.scalefac[x],0),C),M+=C}b+=L(k,H)}b+=I(k,H),Lt(b==H.part2_3_length),Lt(M==H.part2_length),y+=M+b}return y}function R(){this.total=0}function g(A,S){var f=A.internal_flags,x,b,y,k,w;return w=f.w_ptr,k=f.h_ptr-1,k==-1&&(k=ut.MAX_HEADER_BUF-1),x=f.header[k].write_timing-l,S.total=x,x>=0&&(b=1+k-w,k<w&&(b=1+k-w+ut.MAX_HEADER_BUF),x-=b*8*f.sideinfo_len),y=e.getframebits(A),x+=y,S.total+=y,S.total%8!=0?S.total=1+S.total/8:S.total=S.total/8,S.total+=m+1,x<0&&Fn.err.println(`strange error flushing buffer ... 
`),x}this.flush_bitstream=function(A){var S=A.internal_flags,f,x,b=S.h_ptr-1;if(b==-1&&(b=ut.MAX_HEADER_BUF-1),f=S.l3_side,!((x=g(A,new R))<0)){if(p(A,x),Lt(S.header[b].write_timing+this.getframebits(A)==l),S.ResvSize=0,f.main_data_begin=0,S.findReplayGain){var y=n.GetTitleGain(S.rgdata);Lt(NEQ(y,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),S.RadioGain=Math.floor(y*10+.5)|0}S.findPeakSample&&(S.noclipGainChange=Math.ceil(Math.log10(S.PeakSample/32767)*20*10)|0,S.noclipGainChange>0&&(EQ(A.scale,1)||EQ(A.scale,0))?S.noclipScale=Math.floor(32767/S.PeakSample*100)/100:S.noclipScale=-1)}},this.add_dummy_byte=function(A,S,f){for(var x=A.internal_flags,b;f-- >0;)for(_(x,S,8),b=0;b<ut.MAX_HEADER_BUF;++b)x.header[b].write_timing+=8},this.format_bitstream=function(A){var S=A.internal_flags,f;f=S.l3_side;var x=this.getframebits(A);p(A,f.resvDrain_pre),O(A,x);var b=8*S.sideinfo_len;if(b+=T(A),p(A,f.resvDrain_post),b+=f.resvDrain_post,f.main_data_begin+=(x-b)/8,g(A,new R)!=S.ResvSize&&Fn.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),f.main_data_begin*8!=S.ResvSize&&(Fn.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*f.main_data_begin,S.ResvSize,f.resvDrain_post,f.resvDrain_pre,8*S.sideinfo_len,b-f.resvDrain_post-8*S.sideinfo_len,b,b%8,x),Fn.err.println("This is a fatal error.  It has several possible causes:"),Fn.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Fn.err.println(" 9%%  Your system is overclocked"),Fn.err.println(" 1%%  bug in LAME encoding library"),S.ResvSize=f.main_data_begin*8),l>1e9){var y;for(y=0;y<ut.MAX_HEADER_BUF;++y)S.header[y].write_timing-=l;l=0}return 0},this.copy_buffer=function(A,S,f,x,b){var y=m+1;if(y<=0)return 0;if(x!=0&&y>x)return-1;if(Fn.arraycopy(s,0,S,f,y),m=-1,u=0,b!=0){var k=_3(1);if(k[0]=A.nMusicCRC,i.updateMusicCRC(k,S,f,y),A.nMusicCRC=k[0],y>0&&(A.VBR_seek_table.nBytesWritten+=y),A.decode_on_the_fly){for(var w=v3([2,1152]),H=y,Y=-1,P;Y!=0;)if(Y=r.hip_decode1_unclipped(A.hip,S,f,H,w[0],w[1]),H=0,Y==-1&&(Y=0),Y>0){if(A.findPeakSample){for(P=0;P<Y;P++)w[0][P]>A.PeakSample?A.PeakSample=w[0][P]:-w[0][P]>A.PeakSample&&(A.PeakSample=-w[0][P]);if(A.channels_out>1)for(P=0;P<Y;P++)w[1][P]>A.PeakSample?A.PeakSample=w[1][P]:-w[1][P]>A.PeakSample&&(A.PeakSample=-w[1][P])}if(A.findReplayGain&&n.AnalyzeSamples(A.rgdata,w[0],0,w[1],0,Y,A.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return y},this.init_bit_stream_w=function(A){s=p3(Je.LAME_MAXMP3BUFFER),A.h_ptr=A.w_ptr=0,A.header[A.h_ptr].write_timing=0,m=-1,u=0,l=0}}var g3=Ie.System,kt=Ie.VbrMode,To=Ie.ShortBlock,Br=Ie.new_float,Du=Ie.new_int_n,b3=Ie.new_short_n,lr=Ie.assert;function Je(){var e=this,t=128*1024;Je.V9=410,Je.V8=420,Je.V7=430,Je.V6=440,Je.V5=450,Je.V4=460,Je.V3=470,Je.V2=480,Je.V1=490,Je.V0=500,Je.R3MIX=1e3,Je.STANDARD=1001,Je.EXTREME=1002,Je.INSANE=1003,Je.STANDARD_FAST=1004,Je.EXTREME_FAST=1005,Je.MEDIUM=1006,Je.MEDIUM_FAST=1007;var n=16384+t;Je.LAME_MAXMP3BUFFER=n;var r,a,i,s,l,m=new So,u,h,c;this.enc=new F,this.setModules=function(d,M,W,C,fe,Se,ge,_e,He){r=d,a=M,i=W,s=C,l=fe,u=Se,h=_e,c=He,this.enc.setModules(a,m,s,u)};function _(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=Br(F.SBMAX_l),this.bo_s_weight=Br(F.SBMAX_s)}function p(){this.lowerlimit=0}function o(d,M){this.lowpass=M}var j=4294479419;function O(d){var M;return d.class_id=j,M=d.internal_flags=new ut,d.mode=dt.NOT_SET,d.original=1,d.in_samplerate=44100,d.num_channels=2,d.num_samples=-1,d.bWriteVbrTag=!0,d.quality=-1,d.short_blocks=null,M.subblock_gain=-1,d.lowpassfreq=0,d.highpassfreq=0,d.lowpasswidth=-1,d.highpasswidth=-1,d.VBR=kt.vbr_off,d.VBR_q=4,d.ATHcurve=-1,d.VBR_mean_bitrate_kbps=128,d.VBR_min_bitrate_kbps=0,d.VBR_max_bitrate_kbps=0,d.VBR_hard_min=0,M.VBR_min_bitrate=1,M.VBR_max_bitrate=13,d.quant_comp=-1,d.quant_comp_short=-1,d.msfix=-1,M.resample_ratio=1,M.OldValue[0]=180,M.OldValue[1]=180,M.CurrentStep[0]=4,M.CurrentStep[1]=4,M.masking_lower=1,M.nsPsy.attackthre=-1,M.nsPsy.attackthre_s=-1,d.scale=-1,d.athaa_type=-1,d.ATHtype=-1,d.athaa_loudapprox=-1,d.athaa_sensitivity=0,d.useTemporal=null,d.interChRatio=-1,M.mf_samples_to_encode=F.ENCDELAY+F.POSTDELAY,d.encoder_padding=0,M.mf_size=F.ENCDELAY-F.MDCTDELAY,d.findReplayGain=!1,d.decode_on_the_fly=!1,M.decode_on_the_fly=!1,M.findReplayGain=!1,M.findPeakSample=!1,M.RadioGain=0,M.AudiophileGain=0,M.noclipGainChange=0,M.noclipScale=-1,d.preset=0,d.write_id3tag_automatic=!0,0}this.lame_init=function(){var d=new Jg;return O(d),d.lame_allocated_gfp=1,d};function I(d){return d>1?0:d<=0?1:Math.cos(Math.PI/2*d)}this.nearestBitrateFullIndex=function(d){var M=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],W=0,C=0,fe=0,Se=0;Se=M[16],fe=16,C=M[16],W=16;for(var ge=0;ge<16;ge++)if(Math.max(d,M[ge+1])!=d){Se=M[ge+1],fe=ge+1,C=M[ge],W=ge;break}return Se-d>d-C?W:fe};function v(d,M){var W=44100;return M>=48e3?W=48e3:M>=44100?W=44100:M>=32e3?W=32e3:M>=24e3?W=24e3:M>=22050?W=22050:M>=16e3?W=16e3:M>=12e3?W=12e3:M>=11025?W=11025:M>=8e3&&(W=8e3),d==-1?W:(d<=15960&&(W=44100),d<=15250&&(W=32e3),d<=11220&&(W=24e3),d<=9970&&(W=22050),d<=7230&&(W=16e3),d<=5420&&(W=12e3),d<=4510&&(W=11025),d<=3970&&(W=8e3),M<W?M>44100?48e3:M>32e3?44100:M>24e3?32e3:M>22050?24e3:M>16e3?22050:M>12e3?16e3:M>11025?12e3:M>8e3?11025:8e3:W)}function E(d,M){switch(d){case 44100:return M.version=1,0;case 48e3:return M.version=1,1;case 32e3:return M.version=1,2;case 22050:return M.version=0,0;case 24e3:return M.version=0,1;case 16e3:return M.version=0,2;case 11025:return M.version=0,0;case 12e3:return M.version=0,1;case 8e3:return M.version=0,2;default:return M.version=0,-1}}function L(d,M,W){W<16e3&&(M=2);for(var C=ae.bitrate_table[M][1],fe=2;fe<=14;fe++)ae.bitrate_table[M][fe]>0&&Math.abs(ae.bitrate_table[M][fe]-d)<Math.abs(C-d)&&(C=ae.bitrate_table[M][fe]);return C}function T(d,M,W){W<16e3&&(M=2);for(var C=0;C<=14;C++)if(ae.bitrate_table[M][C]>0&&ae.bitrate_table[M][C]==d)return C;return-1}function R(d,M){var W=[new o(8,2e3),new o(16,3700),new o(24,3900),new o(32,5500),new o(40,7e3),new o(48,7500),new o(56,1e4),new o(64,11e3),new o(80,13500),new o(96,15100),new o(112,15600),new o(128,17e3),new o(160,17500),new o(192,18600),new o(224,19400),new o(256,19700),new o(320,20500)],C=e.nearestBitrateFullIndex(M);d.lowerlimit=W[C].lowpass}function g(d){var M=d.internal_flags,W=32,C=-1;if(M.lowpass1>0){for(var fe=999,Se=0;Se<=31;Se++){var ge=Se/31;ge>=M.lowpass2&&(W=Math.min(W,Se)),M.lowpass1<ge&&ge<M.lowpass2&&(fe=Math.min(fe,Se))}fe==999?M.lowpass1=(W-.75)/31:M.lowpass1=(fe-.75)/31,M.lowpass2=W/31}if(M.highpass2>0&&M.highpass2<.9*(.75/31)&&(M.highpass1=0,M.highpass2=0,g3.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),M.highpass2>0){for(var _e=-1,Se=0;Se<=31;Se++){var ge=Se/31;ge<=M.highpass1&&(C=Math.max(C,Se)),M.highpass1<ge&&ge<M.highpass2&&(_e=Math.max(_e,Se))}M.highpass1=C/31,_e==-1?M.highpass2=(C+.75)/31:M.highpass2=(_e+.75)/31}for(var Se=0;Se<32;Se++){var He,Re,ge=Se/31;M.highpass2>M.highpass1?He=I((M.highpass2-ge)/(M.highpass2-M.highpass1+1e-20)):He=1,M.lowpass2>M.lowpass1?Re=I((ge-M.lowpass1)/(M.lowpass2-M.lowpass1+1e-20)):Re=1,M.amp_filter[Se]=He*Re}}function A(d){var M=d.internal_flags;switch(d.quality){default:case 9:M.psymodel=0,M.noise_shaping=0,M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.use_best_huffman=0,M.full_outer_loop=0;break;case 8:d.quality=7;case 7:M.psymodel=1,M.noise_shaping=0,M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.use_best_huffman=0,M.full_outer_loop=0;break;case 6:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=0,M.full_outer_loop=0;break;case 5:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=0,M.full_outer_loop=0;break;case 4:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=0,M.noise_shaping_stop=0,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 3:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.noise_shaping_amp=1,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 2:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=1,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 1:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=2,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break;case 0:M.psymodel=1,M.noise_shaping==0&&(M.noise_shaping=1),M.substep_shaping==0&&(M.substep_shaping=2),M.noise_shaping_amp=2,M.noise_shaping_stop=1,M.subblock_gain==-1&&(M.subblock_gain=1),M.use_best_huffman=1,M.full_outer_loop=0;break}}function S(d){var M=d.internal_flags;d.frameNum=0,d.write_id3tag_automatic&&h.id3tag_write_v2(d),M.bitrate_stereoMode_Hist=Du([16,4+1]),M.bitrate_blockType_Hist=Du([16,4+1+1]),M.PeakSample=0,d.bWriteVbrTag&&u.InitVbrTag(d)}this.lame_init_params=function(d){var M=d.internal_flags;if(M.Class_ID=0,M.ATH==null&&(M.ATH=new o3),M.PSY==null&&(M.PSY=new _),M.rgdata==null&&(M.rgdata=new l3),M.channels_in=d.num_channels,M.channels_in==1&&(d.mode=dt.MONO),M.channels_out=d.mode==dt.MONO?1:2,M.mode_ext=F.MPG_MD_MS_LR,d.mode==dt.MONO&&(d.force_ms=!1),d.VBR==kt.vbr_off&&d.VBR_mean_bitrate_kbps!=128&&d.brate==0&&(d.brate=d.VBR_mean_bitrate_kbps),d.VBR==kt.vbr_off||d.VBR==kt.vbr_mtrh||d.VBR==kt.vbr_mt||(d.free_format=!1),d.VBR==kt.vbr_off&&d.brate==0&&pn.EQ(d.compression_ratio,0)&&(d.compression_ratio=11.025),d.VBR==kt.vbr_off&&d.compression_ratio>0&&(d.out_samplerate==0&&(d.out_samplerate=map2MP3Frequency(int(.97*d.in_samplerate))),d.brate=0|d.out_samplerate*16*M.channels_out/(1e3*d.compression_ratio),M.samplerate_index=E(d.out_samplerate,d),d.free_format||(d.brate=L(d.brate,d.version,d.out_samplerate))),d.out_samplerate!=0&&(d.out_samplerate<16e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,64)):d.out_samplerate<32e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,160)):(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,32),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,320))),d.lowpassfreq==0){var W=16e3;switch(d.VBR){case kt.vbr_off:{var C=new p;R(C,d.brate),W=C.lowerlimit;break}case kt.vbr_abr:{var C=new p;R(C,d.VBR_mean_bitrate_kbps),W=C.lowerlimit;break}case kt.vbr_rh:{var fe=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Se=fe[d.VBR_q],ge=fe[d.VBR_q+1],_e=d.VBR_q_frac;W=linear_int(Se,ge,_e)}else W=19500;break}default:{var fe=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Se=fe[d.VBR_q],ge=fe[d.VBR_q+1],_e=d.VBR_q_frac;W=linear_int(Se,ge,_e)}else W=19500}}d.mode==dt.MONO&&(d.VBR==kt.vbr_off||d.VBR==kt.vbr_abr)&&(W*=1.5),d.lowpassfreq=W|0}if(d.out_samplerate==0&&(2*d.lowpassfreq>d.in_samplerate&&(d.lowpassfreq=d.in_samplerate/2),d.out_samplerate=v(d.lowpassfreq|0,d.in_samplerate)),d.lowpassfreq=Math.min(20500,d.lowpassfreq),d.lowpassfreq=Math.min(d.out_samplerate/2,d.lowpassfreq),d.VBR==kt.vbr_off&&(d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.brate)),d.VBR==kt.vbr_abr&&(d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.VBR_mean_bitrate_kbps)),d.bWriteVbrTag||(d.findReplayGain=!1,d.decode_on_the_fly=!1,M.findPeakSample=!1),M.findReplayGain=d.findReplayGain,M.decode_on_the_fly=d.decode_on_the_fly,M.decode_on_the_fly&&(M.findPeakSample=!0),M.findReplayGain&&r.InitGainAnalysis(M.rgdata,d.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return d.internal_flags=null,-6;switch(M.decode_on_the_fly&&!d.decode_only&&(M.hip!=null&&c.hip_decode_exit(M.hip),M.hip=c.hip_decode_init()),M.mode_gr=d.out_samplerate<=24e3?1:2,d.framesize=576*M.mode_gr,d.encoder_delay=F.ENCDELAY,M.resample_ratio=d.in_samplerate/d.out_samplerate,d.VBR){case kt.vbr_mt:case kt.vbr_rh:case kt.vbr_mtrh:{var He=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];d.compression_ratio=He[d.VBR_q]}break;case kt.vbr_abr:d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.VBR_mean_bitrate_kbps);break;default:d.compression_ratio=d.out_samplerate*16*M.channels_out/(1e3*d.brate);break}if(d.mode==dt.NOT_SET&&(d.mode=dt.JOINT_STEREO),d.highpassfreq>0?(M.highpass1=2*d.highpassfreq,d.highpasswidth>=0?M.highpass2=2*(d.highpassfreq+d.highpasswidth):M.highpass2=(1+0)*2*d.highpassfreq,M.highpass1/=d.out_samplerate,M.highpass2/=d.out_samplerate):(M.highpass1=0,M.highpass2=0),d.lowpassfreq>0?(M.lowpass2=2*d.lowpassfreq,d.lowpasswidth>=0?(M.lowpass1=2*(d.lowpassfreq-d.lowpasswidth),M.lowpass1<0&&(M.lowpass1=0)):M.lowpass1=(1-0)*2*d.lowpassfreq,M.lowpass1/=d.out_samplerate,M.lowpass2/=d.out_samplerate):(M.lowpass1=0,M.lowpass2=0),g(d),M.samplerate_index=E(d.out_samplerate,d),M.samplerate_index<0)return d.internal_flags=null,-1;if(d.VBR==kt.vbr_off){if(d.free_format)M.bitrate_index=0;else if(d.brate=L(d.brate,d.version,d.out_samplerate),M.bitrate_index=T(d.brate,d.version,d.out_samplerate),M.bitrate_index<=0)return d.internal_flags=null,-1}else M.bitrate_index=1;d.analysis&&(d.bWriteVbrTag=!1),M.pinfo!=null&&(d.bWriteVbrTag=!1),a.init_bit_stream_w(M);for(var Re=M.samplerate_index+3*d.version+6*(d.out_samplerate<16e3?1:0),pe=0;pe<F.SBMAX_l+1;pe++)M.scalefac_band.l[pe]=s.sfBandIndex[Re].l[pe];for(var pe=0;pe<F.PSFB21+1;pe++){var Ve=(M.scalefac_band.l[22]-M.scalefac_band.l[21])/F.PSFB21,rt=M.scalefac_band.l[21]+pe*Ve;M.scalefac_band.psfb21[pe]=rt}M.scalefac_band.psfb21[F.PSFB21]=576;for(var pe=0;pe<F.SBMAX_s+1;pe++)M.scalefac_band.s[pe]=s.sfBandIndex[Re].s[pe];for(var pe=0;pe<F.PSFB12+1;pe++){var Ve=(M.scalefac_band.s[13]-M.scalefac_band.s[12])/F.PSFB12,rt=M.scalefac_band.s[12]+pe*Ve;M.scalefac_band.psfb12[pe]=rt}M.scalefac_band.psfb12[F.PSFB12]=192,d.version==1?M.sideinfo_len=M.channels_out==1?4+17:4+32:M.sideinfo_len=M.channels_out==1?4+9:4+17,d.error_protection&&(M.sideinfo_len+=2),S(d),M.Class_ID=j;{var z;for(z=0;z<19;z++)M.nsPsy.pefirbuf[z]=700*M.mode_gr*M.channels_out;d.ATHtype==-1&&(d.ATHtype=4)}switch(lr(d.VBR_q<=9),lr(d.VBR_q>=0),d.VBR){case kt.vbr_mt:d.VBR=kt.vbr_mtrh;case kt.vbr_mtrh:{d.useTemporal==null&&(d.useTemporal=!1),i.apply_preset(d,500-d.VBR_q*10,0),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),d.quality<5&&(d.quality=0),d.quality>5&&(d.quality=5),M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?M.sfb21_extra=!1:M.sfb21_extra=d.out_samplerate>44e3,M.iteration_loop=new VBRNewIterationLoop(l);break}case kt.vbr_rh:{i.apply_preset(d,500-d.VBR_q*10,0),M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?M.sfb21_extra=!1:M.sfb21_extra=d.out_samplerate>44e3,d.quality>6&&(d.quality=6),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),M.iteration_loop=new VBROldIterationLoop(l);break}default:{var X;M.sfb21_extra=!1,d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),X=d.VBR,X==kt.vbr_off&&(d.VBR_mean_bitrate_kbps=d.brate),i.apply_preset(d,d.VBR_mean_bitrate_kbps,0),d.VBR=X,M.PSY.mask_adjust=d.maskingadjust,M.PSY.mask_adjust_short=d.maskingadjust_short,X==kt.vbr_off?M.iteration_loop=new u3(l):M.iteration_loop=new ABRIterationLoop(l);break}}if(lr(d.scale>=0),d.VBR!=kt.vbr_off){if(M.VBR_min_bitrate=1,M.VBR_max_bitrate=14,d.out_samplerate<16e3&&(M.VBR_max_bitrate=8),d.VBR_min_bitrate_kbps!=0&&(d.VBR_min_bitrate_kbps=L(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),M.VBR_min_bitrate=T(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),M.VBR_min_bitrate<0)||d.VBR_max_bitrate_kbps!=0&&(d.VBR_max_bitrate_kbps=L(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),M.VBR_max_bitrate=T(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),M.VBR_max_bitrate<0))return-1;d.VBR_min_bitrate_kbps=ae.bitrate_table[d.version][M.VBR_min_bitrate],d.VBR_max_bitrate_kbps=ae.bitrate_table[d.version][M.VBR_max_bitrate],d.VBR_mean_bitrate_kbps=Math.min(ae.bitrate_table[d.version][M.VBR_max_bitrate],d.VBR_mean_bitrate_kbps),d.VBR_mean_bitrate_kbps=Math.max(ae.bitrate_table[d.version][M.VBR_min_bitrate],d.VBR_mean_bitrate_kbps)}return d.tune&&(M.PSY.mask_adjust+=d.tune_value_a,M.PSY.mask_adjust_short+=d.tune_value_a),A(d),lr(d.scale>=0),d.athaa_type<0?M.ATH.useAdjust=3:M.ATH.useAdjust=d.athaa_type,M.ATH.aaSensitivityP=Math.pow(10,d.athaa_sensitivity/-10),d.short_blocks==null&&(d.short_blocks=To.short_block_allowed),d.short_blocks==To.short_block_allowed&&(d.mode==dt.JOINT_STEREO||d.mode==dt.STEREO)&&(d.short_blocks=To.short_block_coupled),d.quant_comp<0&&(d.quant_comp=1),d.quant_comp_short<0&&(d.quant_comp_short=0),d.msfix<0&&(d.msfix=0),d.exp_nspsytune=d.exp_nspsytune|1,d.internal_flags.nsPsy.attackthre<0&&(d.internal_flags.nsPsy.attackthre=So.NSATTACKTHRE),d.internal_flags.nsPsy.attackthre_s<0&&(d.internal_flags.nsPsy.attackthre_s=So.NSATTACKTHRE_S),lr(d.scale>=0),d.scale<0&&(d.scale=1),d.ATHtype<0&&(d.ATHtype=4),d.ATHcurve<0&&(d.ATHcurve=4),d.athaa_loudapprox<0&&(d.athaa_loudapprox=2),d.interChRatio<0&&(d.interChRatio=0),d.useTemporal==null&&(d.useTemporal=!0),M.slot_lag=M.frac_SpF=0,d.VBR==kt.vbr_off&&(M.slot_lag=M.frac_SpF=(d.version+1)*72e3*d.brate%d.out_samplerate|0),s.iteration_init(d),m.psymodel_init(d),lr(d.scale>=0),0};function f(d,M){(d.in_buffer_0==null||d.in_buffer_nsamples<M)&&(d.in_buffer_0=Br(M),d.in_buffer_1=Br(M),d.in_buffer_nsamples=M)}this.lame_encode_flush=function(d,M,W,C){var fe=d.internal_flags,Se=b3([2,1152]),ge=0,_e,He,Re,pe,Ve=fe.mf_samples_to_encode-F.POSTDELAY,rt=x(d);if(fe.mf_samples_to_encode<1)return 0;for(_e=0,d.in_samplerate!=d.out_samplerate&&(Ve+=16*d.out_samplerate/d.in_samplerate),Re=d.framesize-Ve%d.framesize,Re<576&&(Re+=d.framesize),d.encoder_padding=Re,pe=(Ve+Re)/d.framesize;pe>0&&ge>=0;){var z=rt-fe.mf_size,X=d.frameNum;z*=d.in_samplerate,z/=d.out_samplerate,z>1152&&(z=1152),z<1&&(z=1),He=C-_e,C==0&&(He=0),ge=this.lame_encode_buffer(d,Se[0],Se[1],z,M,W,He),W+=ge,_e+=ge,pe-=X!=d.frameNum?1:0}if(fe.mf_samples_to_encode=0,ge<0||(He=C-_e,C==0&&(He=0),a.flush_bitstream(d),ge=a.copy_buffer(fe,M,W,He,1),ge<0))return ge;if(W+=ge,_e+=ge,He=C-_e,C==0&&(He=0),d.write_id3tag_automatic){if(h.id3tag_write_v1(d),ge=a.copy_buffer(fe,M,W,He,0),ge<0)return ge;_e+=ge}return _e},this.lame_encode_buffer=function(d,M,W,C,fe,Se,ge){var _e=d.internal_flags,He=[null,null];if(_e.Class_ID!=j)return-3;if(C==0)return 0;f(_e,C),He[0]=_e.in_buffer_0,He[1]=_e.in_buffer_1;for(var Re=0;Re<C;Re++)He[0][Re]=M[Re],_e.channels_in>1&&(He[1][Re]=W[Re]);return b(d,He[0],He[1],C,fe,Se,ge)};function x(d){var M=F.BLKSIZE+d.framesize-F.FFTOFFSET;return M=Math.max(M,512+d.framesize-32),M}function b(d,M,W,C,fe,Se,ge){var _e=d.internal_flags,He=0,Re,pe,Ve,rt,z,X=[null,null],ne=[null,null];if(_e.Class_ID!=j)return-3;if(C==0)return 0;if(z=a.copy_buffer(_e,fe,Se,ge,0),z<0)return z;if(Se+=z,He+=z,ne[0]=M,ne[1]=W,pn.NEQ(d.scale,0)&&pn.NEQ(d.scale,1))for(pe=0;pe<C;++pe)ne[0][pe]*=d.scale,_e.channels_out==2&&(ne[1][pe]*=d.scale);if(pn.NEQ(d.scale_left,0)&&pn.NEQ(d.scale_left,1))for(pe=0;pe<C;++pe)ne[0][pe]*=d.scale_left;if(pn.NEQ(d.scale_right,0)&&pn.NEQ(d.scale_right,1))for(pe=0;pe<C;++pe)ne[1][pe]*=d.scale_right;if(d.num_channels==2&&_e.channels_out==1)for(pe=0;pe<C;++pe)ne[0][pe]=.5*(ne[0][pe]+ne[1][pe]),ne[1][pe]=0;rt=x(d),X[0]=_e.mfbuf[0],X[1]=_e.mfbuf[1];for(var ce=0;C>0;){var de=[null,null],Me=0,Ee=0;de[0]=ne[0],de[1]=ne[1];var we=new k;if(V(d,X,de,ce,C,we),Me=we.n_in,Ee=we.n_out,_e.findReplayGain&&!_e.decode_on_the_fly&&r.AnalyzeSamples(_e.rgdata,X[0],_e.mf_size,X[1],_e.mf_size,Ee,_e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(C-=Me,ce+=Me,_e.channels_out==2,_e.mf_size+=Ee,lr(_e.mf_size<=ut.MFSIZE),_e.mf_samples_to_encode<1&&(_e.mf_samples_to_encode=F.ENCDELAY+F.POSTDELAY),_e.mf_samples_to_encode+=Ee,_e.mf_size>=rt){var Ae=ge-He;if(ge==0&&(Ae=0),Re=y(d,X[0],X[1],fe,Se,Ae),Re<0)return Re;for(Se+=Re,He+=Re,_e.mf_size-=d.framesize,_e.mf_samples_to_encode-=d.framesize,Ve=0;Ve<_e.channels_out;Ve++)for(pe=0;pe<_e.mf_size;pe++)X[Ve][pe]=X[Ve][pe+d.framesize]}}return He}function y(d,M,W,C,fe,Se){var ge=e.enc.lame_encode_mp3_frame(d,M,W,C,fe,Se);return d.frameNum++,ge}function k(){this.n_in=0,this.n_out=0}function w(){this.num_used=0}function H(d,M){return M!=0?H(M,d%M):d}function Y(d,M,W){var C=Math.PI*M;d/=W,d<0&&(d=0),d>1&&(d=1);var fe=d-.5,Se=.42-.5*Math.cos(2*d*Math.PI)+.08*Math.cos(4*d*Math.PI);return Math.abs(fe)<1e-9?C/Math.PI:Se*Math.sin(W*C*fe)/(Math.PI*W*fe)}function P(d,M,W,C,fe,Se,ge,_e,He){var Re=d.internal_flags,pe,Ve=0,rt,z=d.out_samplerate/H(d.out_samplerate,d.in_samplerate);z>ut.BPC&&(z=ut.BPC);var X=Math.abs(Re.resample_ratio-Math.floor(.5+Re.resample_ratio))<1e-4?1:0,ne=1/Re.resample_ratio;ne>1&&(ne=1);var ce=31;ce%2==0&&--ce,ce+=X;var de=ce+1;if(Re.fill_buffer_resample_init==0){for(Re.inbuf_old[0]=Br(de),Re.inbuf_old[1]=Br(de),pe=0;pe<=2*z;++pe)Re.blackfilt[pe]=Br(de);for(Re.itime[0]=0,Re.itime[1]=0,Ve=0;Ve<=2*z;Ve++){var Me=0,Ee=(Ve-z)/(2*z);for(pe=0;pe<=ce;pe++)Me+=Re.blackfilt[Ve][pe]=Y(pe-Ee,ne,ce);for(pe=0;pe<=ce;pe++)Re.blackfilt[Ve][pe]/=Me}Re.fill_buffer_resample_init=1}var we=Re.inbuf_old[He];for(rt=0;rt<C;rt++){var Ae,be;if(Ae=rt*Re.resample_ratio,Ve=0|Math.floor(Ae-Re.itime[He]),ce+Ve-ce/2>=ge)break;var Ee=Ae-Re.itime[He]-(Ve+.5*(ce%2));be=0|Math.floor(Ee*2*z+z+.5);var Pe=0;for(pe=0;pe<=ce;++pe){var je=0|pe+Ve-ce/2,ze;ze=je<0?we[de+je]:fe[Se+je],Pe+=ze*Re.blackfilt[be][pe]}M[W+rt]=Pe}if(_e.num_used=Math.min(ge,ce+Ve-ce/2),Re.itime[He]+=_e.num_used-rt*Re.resample_ratio,_e.num_used>=de)for(pe=0;pe<de;pe++)we[pe]=fe[Se+_e.num_used+pe-de];else{var Ue=de-_e.num_used;for(pe=0;pe<Ue;++pe)we[pe]=we[pe+_e.num_used];for(Ve=0;pe<de;++pe,++Ve)we[pe]=fe[Se+Ve];lr(Ve==_e.num_used)}return rt}function V(d,M,W,C,fe,Se){var ge=d.internal_flags;if(ge.resample_ratio<.9999||ge.resample_ratio>1.0001)for(var _e=0;_e<ge.channels_out;_e++){var He=new w;Se.n_out=P(d,M[_e],ge.mf_size,d.framesize,W[_e],C,fe,He,_e),Se.n_in=He.num_used}else{Se.n_out=Math.min(d.framesize,fe),Se.n_in=Se.n_out;for(var Re=0;Re<Se.n_out;++Re)M[0][ge.mf_size+Re]=W[0][C+Re],ge.channels_out==2&&(M[1][ge.mf_size+Re]=W[1][C+Re])}}}var jn=Ie.VbrMode;function x3(){function e(u,h,c,_,p,o,j,O,I,v,E,L,T,R,g){this.vbr_q=u,this.quant_comp=h,this.quant_comp_s=c,this.expY=_,this.st_lrm=p,this.st_s=o,this.masking_adj=j,this.masking_adj_short=O,this.ath_lower=I,this.ath_curve=v,this.ath_sensitivity=E,this.interch=L,this.safejoint=T,this.sfb21mod=R,this.msfix=g}function t(u,h,c,_,p,o,j,O,I,v,E,L,T,R){this.quant_comp=h,this.quant_comp_s=c,this.safejoint=_,this.nsmsfix=p,this.st_lrm=o,this.st_s=j,this.nsbass=O,this.scale=I,this.masking_adj=v,this.ath_lower=E,this.ath_curve=L,this.interch=T,this.sfscale=R}var n;this.setModules=function(u){n=u};var r=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],a=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function i(u,h,c){var _=u.VBR==jn.vbr_rh?r:a,p=u.VBR_q_frac,o=_[h],j=_[h+1],O=o;o.st_lrm=o.st_lrm+p*(j.st_lrm-o.st_lrm),o.st_s=o.st_s+p*(j.st_s-o.st_s),o.masking_adj=o.masking_adj+p*(j.masking_adj-o.masking_adj),o.masking_adj_short=o.masking_adj_short+p*(j.masking_adj_short-o.masking_adj_short),o.ath_lower=o.ath_lower+p*(j.ath_lower-o.ath_lower),o.ath_curve=o.ath_curve+p*(j.ath_curve-o.ath_curve),o.ath_sensitivity=o.ath_sensitivity+p*(j.ath_sensitivity-o.ath_sensitivity),o.interch=o.interch+p*(j.interch-o.interch),o.msfix=o.msfix+p*(j.msfix-o.msfix),m(u,O.vbr_q),c!=0?u.quant_comp=O.quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=O.quant_comp),c!=0?u.quant_comp_short=O.quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=O.quant_comp_s),O.expY!=0&&(u.experimentalY=O.expY!=0),c!=0?u.internal_flags.nsPsy.attackthre=O.st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=O.st_lrm),c!=0?u.internal_flags.nsPsy.attackthre_s=O.st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=O.st_s),c!=0?u.maskingadjust=O.masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=O.masking_adj),c!=0?u.maskingadjust_short=O.masking_adj_short:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=O.masking_adj_short),c!=0?u.ATHlower=-O.ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-O.ath_lower/10),c!=0?u.ATHcurve=O.ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=O.ath_curve),c!=0?u.athaa_sensitivity=O.ath_sensitivity:Math.abs(u.athaa_sensitivity- -1)>0||(u.athaa_sensitivity=O.ath_sensitivity),O.interch>0&&(c!=0?u.interChRatio=O.interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=O.interch)),O.safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|O.safejoint),O.sfb21mod>0&&(u.exp_nspsytune=u.exp_nspsytune|O.sfb21mod<<20),c!=0?u.msfix=O.msfix:Math.abs(u.msfix- -1)>0||(u.msfix=O.msfix),c==0&&(u.VBR_q=h,u.VBR_q_frac=p)}var s=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(u,h,c){var _=h,p=n.nearestBitrateFullIndex(h);if(u.VBR=jn.vbr_abr,u.VBR_mean_bitrate_kbps=_,u.VBR_mean_bitrate_kbps=Math.min(u.VBR_mean_bitrate_kbps,320),u.VBR_mean_bitrate_kbps=Math.max(u.VBR_mean_bitrate_kbps,8),u.brate=u.VBR_mean_bitrate_kbps,u.VBR_mean_bitrate_kbps>320&&(u.disable_reservoir=!0),s[p].safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|2),s[p].sfscale>0&&(u.internal_flags.noise_shaping=2),Math.abs(s[p].nsbass)>0){var o=int(s[p].nsbass*4);o<0&&(o+=64),u.exp_nspsytune=u.exp_nspsytune|o<<2}return c!=0?u.quant_comp=s[p].quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=s[p].quant_comp),c!=0?u.quant_comp_short=s[p].quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=s[p].quant_comp_s),c!=0?u.msfix=s[p].nsmsfix:Math.abs(u.msfix- -1)>0||(u.msfix=s[p].nsmsfix),c!=0?u.internal_flags.nsPsy.attackthre=s[p].st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=s[p].st_lrm),c!=0?u.internal_flags.nsPsy.attackthre_s=s[p].st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=s[p].st_s),c!=0?u.scale=s[p].scale:Math.abs(u.scale- -1)>0||(u.scale=s[p].scale),c!=0?u.maskingadjust=s[p].masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=s[p].masking_adj),s[p].masking_adj>0?c!=0?u.maskingadjust_short=s[p].masking_adj*.9:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=s[p].masking_adj*.9):c!=0?u.maskingadjust_short=s[p].masking_adj*1.1:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=s[p].masking_adj*1.1),c!=0?u.ATHlower=-s[p].ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-s[p].ath_lower/10),c!=0?u.ATHcurve=s[p].ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=s[p].ath_curve),c!=0?u.interChRatio=s[p].interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=s[p].interch),h}this.apply_preset=function(u,h,c){switch(h){case Je.R3MIX:{h=Je.V3,u.VBR=jn.vbr_mtrh;break}case Je.MEDIUM:{h=Je.V4,u.VBR=jn.vbr_rh;break}case Je.MEDIUM_FAST:{h=Je.V4,u.VBR=jn.vbr_mtrh;break}case Je.STANDARD:{h=Je.V2,u.VBR=jn.vbr_rh;break}case Je.STANDARD_FAST:{h=Je.V2,u.VBR=jn.vbr_mtrh;break}case Je.EXTREME:{h=Je.V0,u.VBR=jn.vbr_rh;break}case Je.EXTREME_FAST:{h=Je.V0,u.VBR=jn.vbr_mtrh;break}case Je.INSANE:return h=320,u.preset=h,l(u,h,c),u.VBR=jn.vbr_off,h}switch(u.preset=h,h){case Je.V9:return i(u,9,c),h;case Je.V8:return i(u,8,c),h;case Je.V7:return i(u,7,c),h;case Je.V6:return i(u,6,c),h;case Je.V5:return i(u,5,c),h;case Je.V4:return i(u,4,c),h;case Je.V3:return i(u,3,c),h;case Je.V2:return i(u,2,c),h;case Je.V1:return i(u,1,c),h;case Je.V0:return i(u,0,c),h}return h>=8&&h<=320?l(u,h,c):(u.preset=0,h)};function m(u,h){var c=0;return h<0&&(c=-1,h=0),h>9&&(c=-1,h=9),u.VBR_q=h,u.VBR_q_frac=0,c}}function y3(){this.setModules=function(e,t){}}function Ro(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Pu=Ie.new_float,w3=Ie.new_int;function k3(){this.global_gain=0,this.sfb_count1=0,this.step=w3(39),this.noise=Pu(39),this.noise_log=Pu(39)}var cr=Ie.System,zu=Ie.VbrMode,Io=Ie.Util,$r=Ie.Arrays,Fi=Ie.new_float,ji=Ie.assert;function S3(){var e;this.rv=null;var t;this.qupvt=null;var n,r=new y3,a;this.setModules=function(I,v,E,L){e=I,t=v,this.rv=v,n=E,this.qupvt=E,a=L,r.setModules(n,a)},this.ms_convert=function(I,v){for(var E=0;E<576;++E){var L=I.tt[v][0].xr[E],T=I.tt[v][1].xr[E];I.tt[v][0].xr[E]=(L+T)*(Io.SQRT2*.5),I.tt[v][1].xr[E]=(L-T)*(Io.SQRT2*.5)}};function i(I,v,E,L){L=0;for(var T=0;T<=E;++T){var R=Math.abs(I.xr[T]);L+=R,v[T]=Math.sqrt(R*Math.sqrt(R)),v[T]>I.xrpow_max&&(I.xrpow_max=v[T])}return L}this.init_xrpow=function(I,v,E){var L=0,T=0|v.max_nonzero_coeff;if(v.xrpow_max=0,$r.fill(E,T,576,0),L=i(v,E,T,L),L>1e-20){var R=0;(I.substep_shaping&2)!=0&&(R=1);for(var g=0;g<v.psymax;g++)I.pseudohalf[g]=R;return!0}return $r.fill(v.l3_enc,0,576,0),!1};function s(I,v){var E=I.ATH,L=v.xr;if(v.block_type!=F.SHORT_TYPE)for(var T=!1,R=F.PSFB21-1;R>=0&&!T;R--){var g=I.scalefac_band.psfb21[R],A=I.scalefac_band.psfb21[R+1],S=n.athAdjust(E.adjust,E.psfb21[R],E.floor);I.nsPsy.longfact[21]>1e-12&&(S*=I.nsPsy.longfact[21]);for(var f=A-1;f>=g;f--)if(Math.abs(L[f])<S)L[f]=0;else{T=!0;break}}else for(var x=0;x<3;x++)for(var T=!1,R=F.PSFB12-1;R>=0&&!T;R--){var g=I.scalefac_band.s[12]*3+(I.scalefac_band.s[13]-I.scalefac_band.s[12])*x+(I.scalefac_band.psfb12[R]-I.scalefac_band.psfb12[0]),A=g+(I.scalefac_band.psfb12[R+1]-I.scalefac_band.psfb12[R]),b=n.athAdjust(E.adjust,E.psfb12[R],E.floor);I.nsPsy.shortfact[12]>1e-12&&(b*=I.nsPsy.shortfact[12]);for(var f=A-1;f>=g;f--)if(Math.abs(L[f])<b)L[f]=0;else{T=!0;break}}}this.init_outer_loop=function(I,v){v.part2_3_length=0,v.big_values=0,v.count1=0,v.global_gain=210,v.scalefac_compress=0,v.table_select[0]=0,v.table_select[1]=0,v.table_select[2]=0,v.subblock_gain[0]=0,v.subblock_gain[1]=0,v.subblock_gain[2]=0,v.subblock_gain[3]=0,v.region0_count=0,v.region1_count=0,v.preflag=0,v.scalefac_scale=0,v.count1table_select=0,v.part2_length=0,v.sfb_lmax=F.SBPSY_l,v.sfb_smin=F.SBPSY_s,v.psy_lmax=I.sfb21_extra?F.SBMAX_l:F.SBPSY_l,v.psymax=v.psy_lmax,v.sfbmax=v.sfb_lmax,v.sfbdivide=11;for(var E=0;E<F.SBMAX_l;E++)v.width[E]=I.scalefac_band.l[E+1]-I.scalefac_band.l[E],v.window[E]=3;if(v.block_type==F.SHORT_TYPE){var L=Fi(576);v.sfb_smin=0,v.sfb_lmax=0,v.mixed_block_flag!=0&&(v.sfb_smin=3,v.sfb_lmax=I.mode_gr*2+4),v.psymax=v.sfb_lmax+3*((I.sfb21_extra?F.SBMAX_s:F.SBPSY_s)-v.sfb_smin),v.sfbmax=v.sfb_lmax+3*(F.SBPSY_s-v.sfb_smin),v.sfbdivide=v.sfbmax-18,v.psy_lmax=v.sfb_lmax;var T=I.scalefac_band.l[v.sfb_lmax];cr.arraycopy(v.xr,0,L,0,576);for(var E=v.sfb_smin;E<F.SBMAX_s;E++)for(var R=I.scalefac_band.s[E],g=I.scalefac_band.s[E+1],A=0;A<3;A++)for(var S=R;S<g;S++)v.xr[T++]=L[3*S+A];for(var f=v.sfb_lmax,E=v.sfb_smin;E<F.SBMAX_s;E++)v.width[f]=v.width[f+1]=v.width[f+2]=I.scalefac_band.s[E+1]-I.scalefac_band.s[E],v.window[f]=0,v.window[f+1]=1,v.window[f+2]=2,f+=3}v.count1bits=0,v.sfb_partition_table=n.nr_of_sfb_block[0][0],v.slen[0]=0,v.slen[1]=0,v.slen[2]=0,v.slen[3]=0,v.max_nonzero_coeff=575,$r.fill(v.scalefac,0),s(I,v)};function l(I){this.ordinal=I}l.BINSEARCH_NONE=new l(0),l.BINSEARCH_UP=new l(1),l.BINSEARCH_DOWN=new l(2);function m(I,v,E,L,T){var R,g=I.CurrentStep[L],A=!1,S=I.OldValue[L],f=l.BINSEARCH_NONE;for(v.global_gain=S,E-=v.part2_length;;){var x;if(R=a.count_bits(I,T,v,null),g==1||R==E)break;R>E?(f==l.BINSEARCH_DOWN&&(A=!0),A&&(g/=2),f=l.BINSEARCH_UP,x=g):(f==l.BINSEARCH_UP&&(A=!0),A&&(g/=2),f=l.BINSEARCH_DOWN,x=-g),v.global_gain+=x,v.global_gain<0&&(v.global_gain=0,A=!0),v.global_gain>255&&(v.global_gain=255,A=!0)}for(ji(v.global_gain>=0),ji(v.global_gain<256);R>E&&v.global_gain<255;)v.global_gain++,R=a.count_bits(I,T,v,null);return I.CurrentStep[L]=S-v.global_gain>=4?4:2,I.OldValue[L]=v.global_gain,v.part2_3_length=R,R}this.trancate_smallspectrums=function(I,v,E,L){var T=Fi(or.SFBMAX);if(!((I.substep_shaping&4)==0&&v.block_type==F.SHORT_TYPE||(I.substep_shaping&128)!=0)){n.calc_noise(v,E,T,new Ro,null);for(var g=0;g<576;g++){var R=0;v.l3_enc[g]!=0&&(R=Math.abs(v.xr[g])),L[g]=R}var g=0,A=8;v.block_type==F.SHORT_TYPE&&(A=6);do{var S,f,x,b,y=v.width[A];if(g+=y,!(T[A]>=1)&&($r.sort(L,g-y,y),!BitStream.EQ(L[g-1],0))){S=(1-T[A])*E[A],f=0,b=0;do{var k;for(x=1;b+x<y&&!BitStream.NEQ(L[b+g-y],L[b+g+x-y]);x++);if(k=L[b+g-y]*L[b+g-y]*x,S<k){b!=0&&(f=L[b+g-y-1]);break}S-=k,b+=x}while(b<y);if(!BitStream.EQ(f,0))do Math.abs(v.xr[g-y])<=f&&(v.l3_enc[g-y]=0);while(--y>0)}}while(++A<v.psymax);v.part2_3_length=a.noquant_count_bits(I,v,null)}};function u(I){for(var v=0;v<I.sfbmax;v++)if(I.scalefac[v]+I.subblock_gain[I.window[v]]==0)return!1;return!0}function h(I){return Io.FAST_LOG10(.368+.632*I*I*I)}function c(I,v){for(var E=1e-37,L=0;L<v.psymax;L++)E+=h(I[L]);return Math.max(1e-20,E)}function _(I,v,E,L,T){var R;switch(I){default:case 9:{v.over_count>0?(R=E.over_SSD<=v.over_SSD,E.over_SSD==v.over_SSD&&(R=E.bits<v.bits)):R=E.max_noise<0&&E.max_noise*10+E.bits<=v.max_noise*10+v.bits;break}case 0:R=E.over_count<v.over_count||E.over_count==v.over_count&&E.over_noise<v.over_noise||E.over_count==v.over_count&&BitStream.EQ(E.over_noise,v.over_noise)&&E.tot_noise<v.tot_noise;break;case 8:E.max_noise=c(T,L);case 1:R=E.max_noise<v.max_noise;break;case 2:R=E.tot_noise<v.tot_noise;break;case 3:R=E.tot_noise<v.tot_noise&&E.max_noise<v.max_noise;break;case 4:R=E.max_noise<=0&&v.max_noise>.2||E.max_noise<=0&&v.max_noise<0&&v.max_noise>E.max_noise-.2&&E.tot_noise<v.tot_noise||E.max_noise<=0&&v.max_noise>0&&v.max_noise>E.max_noise-.2&&E.tot_noise<v.tot_noise+v.over_noise||E.max_noise>0&&v.max_noise>-.05&&v.max_noise>E.max_noise-.1&&E.tot_noise+E.over_noise<v.tot_noise+v.over_noise||E.max_noise>0&&v.max_noise>-.1&&v.max_noise>E.max_noise-.15&&E.tot_noise+E.over_noise+E.over_noise<v.tot_noise+v.over_noise+v.over_noise;break;case 5:R=E.over_noise<v.over_noise||BitStream.EQ(E.over_noise,v.over_noise)&&E.tot_noise<v.tot_noise;break;case 6:R=E.over_noise<v.over_noise||BitStream.EQ(E.over_noise,v.over_noise)&&(E.max_noise<v.max_noise||BitStream.EQ(E.max_noise,v.max_noise)&&E.tot_noise<=v.tot_noise);break;case 7:R=E.over_count<v.over_count||E.over_noise<v.over_noise;break}return v.over_count==0&&(R=R&&E.bits<v.bits),R}function p(I,v,E,L,T){var R=I.internal_flags,g;v.scalefac_scale==0?g=1.2968395546510096:g=1.6817928305074292;for(var A=0,S=0;S<v.sfbmax;S++)A<E[S]&&(A=E[S]);var f=R.noise_shaping_amp;switch(f==3&&(T?f=2:f=1),f){case 2:break;case 1:A>1?A=Math.pow(A,.5):A*=.95;break;case 0:default:A>1?A=1:A*=.95;break}for(var x=0,S=0;S<v.sfbmax;S++){var b=v.width[S],y;if(x+=b,!(E[S]<A)){if((R.substep_shaping&2)!=0&&(R.pseudohalf[S]=R.pseudohalf[S]==0?1:0,R.pseudohalf[S]==0&&R.noise_shaping_amp==2))return;for(v.scalefac[S]++,y=-b;y<0;y++)L[x+y]*=g,L[x+y]>v.xrpow_max&&(v.xrpow_max=L[x+y]);if(R.noise_shaping_amp==2)return}}}function o(I,v){for(var E=1.2968395546510096,L=0,T=0;T<I.sfbmax;T++){var R=I.width[T],g=I.scalefac[T];if(I.preflag!=0&&(g+=n.pretab[T]),L+=R,(g&1)!=0){g++;for(var A=-R;A<0;A++)v[L+A]*=E,v[L+A]>I.xrpow_max&&(I.xrpow_max=v[L+A])}I.scalefac[T]=g>>1}I.preflag=0,I.scalefac_scale=1}function j(I,v,E){var L,T=v.scalefac;for(L=0;L<v.sfb_lmax;L++)if(T[L]>=16)return!0;for(var R=0;R<3;R++){var g=0,A=0;for(L=v.sfb_lmax+R;L<v.sfbdivide;L+=3)g<T[L]&&(g=T[L]);for(;L<v.sfbmax;L+=3)A<T[L]&&(A=T[L]);if(!(g<16&&A<8)){if(v.subblock_gain[R]>=7)return!0;v.subblock_gain[R]++;var S=I.scalefac_band.l[v.sfb_lmax];for(L=v.sfb_lmax+R;L<v.sfbmax;L+=3){var f,x=v.width[L],b=T[L];if(b=b-(4>>v.scalefac_scale),b>=0){T[L]=b,S+=x*3;continue}T[L]=0;{var y=210+(b<<v.scalefac_scale+1);f=n.IPOW20(y)}S+=x*(R+1);for(var k=-x;k<0;k++)E[S+k]*=f,E[S+k]>v.xrpow_max&&(v.xrpow_max=E[S+k]);S+=x*(3-R-1)}{var f=n.IPOW20(202);S+=v.width[L]*(R+1);for(var k=-v.width[L];k<0;k++)E[S+k]*=f,E[S+k]>v.xrpow_max&&(v.xrpow_max=E[S+k])}}}return!1}function O(I,v,E,L,T){var R=I.internal_flags;p(I,v,E,L,T);var g=u(v);return g?!1:(R.mode_gr==2?g=a.scale_bitcount(v):g=a.scale_bitcount_lsf(R,v),g?(R.noise_shaping>1&&($r.fill(R.pseudohalf,0),v.scalefac_scale==0?(o(v,L),g=!1):v.block_type==F.SHORT_TYPE&&R.subblock_gain>0&&(g=j(R,v,L)||u(v))),g||(R.mode_gr==2?g=a.scale_bitcount(v):g=a.scale_bitcount_lsf(R,v)),!g):!0)}this.outer_loop=function(I,v,E,L,T,R){var g=I.internal_flags,A=new Da,S=Fi(576),f=Fi(or.SFBMAX),x=new Ro,b,y=new k3,k=9999999,w=!1,H=!1,Y=0;if(m(g,v,R,T,L),g.noise_shaping==0)return 100;n.calc_noise(v,E,f,x,y),x.bits=v.part2_3_length,A.assign(v);var P=0;for(cr.arraycopy(L,0,S,0,576);!w;){do{var V=new Ro,d,M=255;if((g.substep_shaping&2)!=0?d=20:d=3,g.sfb21_extra&&(f[A.sfbmax]>1||A.block_type==F.SHORT_TYPE&&(f[A.sfbmax+1]>1||f[A.sfbmax+2]>1))||!O(I,A,f,L,H))break;A.scalefac_scale!=0&&(M=254);var W=R-A.part2_length;if(W<=0)break;for(;(A.part2_3_length=a.count_bits(g,L,A,y))>W&&A.global_gain<=M;)A.global_gain++;if(A.global_gain>M)break;if(x.over_count==0){for(;(A.part2_3_length=a.count_bits(g,L,A,y))>k&&A.global_gain<=M;)A.global_gain++;if(A.global_gain>M)break}if(n.calc_noise(A,E,f,V,y),V.bits=A.part2_3_length,v.block_type!=F.SHORT_TYPE?b=I.quant_comp:b=I.quant_comp_short,b=_(b,x,V,A,f)?1:0,b!=0)k=v.part2_3_length,x=V,v.assign(A),P=0,cr.arraycopy(L,0,S,0,576);else if(g.full_outer_loop==0&&(++P>d&&x.over_count==0||g.noise_shaping_amp==3&&H&&P>30||g.noise_shaping_amp==3&&H&&A.global_gain-Y>15))break}while(A.global_gain+A.scalefac_scale<255);g.noise_shaping_amp==3?H?w=!0:(A.assign(v),cr.arraycopy(S,0,L,0,576),P=0,Y=A.global_gain,H=!0):w=!0}return ji(v.global_gain+v.scalefac_scale<=255),I.VBR==zu.vbr_rh||I.VBR==zu.vbr_mtrh?cr.arraycopy(S,0,L,0,576):(g.substep_shaping&1)!=0&&trancate_smallspectrums(g,v,E,L),x.over_count},this.iteration_finish_one=function(I,v,E){var L=I.l3_side,T=L.tt[v][E];a.best_scalefac_store(I,v,E,L),I.use_best_huffman==1&&a.best_huffman_divide(I,T),t.ResvAdjust(I,T)},this.VBR_encode_granule=function(I,v,E,L,T,R,g){var A=I.internal_flags,S=new Da,f=Fi(576),x=g,b=g+1,y=(g+R)/2,k,w,H=0,Y=A.sfb21_extra;ji(x<=LameInternalFlags.MAX_BITS_PER_CHANNEL),$r.fill(S.l3_enc,0);do y>x-42?A.sfb21_extra=!1:A.sfb21_extra=Y,w=outer_loop(I,v,E,L,T,y),w<=0?(H=1,b=v.part2_3_length,S.assign(v),cr.arraycopy(L,0,f,0,576),g=b-32,k=g-R,y=(g+R)/2):(R=y+32,k=g-R,y=(g+R)/2,H!=0&&(H=2,v.assign(S),cr.arraycopy(f,0,L,0,576)));while(k>12);A.sfb21_extra=Y,H==2&&cr.arraycopy(S.l3_enc,0,v.l3_enc,0,576),ji(v.part2_3_length<=x)},this.get_framebits=function(I,v){var E=I.internal_flags;E.bitrate_index=E.VBR_min_bitrate;var L=e.getframebits(I);E.bitrate_index=1,L=e.getframebits(I);for(var T=1;T<=E.VBR_max_bitrate;T++){E.bitrate_index=T;var R=new MeanBits(L);v[T]=t.ResvFrameBegin(I,R),L=R.bits}},this.VBR_old_prepare=function(I,v,E,L,T,R,g,A,S){var f=I.internal_flags,x,b=0,y=1,k=0;f.bitrate_index=f.VBR_max_bitrate;var w=t.ResvFrameBegin(I,new MeanBits(0))/f.mode_gr;get_framebits(I,R);for(var H=0;H<f.mode_gr;H++){var Y=n.on_pe(I,v,A[H],w,H,0);f.mode_ext==F.MPG_MD_MS_LR&&(ms_convert(f.l3_side,H),n.reduce_side(A[H],E[H],w,Y));for(var P=0;P<f.channels_out;++P){var V=f.l3_side.tt[H][P];V.block_type!=F.SHORT_TYPE?(b=1.28/(1+Math.exp(3.5-v[H][P]/300))-.05,x=f.PSY.mask_adjust-b):(b=2.56/(1+Math.exp(3.5-v[H][P]/300))-.14,x=f.PSY.mask_adjust_short-b),f.masking_lower=Math.pow(10,x*.1),init_outer_loop(f,V),S[H][P]=n.calc_xmin(I,L[H][P],V,T[H][P]),S[H][P]!=0&&(y=0),g[H][P]=126,k+=A[H][P]}}for(var H=0;H<f.mode_gr;H++)for(var P=0;P<f.channels_out;P++)k>R[f.VBR_max_bitrate]&&(A[H][P]*=R[f.VBR_max_bitrate],A[H][P]/=k),g[H][P]>A[H][P]&&(g[H][P]=A[H][P]);return y},this.bitpressure_strategy=function(I,v,E,L){for(var T=0;T<I.mode_gr;T++)for(var R=0;R<I.channels_out;R++){for(var g=I.l3_side.tt[T][R],A=v[T][R],S=0,f=0;f<g.psy_lmax;f++)A[S++]*=1+.029*f*f/F.SBMAX_l/F.SBMAX_l;if(g.block_type==F.SHORT_TYPE)for(var f=g.sfb_smin;f<F.SBMAX_s;f++)A[S++]*=1+.029*f*f/F.SBMAX_s/F.SBMAX_s,A[S++]*=1+.029*f*f/F.SBMAX_s/F.SBMAX_s,A[S++]*=1+.029*f*f/F.SBMAX_s/F.SBMAX_s;L[T][R]=0|Math.max(E[T][R],.9*L[T][R])}},this.VBR_new_prepare=function(I,v,E,L,T,R){var g=I.internal_flags,A=1,S=0,f=0,x;if(I.free_format){g.bitrate_index=0;var b=new MeanBits(S);x=t.ResvFrameBegin(I,b),S=b.bits,T[0]=x}else{g.bitrate_index=g.VBR_max_bitrate;var b=new MeanBits(S);t.ResvFrameBegin(I,b),S=b.bits,get_framebits(I,T),x=T[g.VBR_max_bitrate]}for(var y=0;y<g.mode_gr;y++){n.on_pe(I,v,R[y],S,y,0),g.mode_ext==F.MPG_MD_MS_LR&&ms_convert(g.l3_side,y);for(var k=0;k<g.channels_out;++k){var w=g.l3_side.tt[y][k];g.masking_lower=Math.pow(10,g.PSY.mask_adjust*.1),init_outer_loop(g,w),n.calc_xmin(I,E[y][k],w,L[y][k])!=0&&(A=0),f+=R[y][k]}}for(var y=0;y<g.mode_gr;y++)for(var k=0;k<g.channels_out;k++)f>x&&(R[y][k]*=x,R[y][k]/=f);return A},this.calc_target_bits=function(I,v,E,L,T,R){var g=I.internal_flags,A=g.l3_side,S,f,x,b,y=0;g.bitrate_index=g.VBR_max_bitrate;var k=new MeanBits(y);for(R[0]=t.ResvFrameBegin(I,k),y=k.bits,g.bitrate_index=1,y=e.getframebits(I)-g.sideinfo_len*8,T[0]=y/(g.mode_gr*g.channels_out),y=I.VBR_mean_bitrate_kbps*I.framesize*1e3,(g.substep_shaping&1)!=0&&(y*=1.09),y/=I.out_samplerate,y-=g.sideinfo_len*8,y/=g.mode_gr*g.channels_out,S=.93+.07*(11-I.compression_ratio)/(11-5.5),S<.9&&(S=.9),S>1&&(S=1),f=0;f<g.mode_gr;f++){var w=0;for(x=0;x<g.channels_out;x++){if(L[f][x]=int(S*y),v[f][x]>700){var H=int((v[f][x]-700)/1.4),Y=A.tt[f][x];L[f][x]=int(S*y),Y.block_type==F.SHORT_TYPE&&H<y/2&&(H=y/2),H>y*3/2?H=y*3/2:H<0&&(H=0),L[f][x]+=H}L[f][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(L[f][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),w+=L[f][x]}if(w>LameInternalFlags.MAX_BITS_PER_GRANULE)for(x=0;x<g.channels_out;++x)L[f][x]*=LameInternalFlags.MAX_BITS_PER_GRANULE,L[f][x]/=w}if(g.mode_ext==F.MPG_MD_MS_LR)for(f=0;f<g.mode_gr;f++)n.reduce_side(L[f],E[f],y*g.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(b=0,f=0;f<g.mode_gr;f++)for(x=0;x<g.channels_out;x++)L[f][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(L[f][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),b+=L[f][x];if(b>R[0])for(f=0;f<g.mode_gr;f++)for(x=0;x<g.channels_out;x++)L[f][x]*=R[0],L[f][x]/=b}}var Uu=Ie.assert;function M3(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var r=t.internal_flags,a,i=r.l3_side,s=e.getframebits(t);n.bits=(s-r.sideinfo_len*8)/r.mode_gr;var l=8*256*r.mode_gr-8;t.brate>320?a=8*int(t.brate*1e3/(t.out_samplerate/1152)/8+.5):(a=8*1440,t.strict_ISO&&(a=8*int(32e4/(t.out_samplerate/1152)/8+.5))),r.ResvMax=a-s,r.ResvMax>l&&(r.ResvMax=l),(r.ResvMax<0||t.disable_reservoir)&&(r.ResvMax=0);var m=n.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return m>a&&(m=a),Uu(r.ResvMax%8==0),Uu(r.ResvMax>=0),i.resvDrain_pre=0,r.pinfo!=null&&(r.pinfo.mean_bits=n.bits/2,r.pinfo.resvsize=r.ResvSize),m},this.ResvMaxBits=function(t,n,r,a){var i=t.internal_flags,s,l=i.ResvSize,m=i.ResvMax;a!=0&&(l+=n),(i.substep_shaping&1)!=0&&(m*=.9),r.bits=n,l*10>m*9?(s=l-m*9/10,r.bits+=s,i.substep_shaping|=128):(s=0,i.substep_shaping&=127,!t.disable_reservoir&&(i.substep_shaping&1)==0&&(r.bits-=.1*n));var u=l<i.ResvMax*6/10?l:i.ResvMax*6/10;return u-=s,u<0&&(u=0),u},this.ResvAdjust=function(t,n){t.ResvSize-=n.part2_3_length+n.part2_length},this.ResvFrameEnd=function(t,n){var r,a=t.l3_side;t.ResvSize+=n*t.mode_gr;var i=0;a.resvDrain_post=0,a.resvDrain_pre=0,(r=t.ResvSize%8)!=0&&(i+=r),r=t.ResvSize-i-t.ResvMax,r>0&&(i+=r);{var s=Math.min(a.main_data_begin*8,i)/8;a.resvDrain_pre+=8*s,i-=8*s,t.ResvSize-=8*s,a.main_data_begin-=s}a.resvDrain_post+=i,t.ResvSize-=i}}function A3(){var e="http://www.mp3dev.org/",t=3,n=98,r=4,a=0,i=93;this.getLameVersion=function(){return t+"."+n+"."+r},this.getLameShortVersion=function(){return t+"."+n+"."+r},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+n+"r"},this.getPsyVersion=function(){return a+"."+i},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var E3=Ie.System,Co=Ie.VbrMode,Vu=Ie.ShortBlock,T3=Ie.Arrays,qa=Ie.new_byte,R3=Ie.assert;Ni.NUMTOCENTRIES=100,Ni.MAXFRAMESIZE=2880;function Ni(){var e,t,n;this.setModules=function(y,k,w){e=y,t=k,n=w};var r=1,a=2,i=4,s=8,l=Ni.NUMTOCENTRIES,m=Ni.MAXFRAMESIZE,u=l+4+4+4+4+4,h=u+9+1+1+8+1+1+3+1+1+2+4+2+2,c=128,_=64,p=32,o=null,j="Xing",O="Info",I=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function v(y,k){if(y.nVbrNumFrames++,y.sum+=k,y.seen++,!(y.seen<y.want)&&(y.pos<y.size&&(y.bag[y.pos]=y.sum,y.pos++,y.seen=0),y.pos==y.size)){for(var w=1;w<y.size;w+=2)y.bag[w/2]=y.bag[w];y.want*=2,y.pos/=2}}function E(y,k){if(!(y.pos<=0))for(var w=1;w<l;++w){var H=w/l,Y,P,V=0|Math.floor(H*y.pos);V>y.pos-1&&(V=y.pos-1),Y=y.bag[V],P=y.sum;var d=0|256*Y/P;d>255&&(d=255),k[w]=255&d}}this.addVbrFrame=function(y){var k=y.internal_flags,w=Tables.bitrate_table[y.version][k.bitrate_index];R3(k.VBR_seek_table.bag!=null),v(k.VBR_seek_table,w)};function L(y,k){var w=y[k+0]&255;return w<<=8,w|=y[k+1]&255,w<<=8,w|=y[k+2]&255,w<<=8,w|=y[k+3]&255,w}function T(y,k,w){y[k+0]=255&(w>>24&255),y[k+1]=255&(w>>16&255),y[k+2]=255&(w>>8&255),y[k+3]=255&(w&255)}function R(y,k,w){y[k+0]=255&(w>>8&255),y[k+1]=255&(w&255)}function g(y,k){return new String(y,k,j.length(),o).equals(j)||new String(y,k,O.length(),o).equals(O)}function A(y,k,w){return 255&(y<<k|w&~(-1<<k))}function S(y,k){var w=y.internal_flags;k[0]=A(k[0],8,255),k[1]=A(k[1],3,7),k[1]=A(k[1],1,y.out_samplerate<16e3?0:1),k[1]=A(k[1],1,y.version),k[1]=A(k[1],2,4-3),k[1]=A(k[1],1,y.error_protection?0:1),k[2]=A(k[2],4,w.bitrate_index),k[2]=A(k[2],2,w.samplerate_index),k[2]=A(k[2],1,0),k[2]=A(k[2],1,y.extension),k[3]=A(k[3],2,y.mode.ordinal()),k[3]=A(k[3],2,w.mode_ext),k[3]=A(k[3],1,y.copyright),k[3]=A(k[3],1,y.original),k[3]=A(k[3],2,y.emphasis),k[0]=255;var H=255&(k[1]&241),Y;y.version==1?Y=c:y.out_samplerate<16e3?Y=p:Y=_,y.VBR==Co.vbr_off&&(Y=y.brate);var P;y.free_format?P=0:P=255&16*e.BitrateIndex(Y,y.version,y.out_samplerate),y.version==1?(k[1]=255&(H|10),H=255&(k[2]&13),k[2]=255&(P|H)):(k[1]=255&(H|2),H=255&(k[2]&13),k[2]=255&(P|H))}this.getVbrTag=function(y){var k=new VBRTagData,w=0;k.flags=0;var H=y[w+1]>>3&1,Y=y[w+2]>>2&3,P=y[w+3]>>6&3,V=y[w+2]>>4&15;if(V=Tables.bitrate_table[H][V],y[w+1]>>4==14?k.samprate=Tables.samplerate_table[2][Y]:k.samprate=Tables.samplerate_table[H][Y],H!=0?P!=3?w+=32+4:w+=17+4:P!=3?w+=17+4:w+=9+4,!g(y,w))return null;w+=4,k.hId=H;var d=k.flags=L(y,w);if(w+=4,(d&r)!=0&&(k.frames=L(y,w),w+=4),(d&a)!=0&&(k.bytes=L(y,w),w+=4),(d&i)!=0){if(k.toc!=null)for(var M=0;M<l;M++)k.toc[M]=y[w+M];w+=l}k.vbrScale=-1,(d&s)!=0&&(k.vbrScale=L(y,w),w+=4),k.headersize=(H+1)*72e3*V/k.samprate,w+=21;var W=y[w+0]<<4;W+=y[w+1]>>4;var C=(y[w+1]&15)<<8;return C+=y[w+2]&255,(W<0||W>3e3)&&(W=-1),(C<0||C>3e3)&&(C=-1),k.encDelay=W,k.encPadding=C,k},this.InitVbrTag=function(y){var k=y.internal_flags,w;y.version==1?w=c:y.out_samplerate<16e3?w=p:w=_,y.VBR==Co.vbr_off&&(w=y.brate);var H=(y.version+1)*72e3*w/y.out_samplerate,Y=k.sideinfo_len+h;if(k.VBR_seek_table.TotalFrameSize=H,H<Y||H>m){y.bWriteVbrTag=!1;return}k.VBR_seek_table.nVbrNumFrames=0,k.VBR_seek_table.nBytesWritten=0,k.VBR_seek_table.sum=0,k.VBR_seek_table.seen=0,k.VBR_seek_table.want=1,k.VBR_seek_table.pos=0,k.VBR_seek_table.bag==null&&(k.VBR_seek_table.bag=new int[400],k.VBR_seek_table.size=400);var P=qa(m);S(y,P);for(var V=k.VBR_seek_table.TotalFrameSize,d=0;d<V;++d)t.add_dummy_byte(y,P[d]&255,1)};function f(y,k){var w=k^y;return k=k>>8^I[w&255],k}this.updateMusicCRC=function(y,k,w,H){for(var Y=0;Y<H;++Y)y[0]=f(k[w+Y],y[0])};function x(y,k,w,H,Y){var P=y.internal_flags,V=0,d=y.encoder_delay,M=y.encoder_padding,W=100-10*y.VBR_q-y.quality,C=n.getLameVeryShortVersion(),fe,Se=0,ge,_e=[1,5,3,2,4,0,3],He=0|(y.lowpassfreq/100+.5>255?255:y.lowpassfreq/100+.5),Re=0,pe=0,Ve=0,rt=y.internal_flags.noise_shaping,z=0,X=0,ne=0,ce=0,de=0,Me=(y.exp_nspsytune&1)!=0,Ee=(y.exp_nspsytune&2)!=0,we=!1,Ae=!1,be=y.internal_flags.nogap_total,Pe=y.internal_flags.nogap_current,je=y.ATHtype,ze=0,Ue;switch(y.VBR){case vbr_abr:Ue=y.VBR_mean_bitrate_kbps;break;case vbr_off:Ue=y.brate;break;default:Ue=y.VBR_min_bitrate_kbps}switch(y.VBR.ordinal()<_e.length?fe=_e[y.VBR.ordinal()]:fe=0,ge=16*Se+fe,P.findReplayGain&&(P.RadioGain>510&&(P.RadioGain=510),P.RadioGain<-510&&(P.RadioGain=-510),pe=8192,pe|=3072,P.RadioGain>=0?pe|=P.RadioGain:(pe|=512,pe|=-P.RadioGain)),P.findPeakSample&&(Re=Math.abs(0|P.PeakSample/32767*Math.pow(2,23)+.5)),be!=-1&&(Pe>0&&(Ae=!0),Pe<be-1&&(we=!0)),ze=je+((Me?1:0)<<4)+((Ee?1:0)<<5)+((we?1:0)<<6)+((Ae?1:0)<<7),W<0&&(W=0),y.mode){case MONO:z=0;break;case STEREO:z=1;break;case DUAL_CHANNEL:z=2;break;case JOINT_STEREO:y.force_ms?z=4:z=3;break;case NOT_SET:default:z=7;break}y.in_samplerate<=32e3?ne=0:y.in_samplerate==48e3?ne=2:y.in_samplerate>48e3?ne=3:ne=1,(y.short_blocks==Vu.short_block_forced||y.short_blocks==Vu.short_block_dispensed||y.lowpassfreq==-1&&y.highpassfreq==-1||y.scale_left<y.scale_right||y.scale_left>y.scale_right||y.disable_reservoir&&y.brate<320||y.noATH||y.ATHonly||je==0||y.in_samplerate<=32e3)&&(X=1),ce=rt+(z<<2)+(X<<5)+(ne<<6),de=P.nMusicCRC,T(w,H+V,W),V+=4;for(var Ke=0;Ke<9;Ke++)w[H+V+Ke]=255&C.charAt(Ke);V+=9,w[H+V]=255&ge,V++,w[H+V]=255&He,V++,T(w,H+V,Re),V+=4,R(w,H+V,pe),V+=2,R(w,H+V,Ve),V+=2,w[H+V]=255&ze,V++,Ue>=255?w[H+V]=255:w[H+V]=255&Ue,V++,w[H+V]=255&d>>4,w[H+V+1]=255&(d<<4)+(M>>8),w[H+V+2]=255&M,V+=3,w[H+V]=255&ce,V++,w[H+V++]=0,R(w,H+V,y.preset),V+=2,T(w,H+V,k),V+=4,R(w,H+V,de),V+=2;for(var ue=0;ue<V;ue++)Y=f(w[H+ue],Y);return R(w,H+V,Y),V+=2,V}function b(y){y.seek(0);var k=qa(10);y.readFully(k);var w;return new String(k,"ISO-8859-1").startsWith("ID3")?w=0:w=((k[6]&127)<<21|(k[7]&127)<<14|(k[8]&127)<<7|k[9]&127)+k.length,w}this.getLameTagFrame=function(y,k){var w=y.internal_flags;if(!y.bWriteVbrTag||w.Class_ID!=Lame.LAME_ID||w.VBR_seek_table.pos<=0)return 0;if(k.length<w.VBR_seek_table.TotalFrameSize)return w.VBR_seek_table.TotalFrameSize;T3.fill(k,0,w.VBR_seek_table.TotalFrameSize,0),S(y,k);var H=qa(l);if(y.free_format)for(var Y=1;Y<l;++Y)H[Y]=255&255*Y/100;else E(w.VBR_seek_table,H);var P=w.sideinfo_len;y.error_protection&&(P-=2),y.VBR==Co.vbr_off?(k[P++]=255&O.charAt(0),k[P++]=255&O.charAt(1),k[P++]=255&O.charAt(2),k[P++]=255&O.charAt(3)):(k[P++]=255&j.charAt(0),k[P++]=255&j.charAt(1),k[P++]=255&j.charAt(2),k[P++]=255&j.charAt(3)),T(k,P,r+a+i+s),P+=4,T(k,P,w.VBR_seek_table.nVbrNumFrames),P+=4;var V=w.VBR_seek_table.nBytesWritten+w.VBR_seek_table.TotalFrameSize;T(k,P,0|V),P+=4,E3.arraycopy(H,0,k,P,H.length),P+=H.length,y.error_protection&&t.CRC_writeheader(w,k);for(var d=0,Y=0;Y<P;Y++)d=f(k[Y],d);return P+=x(y,V,k,P,d),w.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(y,k){var w=y.internal_flags;if(w.VBR_seek_table.pos<=0||(k.seek(k.length()),k.length()==0))return-1;var H=b(k);k.seek(H);var Y=qa(m),P=getLameTagFrame(y,Y);return P>Y.length?-1:(P<1||k.write(Y,0,P),0)}}var qu=Ie.new_byte,I3=Ie.assert;function C3(){this.setModules=function(e,t){}}function B3(){this.setModules=function(e,t,n){}}function O3(){}function L3(){this.setModules=function(e,t){}}function F3(e,t,n){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,n=128);var r=new Je,a=new C3,i=new It,s=new pn,l=new x3,m=new Ut,u=new S3,h=new Ni,c=new A3,_=new L3,p=new M3,o=new Li,j=new B3,O=new O3;r.setModules(i,s,l,m,u,h,c,_,O),s.setModules(i,O,c,h),_.setModules(s,c),l.setModules(r),u.setModules(s,p,m,o),m.setModules(o,p,r.enc.psy),p.setModules(s),o.setModules(m),h.setModules(r,s,c),a.setModules(j,O),j.setModules(c,_,l);var I=r.lame_init();I.num_channels=e,I.in_samplerate=t,I.brate=n,I.mode=dt.STEREO,I.quality=3,I.bWriteVbrTag=!1,I.disable_reservoir=!0,I.write_id3tag_automatic=!1,r.lame_init_params(I);var v=1152,E=0|1.25*v+7200,L=qu(E);this.encodeBuffer=function(T,R){e==1&&(R=T),I3(T.length==R.length),T.length>v&&(v=T.length,E=0|1.25*v+7200,L=qu(E));var g=r.lame_encode_buffer(I,T,R,T.length,L,0,E);return new Int8Array(L.subarray(0,g))},this.flush=function(){var T=r.lame_encode_flush(I,L,0,E);return new Int8Array(L.subarray(0,T))}}function Xa(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}Xa("RIFF"),Xa("WAVE"),Xa("fmt "),Xa("data");class j3{constructor(t){this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new F3(1,this.sampleRate,this.bitRate)}encode(t){const r=this._convertBuffer(t);let a=r.length;for(let i=0;a>=0;i+=1152){const s=r.subarray(i,i+1152),l=this.encoder.encodeBuffer(s);this.dataBuffer.push(new Int8Array(l)),a-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const t=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:t,url:URL.createObjectURL(t)}}_floatTo16BitPCM(t,n){for(let r=0;r<t.length;r++){const a=Math.max(-1,Math.min(1,t[r]));n[r]=a<0?a*32768:a*32767}}_convertBuffer(t){const n=new Float32Array(t),r=new Int16Array(t.length);return this._floatTo16BitPCM(n,r),r}}class N3{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new j3(this.encoderOptions))}stop(){this.stream.getTracks().forEach(n=>n.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;t=this.lameEncoder.finish(),t.duration=this.duration,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,this.processor.onaudioprocess=n=>{const r=n.inputBuffer.getChannelData(0);let a=0;this.lameEncoder&&this.lameEncoder.encode(r);for(let i=0;i<r.length;++i)a+=r[i]*r[i];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(a/r.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}var Xu=window.chrome,Bo=window.navigator,H3=Bo.vendor,D3=typeof window.opr!="undefined",P3=Bo.userAgent.indexOf("Edg")>-1,z3=Bo.userAgent.match("CriOS");function U3(){return z3?!0:Xu!==null&&typeof Xu!="undefined"&&H3==="Google Inc."&&D3===!1&&P3===!1}function Yu(){var e=V3(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function V3(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const q3={name:"RoomFooter",components:{SvgIcon:Ht,EmojiPickerContainer:_u,RoomFiles:K_,RoomMessageReply:_g,RoomUsersTag:Sg,RoomEmojis:Rg,RoomTemplatesText:Ng},directives:{clickOutside:ya},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new Pc({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=Yu();let t=!0;this.getTextareaRef().addEventListener("keyup",n=>{n.key==="Enter"&&!n.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!n.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){Yu()&&e||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const t=U3()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+t,this.cursorRangePosition+t),this.cursorRangePosition=null}))},onChangeInput(){var e,t,n;(((e=this.getTextareaRef())==null?void 0:e.value)||((t=this.getTextareaRef())==null?void 0:t.value)==="")&&(this.message=(n=this.getTextareaRef())==null?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-t*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var n;const t=(n=e.clipboardData)==null?void 0:n.items;t&&Array.from(t).forEach(r=>{if(r.type.includes("image")){const a=r.getAsFile();this.onFileChange([a])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition("/"),r=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+r+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t+e.text.length+r.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async t=>{const n=URL.createObjectURL(t),r=t.name.lastIndexOf(".");this.files.push({loading:!0,name:t.name.substring(0,r),size:t.size,type:t.type,extension:t.name.substring(r+1),localUrl:n});const a=await fetch(n).then(s=>s.blob());let i=this.files.find(s=>s.localUrl===n);i&&(i.blob=a,i.loading=!1,delete i.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const t=this.recorder.records[0];this.files.push({blob:t.blob,name:`audio.${this.format}`,size:t.blob.size,duration:t.duration,type:t.blob.type,audio:!0,localUrl:URL.createObjectURL(t.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var n;let e=this.message.trim();if(!this.files.length&&!e||this.isFileLoading)return;this.selectedUsersTag.forEach(r=>{e=e.replace(`@${r.username}`,`<usertag>${r._id}</usertag>`)});const t=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==e||((n=this.editedMessage.files)==null?void 0:n.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const n=t,r="<usertag>",a="</usertag>";[...t.matchAll(new RegExp(r,"gi"))].map(s=>s.index).forEach(s=>{const l=n.substring(s+r.length,n.indexOf(a,s)),m=this.room.users.find(u=>u._id===l);t=t.replace(`${r}${l}${a}`,`@${(m==null?void 0:m.username)||"unknown"}`),this.selectUserTag(m,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||e===":"&&!this.emojisSuggestionEnabled||e==="@"&&(!this.userTagsEnabled||!this.room.users)||e==="/"&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let n=t;for(;n>0&&this.message.charAt(n-1)!==e&&(this.message.charAt(n-1)!==" "||e!==":");)n--;const r=this.message.charAt(n-2),a=!r.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)===e&&(!r||r===" "||a)){const i=this.message.substring(n,t);e===":"?this.updateEmojis(i):e==="@"?this.updateShowUsersTag(i):e==="/"&&this.updateShowTemplatesText(i)}else this.resetFooterList(e)},updateShowUsersTag(e){this.filteredUsersTag=io(this.room.users,"username",e,!0).filter(t=>t._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:n,endPosition:r}=this.getCharPosition("@"),a=this.message.substr(r,r).length?"":" ";this.message=this.message.substr(0,n)+e.username+a+this.message.substr(r,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=n+e.username.length+a.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=io(this.templatesText,"tag",e,!0)},getCharPosition(e){let n=this.getTextareaRef().selectionStart;for(;n>0&&this.message.charAt(n-1)!==e;)n--;const r=this.getTextareaRef().selectionEnd;return{position:n,endPosition:r}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(n=>n.unicode)},resetFooterList(e=null){e===":"?this.filteredEmojis=[]:e==="@"?this.filteredUsersTag=[]:e==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new N3({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},X3={key:0,class:"vac-icon-textarea-left"},Y3=he("div",{class:"vac-dot-audio-record"},null,-1),K3={class:"vac-dot-audio-record-time"},G3=["placeholder"],W3={class:"vac-icon-textarea"},Z3={key:1},Q3=["accept","capture"];function J3(e,t,n,r,a,i){const s=Ye("room-emojis"),l=Ye("room-users-tag"),m=Ye("room-templates-text"),u=Ye("room-message-reply"),h=Ye("room-files"),c=Ye("svg-icon"),_=Ye("emoji-picker-container"),p=oa("click-outside");return zn((Q(),se("div",{id:"room-footer",class:$e(["vac-room-footer",{"vac-app-box-shadow":i.shadowFooter}])},[Oe(s,{"filtered-emojis":a.filteredEmojis,"select-item":a.selectEmojiItem,"active-up-or-down":a.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=o=>i.selectEmoji(o)),onActivateItem:t[1]||(t[1]=o=>a.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Oe(l,{"filtered-users-tag":a.filteredUsersTag,"select-item":a.selectUsersTagItem,"active-up-or-down":a.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=o=>i.selectUserTag(o)),onActivateItem:t[3]||(t[3]=o=>a.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Oe(m,{"filtered-templates-text":a.filteredTemplatesText,"select-item":a.selectTemplatesTextItem,"active-up-or-down":a.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=o=>i.selectTemplateText(o)),onActivateItem:t[5]||(t[5]=o=>a.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Oe(u,{room:n.room,"message-reply":a.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:i.resetMessage},_t({_:2},[tt(e.$slots,(o,j)=>({name:j,fn:Ge(O=>[Be(e.$slots,j,vt(pt(O)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Oe(h,{files:a.files,onRemoveFile:i.removeFile,onResetMessage:i.resetMessage},_t({_:2},[tt(e.$slots,(o,j)=>({name:j,fn:Ge(O=>[Be(e.$slots,j,vt(pt(O)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),he("div",{class:$e(["vac-box-footer",{"vac-box-footer-border":!a.files.length}])},[n.showAudio&&!a.files.length?(Q(),se("div",X3,[a.isRecording?(Q(),se(st,{key:0},[he("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...o)=>i.stopRecorder&&i.stopRecorder(...o))},[Be(e.$slots,"audio-stop-icon",{},()=>[Oe(c,{name:"close-outline"})])]),Y3,he("div",K3,Qe(i.recordedTime),1),he("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=o=>i.toggleRecorder(!1))},[Be(e.$slots,"audio-check-icon",{},()=>[Oe(c,{name:"checkmark"})])])],64)):(Q(),se("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=o=>i.toggleRecorder(!0))},[Be(e.$slots,"microphone-icon",{},()=>[Oe(c,{name:"microphone",class:"vac-icon-microphone"})])]))])):Te("",!0),he("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:$e(["vac-textarea",{"vac-textarea-outline":a.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...o)=>i.onChangeInput&&i.onChangeInput(...o)),onKeydown:[t[10]||(t[10]=xr((...o)=>i.escapeTextarea&&i.escapeTextarea(...o),["esc"])),t[11]||(t[11]=xr(Rn((...o)=>i.selectItem&&i.selectItem(...o),["exact","prevent"]),["enter"])),t[13]||(t[13]=xr(Rn(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=xr((...o)=>i.selectItem&&i.selectItem(...o),["tab"])),t[15]||(t[15]=xr(o=>i.updateActiveUpOrDown(o,-1),["up"])),t[16]||(t[16]=xr(o=>i.updateActiveUpOrDown(o,1),["down"]))],onPaste:t[12]||(t[12]=(...o)=>i.onPasteImage&&i.onPasteImage(...o))},null,42,G3),he("div",W3,[a.editedMessage._id?(Q(),se("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...o)=>i.resetMessage&&i.resetMessage(...o))},[Be(e.$slots,"edit-close-icon",{},()=>[Oe(c,{name:"close-outline"})])])):Te("",!0),n.showEmojis?zn((Q(),se("div",Z3,[Be(e.$slots,"emoji-picker",js({emojiOpened:a.emojiOpened},{addEmoji:i.addEmoji}),()=>[Oe(_,{"emoji-opened":a.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:i.addEmoji,onOpenEmoji:t[18]||(t[18]=o=>a.emojiOpened=o)},{"emoji-picker-icon":Ge(()=>[Be(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[p,()=>a.emojiOpened=!1]]):Te("",!0),n.showFiles?(Q(),se("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...o)=>i.launchFilePicker&&i.launchFilePicker(...o))},[Be(e.$slots,"paperclip-icon",{},()=>[Oe(c,{name:"paperclip"})])])):Te("",!0),n.textareaActionEnabled?(Q(),se("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...o)=>i.textareaActionHandler&&i.textareaActionHandler(...o))},[Be(e.$slots,"custom-action-icon",{},()=>[Oe(c,{name:"deleted"})])])):Te("",!0),n.showFiles?(Q(),se("input",{key:4,ref:"file",type:"file",multiple:"",accept:n.acceptedFiles,capture:n.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=o=>i.onFileChange(o.target.files))},null,40,Q3)):Te("",!0),n.showSendIcon?(Q(),se("div",{key:5,class:$e(["vac-svg-button",{"vac-send-disabled":i.isMessageEmpty}]),onClick:t[22]||(t[22]=(...o)=>i.sendMessage&&i.sendMessage(...o))},[Be(e.$slots,"send-icon",{},()=>[Oe(c,{name:"send",param:i.isMessageEmpty||i.isFileLoading?"disabled":""},null,8,["param"])])],2)):Te("",!0)])],2)],2)),[[ha,Object.keys(n.room).length&&n.showFooter]])}var $3=xt(q3,[["render",J3]]);const e4={name:"MessageReply",components:{AudioPlayer:ko,SvgIcon:Ht,FormatMessage:xi},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(n=>n._id===e);return t?t.username:""},firstFile(){var e,t;return(t=(e=this.message.replyMessage)==null?void 0:e.files)!=null&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return wa(this.firstFile)},isImage(){return Xr(this.firstFile)},isVideo(){return wi(this.firstFile)},isOtherFile(){var e;return((e=this.message.replyMessage.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},t4={class:"vac-reply-message"},n4={class:"vac-reply-username"},r4={key:0,class:"vac-image-reply-container"},i4={key:1,class:"vac-video-reply-container"},a4={controls:""},s4=["src"],o4={key:3,class:"vac-file-container"},l4={class:"vac-text-ellipsis"},c4={key:0,class:"vac-text-ellipsis vac-text-extension"},u4={class:"vac-reply-content"};function d4(e,t,n,r,a,i){const s=Ye("audio-player"),l=Ye("svg-icon"),m=Ye("format-message");return Q(),se("div",t4,[he("div",n4,Qe(i.replyUsername),1),i.isImage?(Q(),se("div",r4,[he("div",{class:"vac-message-image vac-message-image-reply",style:St({"background-image":`url('${i.firstFile.url}')`})},null,4)])):i.isVideo?(Q(),se("div",i4,[he("video",a4,[he("source",{src:i.firstFile.url},null,8,s4)])])):i.isAudio?(Q(),ht(s,{key:2,src:i.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=u=>e.progressTime=u),onHoverAudioProgress:t[1]||(t[1]=u=>e.hoverAudioProgress=u)},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["src"])):i.isOtherFile?(Q(),se("div",o4,[he("div",null,[Be(e.$slots,"file-icon",{},()=>[Oe(l,{name:"file"})])]),he("div",l4,Qe(i.firstFile.name),1),i.firstFile.extension?(Q(),se("div",c4,Qe(i.firstFile.extension),1)):Te("",!0)])):Te("",!0),he("div",u4,[Oe(m,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var m4=xt(e4,[["render",d4]]);const f4={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const r=54*Math.PI;return{radius:35,stroke:4,normalizedRadius:27,circumference:r}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},h4={ref:"progress",class:"vac-progress-wrapper"},p4=["height","width"],v4=["stroke-dasharray","stroke-width","r","cx","cy"],_4={class:"vac-progress-text"},g4=he("span",{class:"vac-progress-pourcent"},"%",-1);function b4(e,t,n,r,a,i){return Q(),ht(Ct,{name:"vac-fade-spinner",appear:""},{default:Ge(()=>[he("div",h4,[(Q(),se("svg",{height:a.radius*2,width:a.radius*2},[he("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":a.circumference+" "+a.circumference,style:St({strokeDashoffset:i.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":a.stroke,fill:"transparent",r:a.normalizedRadius,cx:a.radius,cy:a.radius},null,12,v4)],8,p4)),he("div",{class:"vac-progress-content",style:St({height:a.radius*2-19+"px",width:a.radius*2-19+"px"})},[he("div",_4,[Un(Qe(n.progress),1),g4])],4)],512)]),_:1})}var Ku=xt(f4,[["render",b4]]);const x4={name:"MessageFile",components:{SvgIcon:Ht,Loader:pa,ProgressBar:Ku},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1||this.imageLoading},isImage(){return Xr(this.file)},isVideo(){return wi(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!Xr(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},y4={class:"vac-message-file-container"},w4={key:0,class:"vac-image-buttons"},k4={controls:""},S4=["src"];function M4(e,t,n,r,a,i){const s=Ye("progress-bar"),l=Ye("loader"),m=Ye("svg-icon");return Q(),se("div",y4,[i.isImage?(Q(),se("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=u=>a.imageHover=!0),onMouseleave:t[3]||(t[3]=u=>a.imageHover=!1),onClick:t[4]||(t[4]=u=>i.openFile(u,"preview"))},[n.file.progress>=0?(Q(),ht(s,{key:0,progress:n.file.progress,style:St({top:`${a.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Q(),ht(l,{key:1,show:i.isImageLoading,type:"message-file","message-id":n.message._id,style:St({top:`${a.imageResponsive.loaderTop}px`})},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["show","message-id","style"])),he("div",{class:$e(["vac-message-image",{"vac-blur-loading":i.isImageLoading&&n.message.senderId===n.currentUserId}]),style:St({"background-image":`url('${i.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${a.imageResponsive.maxHeight}px`})},[Oe(Ct,{name:"vac-fade-image"},{default:Ge(()=>[!n.messageSelectionEnabled&&a.imageHover&&!i.isImageLoading?(Q(),se("div",w4,[he("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=u=>i.openFile(u,"preview"))},[Be(e.$slots,"eye-icon_"+n.message._id,{},()=>[Oe(m,{name:"eye"})])]),he("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=u=>i.openFile(u,"download"))},[Be(e.$slots,"document-icon_"+n.message._id,{},()=>[Oe(m,{name:"document"})])])])):Te("",!0)]),_:3})],6)],544)):i.isVideo?(Q(),se("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Rn(u=>i.openFile(u,"preview"),["prevent"]))},[n.file.progress>=0?(Q(),ht(s,{key:0,progress:n.file.progress},null,8,["progress"])):Te("",!0),he("video",k4,[he("source",{src:n.file.url},null,8,S4)])])):Te("",!0)])}var A4=xt(x4,[["render",M4]]);const E4={name:"MessageFiles",components:{SvgIcon:Ht,FormatMessage:xi,ProgressBar:Ku,MessageFile:A4},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>wc(e))},otherFiles(){return this.message.files.filter(e=>!wc(e))}},methods:{openFile(e,t,n){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:n}))}}},T4={class:"vac-message-files-container"},R4=["onClick"],I4={class:"vac-svg-button"},C4={class:"vac-text-ellipsis"},B4={key:0,class:"vac-text-ellipsis vac-text-extension"};function O4(e,t,n,r,a,i){const s=Ye("message-file"),l=Ye("progress-bar"),m=Ye("svg-icon"),u=Ye("format-message");return Q(),se("div",T4,[(Q(!0),se(st,null,tt(i.imageVideoFiles,(h,c)=>(Q(),se("div",{key:c+"iv"},[Oe(s,{file:h,"current-user-id":n.currentUserId,message:n.message,index:c,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=_=>e.$emit("open-file",_))},_t({_:2},[tt(e.$slots,(_,p)=>({name:p,fn:Ge(o=>[Be(e.$slots,p,vt(pt(o)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Q(!0),se(st,null,tt(i.otherFiles,(h,c)=>(Q(),se("div",{key:c+"a",class:"vac-file-wrapper"},[h.progress>=0?(Q(),ht(l,{key:0,progress:h.progress,style:{top:"44px"}},null,8,["progress"])):Te("",!0),he("div",{class:$e(["vac-file-container",{"vac-file-container-progress":h.progress>=0}]),onClick:_=>i.openFile(_,h,"download")},[he("div",I4,[Be(e.$slots,"document-icon",{},()=>[Oe(m,{name:"document"})])]),he("div",C4,Qe(h.name),1),h.extension?(Q(),se("div",B4,Qe(h.extension),1)):Te("",!0)],10,R4)]))),128)),Oe(u,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:t[1]||(t[1]=h=>e.$emit("open-user-tag",h))},null,8,["message-id","content","users","text-formatting","link-options"])])}var L4=xt(E4,[["render",O4]]);const F4={name:"MessageActions",components:{SvgIcon:Ht,EmojiPickerContainer:_u},directives:{clickOutside:ya},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=vu(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-n>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},j4={class:"vac-message-actions-wrapper"},N4={key:"3"},H4={class:"vac-menu-list"},D4=["onClick"];function P4(e,t,n,r,a,i){const s=Ye("svg-icon"),l=Ye("emoji-picker-container"),m=oa("click-outside");return Q(),se("div",j4,[he("div",{class:"vac-options-container",style:St({display:n.hoverAudioProgress?"none":"initial",width:i.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[Oe(Xs,{name:"vac-slide-left",tag:"span"},{default:Ge(()=>[i.isMessageActions||i.isMessageReactions?(Q(),se("div",{key:"1",class:$e(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):Te("",!0),i.isMessageActions?(Q(),se("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...u)=>i.openOptions&&i.openOptions(...u))},[Be(e.$slots,"dropdown-icon_"+n.message._id,{},()=>[Oe(s,{name:"dropdown",param:"message"})])],512)):Te("",!0),i.isMessageReactions?zn((Q(),se("div",N4,[Be(e.$slots,"emoji-picker",js({emojiOpened:a.emojiOpened},{addEmoji:i.sendMessageReaction}),()=>[Oe(l,{class:"vac-message-emojis",style:St({right:i.isMessageActions?"30px":"5px"}),"emoji-opened":a.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:i.sendMessageReaction,onOpenEmoji:i.openEmoji},_t({_:2},[tt(e.$slots,(u,h)=>({name:h,fn:Ge(c=>[Be(e.$slots,h,vt(pt(c)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[m,i.closeEmoji]]):Te("",!0)]),_:3})],4),i.filteredMessageActions.length?(Q(),ht(Ct,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Ge(()=>[a.optionsOpened?zn((Q(),se("div",{key:0,ref:"menuOptions",class:$e(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:St({top:`${a.menuOptionsTop}px`})},[he("div",H4,[(Q(!0),se(st,null,tt(i.filteredMessageActions,u=>(Q(),se("div",{key:u.name},[he("div",{class:"vac-menu-item",onClick:h=>i.messageActionHandler(u)},Qe(u.title),9,D4)]))),128))])],6)),[[m,i.closeOptions]]):Te("",!0)]),_:1},8,["name"])):Te("",!0)])}var z4=xt(F4,[["render",P4]]);const U4={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},V4=["onClick"];function q4(e,t,n,r,a,i){return n.message.deleted?Te("",!0):(Q(),ht(Xs,{key:0,name:"vac-slide-left",tag:"span"},{default:Ge(()=>[(Q(!0),se(st,null,tt(n.message.reactions,(s,l)=>zn((Q(),se("button",{key:l+0,class:$e(["vac-button-reaction",{"vac-reaction-me":s.indexOf(n.currentUserId)!==-1}]),style:St({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:m=>i.sendMessageReaction({unicode:l},s)},[Un(Qe(l),1),he("span",null,Qe(s.length),1)],14,V4)),[[ha,s.length]])),128))]),_:1}))}var X4=xt(U4,[["render",q4]]);function Y4(e){if(!((r,a)=>a.every(i=>{let s=!1;return(i.type[0]==="array"&&Array.isArray(r[i.key])||i.type.find(l=>l===typeof r[i.key]))&&(s=!0),s&&Oo(r,i.key)}))(e,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function K4(e){if(!((r,a)=>a.every(i=>i.type.find(l=>l===typeof r[i.key])&&Oo(r,i.key)))(e,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function G4(e){if(!((r,a)=>a.every(i=>i.type.find(l=>l===typeof r[i.key])&&Oo(r,i.key)))(e,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function Oo(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&e[t]!==void 0}const W4={name:"RoomMessage",components:{SvgIcon:Ht,FormatMessage:xi,AudioPlayer:ko,MessageReply:m4,MessageFiles:L4,MessageActions:z4,MessageReactions:X4},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return(e=this.message.files)==null?void 0:e.some(t=>wa(t))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){if(!e.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=e.reduce((t,n)=>n.index<t.index?n:t)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){G4(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&t.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){if(!(!this.messageSelectionEnabled||this.message.system)){if(this.isMessageSelected){this.$emit("unselect-message",this.message._id);return}this.$emit("select-message",this.message)}}}},Z4=["id"],Q4={key:0,class:"vac-card-date-container"},J4={class:"vac-card-info vac-card-date"},$4={key:1,class:"vac-line-new"},eb={key:2,class:"vac-card-info vac-card-system"},tb={key:3,class:"vac-message-box-container"},nb={key:0,class:"checkbox-message-container"},rb={key:1,class:"vac-avatar-offset"},ib=he("span",{class:"forward-icon"},[he("svg",{viewBox:"0 0 16 16",height:"16",width:"16",preserveAspectRatio:"xMidYMid meet",class:"",version:"1.1"},[he("path",{d:"M9.51866667,3.87533333 C9.51866667,3.39333333 10.1006667,3.152 10.4406667,3.49266667 L14.4706667,7.52666667 C14.682,7.738 14.682,8.07933333 14.4706667,8.29066667 L10.4406667,12.3246667 C10.1006667,12.6646667 9.51866667,12.424 9.51866667,11.942 L9.51866667,10.1206667 C6.12133333,10.1206667 3.63266667,11.0906667 1.78266667,13.1946667 C1.61866667,13.3806667 1.31466667,13.2226667 1.38133333,12.984 C2.33466667,9.53533333 4.66466667,6.31466667 9.51866667,5.62066667 L9.51866667,3.87533333 Z",fill:"currentColor"})])],-1),ab={class:"forward-text"},sb={key:0,class:"vac-progress-time"},ob={class:"vac-text-timestamp"},lb={key:0,class:"vac-icon-edited"},cb={key:1},ub=[he("div",{class:"vac-failure-text"},"!",-1)],db={key:3,class:"vac-avatar-current-offset"};function mb(e,t,n,r,a,i){const s=Ye("format-message"),l=Ye("message-reply"),m=Ye("message-files"),u=Ye("audio-player"),h=Ye("svg-icon"),c=Ye("message-actions"),_=Ye("message-reactions");return Q(),se("div",{id:n.message._id,ref:"message",class:$e(["vac-message-wrapper",{"vac-selection-enabled":n.messageSelectionEnabled,"message-selected":i.isMessageSelected,"message-system":n.message.system}]),onClick:t[8]||(t[8]=(...p)=>i.selectMessage&&i.selectMessage(...p))},[i.showDate?(Q(),se("div",Q4,[he("div",J4,Qe(n.message.date),1)])):Te("",!0),a.newMessage._id===n.message._id?(Q(),se("div",$4,Qe(n.textMessages.NEW_MESSAGES),1)):Te("",!0),n.message.system?(Q(),se("div",eb,[Be(e.$slots,"message_"+n.message._id,{},()=>[Oe(s,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:i.openUserTag},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Q(),se("div",tb,[n.messageSelectionEnabled&&!n.message.system?(Q(),se("label",nb,[he("div",{class:$e(["checkbox",{selected:i.isMessageSelected}])},null,2)])):Te("",!0),he("div",{class:$e(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}])},[Be(e.$slots,"message_"+n.message._id,{},()=>[n.message.senderId!==n.currentUserId?Be(e.$slots,"message-avatar_"+n.message._id,{key:0},()=>[n.message.avatar&&!n.messageSelectionEnabled?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.message.avatar}')`})},null,4)):Te("",!0)]):Te("",!0),i.hasSenderUserAvatar&&!n.message.avatar?(Q(),se("div",rb)):Te("",!0),he("div",{class:$e(["vac-message-container",{"vac-message-container-offset":i.messageOffset}])},[he("div",{class:$e(["vac-message-card",{"vac-message-highlight":i.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":i.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...p)=>i.onHoverMessage&&i.onHoverMessage(...p)),onMouseleave:t[6]||(t[6]=(...p)=>i.onLeaveMessage&&i.onLeaveMessage(...p))},[i.showUsername?(Q(),se("div",{key:0,class:$e(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[he("span",null,Qe(n.message.username),1)],2)):Te("",!0),!n.message.deleted&&n.message.isForwarded?(Q(),se("div",{key:1,class:$e({"message-forwarded-container":!n.message.deleted&&n.message.isForwarded})},[ib,he("span",ab,Qe(n.textMessages.MESSAGE_FORWARD),1)],2)):Te("",!0),!n.message.deleted&&n.message.replyMessage?(Q(),ht(l,{key:2,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Te("",!0),!!n.message.deleted||!n.message.files||!n.message.files.length?(Q(),ht(s,{key:3,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:i.openUserTag},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!i.isAudio||n.message.files.length>1?(Q(),ht(m,{key:4,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Q(),se(st,{key:5},[Oe(u,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=p=>a.progressTime=p),onHoverAudioProgress:t[1]||(t[1]=p=>a.hoverAudioProgress=p)},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?Te("",!0):(Q(),se("div",sb,Qe(a.progressTime),1))],64)),he("div",ob,[n.message.edited&&!n.message.deleted?(Q(),se("div",lb,[Be(e.$slots,"pencil-icon_"+n.message._id,{},()=>[Oe(h,{name:"pencil"})])])):Te("",!0),he("span",null,Qe(n.message.timestamp),1),i.isCheckmarkVisible?(Q(),se("span",cb,[Be(e.$slots,"checkmark-icon_"+n.message._id,{},()=>[Oe(h,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Te("",!0)]),Oe(c,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":a.messageHover,"hover-message-id":a.hoverMessageId,"hover-audio-progress":a.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=p=>a.messageHover=p),onUpdateOptionsOpened:t[3]||(t[3]=p=>a.optionsOpened=p),onUpdateEmojiOpened:t[4]||(t[4]=p=>a.emojiOpened=p),onMessageActionHandler:i.messageActionHandler,onSendMessageReaction:i.sendMessageReaction},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Oe(_,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:i.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Be(e.$slots,"message-failure_"+n.message._id,{},()=>[n.message.failure&&n.message.senderId===n.currentUserId?(Q(),se("div",{key:0,class:$e(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:t[7]||(t[7]=p=>e.$emit("open-failed-message",{message:n.message}))},ub,2)):Te("",!0)]),n.message.senderId===n.currentUserId?Be(e.$slots,"message-avatar_"+n.message._id,{key:2},()=>[n.message.avatar&&!n.messageSelectionEnabled?(Q(),se("div",{key:0,class:"vac-avatar vac-avatar-current",style:St({"background-image":`url('${n.message.avatar}')`})},null,4)):Te("",!0)]):Te("",!0),i.hasCurrentUserAvatar&&!n.message.avatar?(Q(),se("div",db)):Te("",!0)])],2)]))],10,Z4)}var fb=xt(W4,[["render",mb]]);const hb={name:"ChatRoom",components:{Loader:pa,SvgIcon:Ht,RoomHeader:nv,RoomFooter:$3,RoomMessage:fb},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((n,r)=>{this.showNewMessagesDivider&&!n.seen&&n.senderId!==this.currentUserId&&this.newMessages.push({_id:n._id,index:r})}),(t==null?void 0:t.length)===(e==null?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,n=new ResizeObserver(a=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),n.disconnect())});for(var r=0;r<e.children.length;r++)n.observe(e.children[r])},touchStart(e){if(!this.singleRoom&&e.changedTouches.length===1){const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;addEventListener("touchend",r=>this.touchEnd(r,t,n),{once:!0})}},touchEnd(e,t,n){if(e.changedTouches.length===1){const r=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,i=r-t>100,s=Math.abs(a-n)>50;i&&!s&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const n=this.$refs.scrollContainer;!n||(e(),setTimeout(()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:n}){if(t!==this.messages.length-1)return;const r=n.offsetHeight+60;setTimeout(()=>{const a=this.$refs.scrollContainer;let i=!1;a&&(i=this.getBottomScroll(a)>r),e.senderId===this.currentUserId?i?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():i?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":this.initReplyMessage=t,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=t,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":this.selectedMessages=[t],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:n,scrollTop:r}=e;return t-n-r},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e&&(e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth")))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},pb={class:"vac-container-center vac-room-empty"},vb={class:"vac-messages-container"},_b={key:0,class:"vac-text-started"},gb={key:1,class:"vac-text-started"},bb={key:0,id:"infinite-loader-messages"},xb={key:2},yb={key:0,class:"vac-badge-counter vac-messages-count"};function wb(e,t,n,r,a,i){const s=Ye("room-header"),l=Ye("loader"),m=Ye("room-message"),u=Ye("svg-icon"),h=Ye("room-footer");return zn((Q(),se("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Rn((...c)=>i.onDropFiles&&i.onDropFiles(...c),["prevent"])),onDragenter:t[13]||(t[13]=Rn(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Rn(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Rn(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...c)=>i.touchStart&&i.touchStart(...c))},[i.showNoRoom?Be(e.$slots,"no-room-selected",{key:0},()=>[he("div",pb,[he("div",null,Qe(n.textMessages.ROOM_EMPTY),1)])]):(Q(),ht(s,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:i.room,"message-selection-enabled":a.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":a.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=c=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=c=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=c=>e.$emit("menu-action-handler",c)),onMessageSelectionActionHandler:i.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=c=>a.messageSelectionEnabled=!1)},_t({_:2},[tt(e.$slots,(c,_)=>({name:_,fn:Ge(p=>[Be(e.$slots,_,vt(pt(p)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),he("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...c)=>i.onContainerScroll&&i.onContainerScroll(...c))},[Oe(l,{show:a.loadingMessages,type:"messages"},_t({_:2},[tt(e.$slots,(c,_)=>({name:_,fn:Ge(p=>[Be(e.$slots,_,vt(pt(p)))])}))]),1032,["show"]),he("div",vb,[he("div",{class:$e({"vac-messages-hidden":a.loadingMessages})},[Oe(Ct,{name:"vac-fade-message"},{default:Ge(()=>[he("div",null,[i.showNoMessages?(Q(),se("div",_b,[Be(e.$slots,"messages-empty",{},()=>[Un(Qe(n.textMessages.MESSAGES_EMPTY),1)])])):Te("",!0),i.showMessagesStarted?(Q(),se("div",gb,Qe(n.textMessages.CONVERSATION_STARTED)+" "+Qe(n.messages[0].date),1)):Te("",!0)])]),_:3}),n.messages.length&&!n.messagesLoaded?(Q(),se("div",bb,[Oe(l,{show:!0,infinite:!0,type:"infinite-messages"},_t({_:2},[tt(e.$slots,(c,_)=>({name:_,fn:Ge(p=>[Be(e.$slots,_,vt(pt(p)))])}))]),1024)])):Te("",!0),(Q(),ht(Xs,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:Ge(()=>[(Q(!0),se(st,null,tt(n.messages,(c,_)=>(Q(),se("div",{key:c.indexId||c._id},[Oe(m,{"current-user-id":n.currentUserId,message:c,index:_,messages:n.messages,"edited-message-id":a.editedMessageId,"message-actions":n.messageActions,"room-users":i.room.users,"text-messages":n.textMessages,"new-messages":a.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":a.messageSelectionEnabled,"selected-messages":a.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:i.onMessageAdded,onMessageActionHandler:i.messageActionHandler,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag,onOpenFailedMessage:t[4]||(t[4]=p=>e.$emit("open-failed-message",p)),onSendMessageReaction:i.sendMessageReaction,onSelectMessage:i.selectMessage,onUnselectMessage:i.unselectMessage},_t({_:2},[tt(e.$slots,(p,o)=>({name:o,fn:Ge(j=>[Be(e.$slots,o,vt(pt(j)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),a.loadingMessages?Te("",!0):(Q(),se("div",xb,[Oe(Ct,{name:"vac-bounce"},{default:Ge(()=>[a.scrollIcon?(Q(),se("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...c)=>i.scrollToBottom&&i.scrollToBottom(...c))},[Oe(Ct,{name:"vac-bounce"},{default:Ge(()=>[a.scrollMessagesCount?(Q(),se("div",yb,Qe(a.scrollMessagesCount),1)):Te("",!0)]),_:1}),Be(e.$slots,"scroll-icon",{},()=>[Oe(u,{name:"dropdown",param:"scroll"})])])):Te("",!0)]),_:3})])),Oe(h,{room:i.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":a.initReplyMessage,"init-edit-message":a.initEditMessage,"dropped-files":a.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=c=>a.editedMessageId=c),onEditMessage:t[8]||(t[8]=c=>e.$emit("edit-message",c)),onSendMessage:t[9]||(t[9]=c=>e.$emit("send-message",c)),onTypingMessage:t[10]||(t[10]=c=>e.$emit("typing-message",c)),onTextareaActionHandler:t[11]||(t[11]=c=>e.$emit("textarea-action-handler",c))},_t({_:2},[tt(e.$slots,(c,_)=>({name:_,fn:Ge(p=>[Be(e.$slots,_,vt(pt(p)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[ha,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}var kb=xt(hb,[["render",wb]]);const Sb={name:"MediaPreview",components:{SvgIcon:Ht},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return Xr(this.file)},isVideo(){return wi(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},Mb={key:0,class:"vac-media-preview-container"},Ab={key:1,class:"vac-media-preview-container"},Eb={controls:"",autoplay:""},Tb=["src"],Rb={class:"vac-svg-button"};function Ib(e,t,n,r,a,i){const s=Ye("svg-icon");return Q(),se("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Rn((...l)=>i.closeModal&&i.closeModal(...l),["stop"])),onKeydown:t[1]||(t[1]=xr((...l)=>i.closeModal&&i.closeModal(...l),["esc"]))},[Oe(Ct,{name:"vac-bounce-preview",appear:""},{default:Ge(()=>[i.isImage?(Q(),se("div",Mb,[he("div",{class:"vac-image-preview",style:St({"background-image":`url('${n.file.url}')`})},null,4)])):i.isVideo?(Q(),se("div",Ab,[he("video",Eb,[he("source",{src:n.file.url},null,8,Tb)])])):Te("",!0)]),_:1}),he("div",Rb,[Be(e.$slots,"preview-close-icon",{},()=>[Oe(s,{name:"close-outline",param:"preview"})])])],544)}var Cb=xt(Sb,[["render",Ib]]),Bb={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Ob={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",backgroundSelectedHover:"rgba(202,215,250,0.49)",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85",forwarded:"#8696a0"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#29365f",backgroundSelectedHover:"rgba(32,42,72,0.62)",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8",forwarded:"rgba(255, 255, 255, 0.6)"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},Lb=({general:e,container:t,header:n,footer:r,sidemenu:a,content:i,dropdown:s,message:l,markdown:m,room:u,emoji:h,icons:c})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-footer-bg-color":r.background,"--chat-border-style-input":r.borderStyleInput,"--chat-border-color-input-selected":r.borderInputSelected,"--chat-footer-bg-color-reply":r.backgroundReply,"--chat-footer-bg-color-tag-active":r.backgroundTagActive,"--chat-footer-bg-color-tag":r.backgroundTag,"--chat-content-bg-color":i.background,"--chat-sidemenu-bg-color":a.background,"--chat-sidemenu-bg-color-hover":a.backgroundHover,"--chat-sidemenu-bg-color-active":a.backgroundActive,"--chat-sidemenu-color-active":a.colorActive,"--chat-sidemenu-border-color-search":a.borderColorSearch,"--chat-dropdown-bg-color":s.background,"--chat-dropdown-bg-color-hover":s.backgroundHover,"--chat-message-bg-color":l.background,"--chat-message-bg-color-me":l.backgroundMe,"--chat-message-color-started":l.colorStarted,"--chat-message-bg-color-deleted":l.backgroundDeleted,"--chat-message-bg-color-selected":l.backgroundSelected,"--chat-message-bg-color-selected-hover":l.backgroundSelectedHover,"--chat-message-color-deleted":l.colorDeleted,"--chat-message-color-username":l.colorUsername,"--chat-message-color-forwarded":l.forwarded,"--chat-message-color-timestamp":l.colorTimestamp,"--chat-message-bg-color-date":l.backgroundDate,"--chat-message-color-date":l.colorDate,"--chat-message-bg-color-system":l.backgroundSystem,"--chat-message-color-system":l.colorSystem,"--chat-message-color":l.color,"--chat-message-bg-color-media":l.backgroundMedia,"--chat-message-bg-color-reply":l.backgroundReply,"--chat-message-color-reply-username":l.colorReplyUsername,"--chat-message-color-reply-content":l.colorReply,"--chat-message-color-tag":l.colorTag,"--chat-message-bg-color-image":l.backgroundImage,"--chat-message-color-new-messages":l.colorNewMessages,"--chat-message-bg-color-scroll-counter":l.backgroundScrollCounter,"--chat-message-color-scroll-counter":l.colorScrollCounter,"--chat-message-bg-color-reaction":l.backgroundReaction,"--chat-message-border-style-reaction":l.borderStyleReaction,"--chat-message-bg-color-reaction-hover":l.backgroundReactionHover,"--chat-message-border-style-reaction-hover":l.borderStyleReactionHover,"--chat-message-color-reaction-counter":l.colorReactionCounter,"--chat-message-bg-color-reaction-me":l.backgroundReactionMe,"--chat-message-border-style-reaction-me":l.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":l.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":l.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":l.colorReactionCounterMe,"--chat-message-bg-color-audio-record":l.backgroundAudioRecord,"--chat-message-bg-color-audio-line":l.backgroundAudioLine,"--chat-message-bg-color-audio-progress":l.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":l.backgroundAudioProgressSelector,"--chat-message-color-file-extension":l.colorFileExtension,"--chat-markdown-bg":m.background,"--chat-markdown-border":m.border,"--chat-markdown-color":m.color,"--chat-markdown-color-multi":m.colorMulti,"--chat-room-color-username":u.colorUsername,"--chat-room-color-message":u.colorMessage,"--chat-room-color-timestamp":u.colorTimestamp,"--chat-room-color-online":u.colorStateOnline,"--chat-room-color-offline":u.colorStateOffline,"--chat-room-bg-color-badge":u.backgroundCounterBadge,"--chat-room-color-badge":u.colorCounterBadge,"--chat-emoji-bg-color":h.background,"--chat-icon-color-search":c.search,"--chat-icon-color-add":c.add,"--chat-icon-color-toggle":c.toggle,"--chat-icon-color-menu":c.menu,"--chat-icon-color-close":c.close,"--chat-icon-color-close-image":c.closeImage,"--chat-icon-color-file":c.file,"--chat-icon-color-paperclip":c.paperclip,"--chat-icon-color-close-outline":c.closeOutline,"--chat-icon-color-close-preview":c.closePreview,"--chat-icon-color-send":c.send,"--chat-icon-color-send-disabled":c.sendDisabled,"--chat-icon-color-emoji":c.emoji,"--chat-icon-color-emoji-reaction":c.emojiReaction,"--chat-icon-color-document":c.document,"--chat-icon-color-pencil":c.pencil,"--chat-icon-color-checkmark":c.checkmark,"--chat-icon-color-checkmark-seen":c.checkmarkSeen,"--chat-icon-color-eye":c.eye,"--chat-icon-color-dropdown-message":c.dropdownMessage,"--chat-icon-bg-dropdown-message":c.dropdownMessageBackground,"--chat-icon-color-dropdown-room":c.dropdownRoom,"--chat-icon-color-dropdown-scroll":c.dropdownScroll,"--chat-icon-color-microphone":c.microphone,"--chat-icon-color-audio-play":c.audioPlay,"--chat-icon-color-audio-pause":c.audioPause,"--chat-icon-color-audio-cancel":c.audioCancel,"--chat-icon-color-audio-confirm":c.audioConfirm});var Fb=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.markdown p{margin:0}.markdown ol{display:flex;flex-direction:column;list-style-position:inside}.markdown ul{display:flex;flex-direction:column}.markdown code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.markdown p code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-right:auto;white-space:nowrap;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel .x-icon{color:var(----chat-message-color-forwarded)}.vac-room-header .vac-room-selection .vac-selection-cancel .vac-selection-count-container{margin-left:14px;font-size:14.5px;color:var(----chat-message-color-forwarded);user-select:none}.vac-room-header .vac-room-selection .forward-messages{color:var(----chat-message-color-forwarded)}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar:not(.vac-avatar-current){margin:0 0 2px 3px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-message-wrapper .message-forwarded-container{display:flex;align-items:end;margin-bottom:4px}.vac-message-wrapper .message-forwarded-container .forward-icon{color:var(--chat-message-color-forwarded);display:inline-block}.vac-message-wrapper .message-forwarded-container .forward-text{color:var(--chat-message-color-forwarded);font-style:italic;font-size:.75rem;font-weight:600;margin-left:2px}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box-container{display:flex;align-items:center;cursor:pointer}.vac-message-wrapper.vac-selection-enabled:not(.message-system):hover{background-color:var(--chat-message-bg-color-selected-hover);transition:background-color .2s}.vac-message-wrapper.vac-selection-enabled:not(.message-system).message-selected{background-color:var(--chat-message-bg-color-selected-hover)}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .checkbox-message-container{display:block;position:relative;cursor:pointer;font-size:14px;user-select:none;margin-left:10px;-webkit-tap-highlight-color:transparent}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .checkbox-message-container .checkbox{position:relative;top:0;left:0;height:1.3em;width:1.3em;background-color:#2196f300;border-radius:.25em;transition:all .25s}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .checkbox-message-container .checkbox.selected{background-color:#2196f3}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .checkbox-message-container .checkbox.selected:after{left:.45em;top:.25em;width:.25em;height:.5em;border-color:rgba(255,255,255,0) white white rgba(255,255,255,0);border-width:0 .15em .15em 0;border-radius:0;transform:rotate(45deg)}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .checkbox-message-container .checkbox:after{content:"";position:absolute;transform:rotate(0);border:.1em solid rgba(107,107,107,.6117647059);left:0;top:0;width:1.05em;height:1.05em;border-radius:.25em;transition:all .25s,border-width .1s}@media (min-width: 1700px){.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box.vac-offset-current{margin-left:47.6%}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box{max-width:50%}}@media (min-width: 1043px) and (max-width: 1700px){.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box.vac-offset-current{margin-left:46%}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box{max-width:50%}}@media (min-width: 768px) and (max-width: 1043px){.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box.vac-offset-current{margin-left:44.6%}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box{max-width:50%}}@media (min-width: 443px) and (max-width: 768px){.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box.vac-offset-current{margin-left:43.6%}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box{max-width:50%}}@media (max-width: 443px){.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box.vac-offset-current{margin-left:39%}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-message-box{max-width:50%}}.vac-message-wrapper.vac-selection-enabled:not(.message-system) .vac-card-date-container{background:var(--chat-content-bg-color);padding-bottom:2px}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const jb={name:"ChatContainer",components:{RoomsList:jp,Room:kb,MediaPreview:Cb},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:""},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...Bb,...this.textMessagesCasted}},cssVars(){const e=Ob[this.theme],t={};return Object.keys(e).map(n=>{t[n]={...e[n],...this.stylesCasted[n]||{}}}),Lb(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const n=e.index||0,r=t.index||0;return this.roomsOrder==="asc"?n<r?-1:r<n?1:0:n>r?-1:r>n?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find(n=>n.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const n=e.find(r=>r.roomId===this.roomId)||{};this.fetchRoom({room:n})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const n=this.roomsCasted.find(r=>r.roomId===e);this.fetchRoom({room:n})}else t&&!e&&(this.room={})}},room(e){!e||Object.entries(e).length===0||(Y4(e),e.users.forEach(t=>{K4(t)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return e==="true"||e===!0},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?typeof e=="object"?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&t.action==="preview"?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},Nb={class:"vac-chat-container"};function Hb(e,t,n,r,a,i){const s=Ye("rooms-list"),l=Ye("room"),m=Ye("media-preview");return Q(),se("div",{class:"vac-card-window",style:St([{height:n.height},i.cssVars])},[he("div",Nb,[i.singleRoomCasted?Te("",!0):(Q(),ht(s,{key:0,"current-user-id":n.currentUserId,rooms:i.orderedRooms,"loading-rooms":i.loadingRoomsCasted,"rooms-loaded":i.roomsLoadedCasted,room:a.room,"room-actions":i.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":i.t,"show-search":i.showSearchCasted,"show-add-room":i.showAddRoomCasted,"show-rooms-list":a.showRoomsList&&i.roomsListOpenedCasted,"text-formatting":i.textFormattingCasted,"link-options":i.linkOptionsCasted,"is-mobile":a.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:i.fetchRoom,onFetchMoreRooms:i.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=u=>a.loadingMoreRooms=u),onAddRoom:i.addRoom,onSearchRoom:i.searchRoom,onRoomActionHandler:i.roomActionHandler},_t({_:2},[tt(a.slots,u=>({name:u.slot,fn:Ge(h=>[Be(e.$slots,u.slot,vt(pt(h)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Oe(l,{"current-user-id":n.currentUserId,rooms:i.roomsCasted,"room-id":a.room.roomId||"","load-first-room":i.loadFirstRoomCasted,messages:i.messagesCasted,"room-message":n.roomMessage,"messages-loaded":i.messagesLoadedCasted,"menu-actions":i.menuActionsCasted,"message-actions":i.messageActionsCasted,"message-selection-actions":i.messageSelectionActionsCasted,"auto-scroll":i.autoScrollCasted,"show-send-icon":i.showSendIconCasted,"show-files":i.showFilesCasted,"show-audio":i.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":i.showEmojisCasted,"show-reaction-emojis":i.showReactionEmojisCasted,"show-new-messages-divider":i.showNewMessagesDividerCasted,"show-footer":i.showFooterCasted,"text-messages":i.t,"single-room":i.singleRoomCasted,"show-rooms-list":a.showRoomsList&&i.roomsListOpenedCasted,"text-formatting":i.textFormattingCasted,"link-options":i.linkOptionsCasted,"is-mobile":a.isMobile,"loading-rooms":i.loadingRoomsCasted,"room-info-enabled":i.roomInfoEnabledCasted,"textarea-action-enabled":i.textareaActionEnabledCasted,"textarea-auto-focus":i.textareaAutoFocusCasted,"user-tags-enabled":i.userTagsEnabledCasted,"emojis-suggestion-enabled":i.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"templates-text":i.templatesTextCasted,"username-options":i.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:i.toggleRoomsList,onRoomInfo:i.roomInfo,onFetchMessages:i.fetchMessages,onSendMessage:i.sendMessage,onEditMessage:i.editMessage,onDeleteMessage:i.deleteMessage,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag,onOpenFailedMessage:i.openFailedMessage,onMenuActionHandler:i.menuActionHandler,onMessageActionHandler:i.messageActionHandler,onMessageSelectionActionHandler:i.messageSelectionActionHandler,onSendMessageReaction:i.sendMessageReaction,onTypingMessage:i.typingMessage,onTextareaActionHandler:i.textareaActionHandler},_t({_:2},[tt(a.slots,u=>({name:u.slot,fn:Ge(h=>[Be(e.$slots,u.slot,vt(pt(h)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Oe(Ct,{name:"vac-fade-preview",appear:""},{default:Ge(()=>[a.showMediaPreview?(Q(),ht(m,{key:0,file:a.previewFile,onCloseMediaPreview:t[1]||(t[1]=u=>a.showMediaPreview=!1)},_t({_:2},[tt(a.slots,u=>({name:u.slot,fn:Ge(h=>[Be(e.$slots,u.slot,vt(pt(h)))])}))]),1032,["file"])):Te("",!0)]),_:3})],4)}var Db=xt(jb,[["render",Hb],["styles",[Fb]]]);const Gu=Om(Db),Wu="vue-advanced-chat";function Pb(){customElements.get(Wu)||customElements.define(Wu,Gu)}ur.VueAdvancedChat=Gu,ur.register=Pb,Object.defineProperties(ur,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
